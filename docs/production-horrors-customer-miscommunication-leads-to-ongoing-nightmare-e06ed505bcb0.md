# 生产恐怖——客户沟通不畅导致噩梦不断

> 原文：<https://medium.com/javarevisited/production-horrors-customer-miscommunication-leads-to-ongoing-nightmare-e06ed505bcb0?source=collection_archive---------2----------------------->

![](img/583a76ff4a3215e6defd29450b7b39eb.png)

这是一个有点不同的系列故事。当我想出制作恐怖的概念时，我的想法大多是关于让我们的制作失败的某一天或某一事件。很自然，我们的思维会被崩溃或者像最近脸书停电这样的问题所吸引。但是上一次，我给出了导致计费问题的有问题的缓存的例子…

这一次，生产恐怖是不同的类型。早在产品投入生产之前，它就已经开始了，而且是在一个不同的时代。在 ajax 出现之前，web 还处于请求-响应模式，IE 6 是最先进的(真是一个恐怖的故事)。有人找到我，让我为一家大型银行提供咨询，这家银行正在运营一个大型项目，以实现其交易基础设施的现代化。

对于这个项目来说，我太忙了，花费也太高了，所以他们决定不要我了。但是我有机会看了系统的说明书。

# 这在今天仍然适用吗？

这是一个内部项目，使用的技术现在看来已经过时了。但我认为所有重大决策/错误都是永恒的。今天，我仍然看到管理人员和开发人员犯很多同样的错误。

我不认为从事这项工作的人是无能或愚蠢的。我认为错误是因为范围/规模以及你不能调试架构的事实。你们中的一些人可能会跳到“精益创业”和现代方法作为解决方案。这些在当时并不常见，但即使有了这些流程，问题也只有在整个系统到位时才变得明显，而且要扭转局面也为时已晚。

# 网上实时交易？

这是一个内部使用的系统。该银行使用了一个运行良好但笨重的主机终端系统。他们想将它现代化为“互联网技术”。

请记住，这是很久以前的事了。JavaScript 是创造可爱动画的语言。Gmail 刚刚问世，虽然它给人留下了深刻的印象，但没有人这么做。JavaScript 前端的框架并不存在。

所以我对 spec 最大的抱怨是:你为什么要使用网络技术？

回应是:客户希望我们使用“互联网技术”。

后来发现客户只是想要现代技术。Swing UI(当时在银行系统中很常见)会很棒。选择 web UI 是客户和架构师之间的沟通失败。

如果不是建筑上的那个错误，这个可悲的怪物就可以避免了…

# servlet…到处都是 servlet…

接下来的失败是一次招聘，我既贵又忙。所以他们雇了很多人。一间大办公室里坐满了大约 30 名不同技能水平的开发人员。他们花了几个月的时间用 servlet/JSP 前端绘制了一个 EJB 1.1 架构。

所有这些都是在 AIX 上运行的 IBM WebSphere 应用服务器之上的。

你可能会畏缩，但这是当时的“艺术状态”。作为一个枝节问题，这个项目缺少一个在金融行业有经验的人。这对于银行应用程序来说非常重要。

问题是，他们没有雇佣一名高级建筑师。他们雇佣了一个表面上“看起来不错”的人。但他对银行业或网络开发了解不多…

该项目使用双精度进行财务计算！

如果你不是来自金融行业，你可能会认为这没什么大不了的，但我向你保证，五分之四的金融科技人士在阅读这篇文章时会拍脑袋。尽管这是“可修复的”;真正的灾难是前端。

这是在我们甚至在服务器上有任何前端 API 之前。Struts 相对较新，项目中的开发人员并不知道它的存在。因此，他们开始推出大量不连贯的 servlets，导航不清晰，没有中央控制。该系统在投入生产之前就变得一塌糊涂。

# 情况变得更糟了

请记住，我们没有谈到故事的要点，也就是制作。

这是一个直接连接到股票市场和银行内部主机的交易系统。涉及到许多活动部件。但是在最初的设计规范中有一些客户需求并不明确。主要是因为建筑师认为他们不会构成挑战…

一些流程必须提供低于秒的响应时间。

这听起来很容易，在当时听起来也很容易。在不到一秒的时间内发送一个买入/卖出指令有多难？对吗？

结果花了 7 分钟。这就是我作为顾问被带入这个项目的原因。我刚刚运行了一个分析器，把时间缩短到了 7 秒。

两个人一起工作，当他从另一个人那里调用一个方法时，每个人都认为他的同事正在缓存表。因此，您最终得到了两个查找表，对于每个表中的每一行，这两个查找表不断地重复查找整个相邻的表。

系统使用了大量手工编写的 JavaScript 代码，这些代码依赖于 DOM 和浏览器行为来获得最后一点性能，并避免整个页面的请求。同样，在那些日子里，对于这类事情没有框架或“最佳实践”。所以我真的不能责怪从事这项工作的人。

最终，过来解决灾难的新总理制定了这个部署计划:

*   系统将只支持特定版本号的 Internet Explorer 6
*   为了让用户升级，他们将备份他们的机器(复制用户硬盘，这样浏览器将有相同的版本

甚至有人讨论过使用远程终端(VNC 风格)来显示一台安装了正确版本浏览器的计算机。

令人惊讶的是，银行并不认为这是一个失败，他们仍然雇佣了一个更大项目的承包商。

# 经验教训

有许多经验适用于现代项目:

*   你需要一个该领域的领域专家——如果没有一个真正在代码层面上深入了解银行业的人，你就无法运行一个银行项目。在设计阶段有一个专家是不够的
*   很难验证设计——像这样的项目应该更加敏捷，应该在扩展团队和超越不可逆转点之前停下来重新评估。应该深入验证客户需求——这一件事可能会完全改变项目的动态
*   有些问题只有在我们接近生产阶段时才会被注意到
*   您应该编写一个验证客户需求的测试案例——如果从第一天开始就有验证 1 秒时间需求的测试，那么就可以节省很多时间
*   使用当前的技术——这是一个我有很多其他故事的教训。开发人员希望使用“酷”技术。他们倾向于淡化选择新工具的风险，夸大潜在的好处。即使这些技术带来了辅助技术，它们周围的空间也并不总是准备好的
*   不要假设客户的需求是“简单的”

当你要把一个糟糕的项目投入生产时，你会怎么做？

*   它真的造得很差，还是仅仅是冒名顶替综合症抬起了它丑陋的头？
*   所有代码都可以改进，问题是这会导致项目永远无法进入生产阶段。你需要找到一个平衡点:
    —制定一个修复计划
    —短期内我们能做什么
    —投产后我们能替换哪些零件
    —客户的优先考虑事项
*   在开发过程中重新评估方向——您不能调试系统设计决策。当你实现它的时候，你可能会发现问题。重要的是要把它们举得足够高，声音足够大。
*   不断地与客户交流——在项目进行到一半的时候，公司可能会改变方向，重新构建一个常规的 Swing UI，而不是 web UI。他们可能会更快更好地完成项目

# TL；速度三角形定位法(dead reckoning)

生产灾难有时是我们在几英里外就能看到的连环事故。但是火车开得太快了，我们不可能停下来。这是其中的一个故事。其中，糟糕的沟通、缺失的技能、不成熟的技术选择造成了一系列问题。

结果，生产环境成了系统管理员的噩梦，也成了吓唬年轻开发人员的故事。