<html>
<head>
<title>10 Selenium Webdriver Tips and Tricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">10个Selenium Webdriver提示和技巧</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/10-selenium-webdriver-tips-and-tricks-514f5ab928ec?source=collection_archive---------3-----------------------#2021-04-26">https://medium.com/javarevisited/10-selenium-webdriver-tips-and-tricks-514f5ab928ec?source=collection_archive---------3-----------------------#2021-04-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9a0702f940f960d7961310923fb67b4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*v3iQ57TKKT9Br3u7.png"/></div></div></figure><p id="eb76" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">很多时候，我们在使用Selenium Webdriver时会遇到一些简单的问题。几个简单的步骤就可以提高自动化测试的稳定性和执行速度。我已经列出了用Java开发Selenium时实时面临的各种用例。还列出了这些用例可以直接使用的代码片段。</p><p id="c659" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 1。抓取网页截图(针对故障/问题)</strong></p><p id="cca5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时，需要对网页进行截图。它有助于识别问题和调试测试用例。</p><p id="7315" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">屏幕截图使用以下代码片段</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5709" class="jx jy hi jt b fi jz ka l kb kc">File scrFile ;<br/>String pathofscreenshot;<br/>scrFile = ((TakesScreenshot)driver).getScreenshotAs(OutputType.FILE);<br/>FileUtils.copyFile(scrFile, new File(pathofscreenshot + "\\screenshot.png"));</span></pre><p id="20e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 2。取部分截图</strong></p><p id="8487" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时需要截取屏幕的一部分。例如，我们需要对网页中的弹出窗口或框架进行截图。</p><p id="0b4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要截取部分屏幕截图，请使用以下代码片段</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="23ac" class="jx jy hi jt b fi jz ka l kb kc">String screenShot = System.getProperty("user.dir") + "\\screenShot.png";<br/><br/>File screen = ((TakesScreenshot)driver).getScreenshotAs(OutputType.FILE);<br/><br/>Point p = webelement.getLocation();<br/><br/>int width = webelement.getSize().getWidth();<br/><br/>int height = webelement.getSize().getHeight();<br/><br/>BufferedImage img = ImageIO.read(screen);<br/><br/>BufferedImage dest = img.getSubimage(p.getX(), p.getY(), width,height);<br/><br/>ImageIO.write(dest, "png", screen);<br/><br/>FileUtils.copyFile(screen, new File(pathofscreenshot + "\\screenshot.png"));</span></pre><p id="b35a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 3。执行javascript(。js) </strong></p><p id="e451" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以执行javascript来进行自定义同步、更改一些值、启用/禁用元素或隐藏/显示元素。</p><p id="21cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用以下代码通过selenium webdriver执行javascript</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c65b" class="jx jy hi jt b fi jz ka l kb kc">JavascriptExecutor js = ((JavascriptExecutor) driver);<br/>js.executeScript("alert('hello world');");</span></pre><p id="8cdf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 4。从列表中选择/获取下拉选项。</strong></p><p id="1f2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用选择类来标识下拉元素</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="7678" class="jx jy hi jt b fi jz ka l kb kc">Select selectValue = new Select(webelement1);</span></pre><p id="b7dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">按索引选择选项</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b69f" class="jx jy hi jt b fi jz ka l kb kc">selectValue.selectByIndex(&lt;index in integer&gt;);</span></pre><p id="d01b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过值选择选项</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="a9a9" class="jx jy hi jt b fi jz ka l kb kc">selectValue.selectByValue(&lt;string value of dropdown option&gt;);</span></pre><p id="7be1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 5。使用拖放功能</strong></p><p id="714b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时需要将元件从一个位置移动到另一个位置。拖放在为webelement提供的基本方法中不可用。</p><p id="a2b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，selenium提供了Action类</p><p id="5bdc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用以下代码段从元素webElementFrom拖动到WebelementTo</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="595c" class="jx jy hi jt b fi jz ka l kb kc">Actions action = new Actions(driver);</span><span id="2b90" class="jx jy hi jt b fi kd ka l kb kc">Action dragAndDrop = action.clickAndHold(webElementFrom)<br/>.moveToElement(WebelementTo)<br/>.release(WebelementTo)<br/>.build();</span><span id="6efd" class="jx jy hi jt b fi kd ka l kb kc">dragAndDrop.perform();</span></pre><p id="d5c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 6。滚动网页(垂直&amp;水平)</strong></p><p id="82d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在selenium webdriver中，可以使用javascriptexecutor来完成滚动。在js executor中调用javascript函数window.scrollBy。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="7a2e" class="jx jy hi jt b fi jz ka l kb kc">((JavascriptExecutor)driver).executeScript("window.scrollBy(0,250);");</span></pre><p id="d391" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将垂直滚动网页250像素。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="4d4a" class="jx jy hi jt b fi jz ka l kb kc">((JavascriptExecutor)driver).executeScript("window.scrollBy(250,0);");</span></pre><p id="d99f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将使网页水平滚动250像素。</p><p id="0f52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 7。打开一个新标签页</strong></p><p id="5f8d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时需要在浏览器的同一个窗口中打开一个新标签页，使用下面的代码片段打开一个新标签页</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="4160" class="jx jy hi jt b fi jz ka l kb kc">driver.findElement(By.cssSelector("body")).sendKeys(Keys.CONTROL +"t");</span></pre><p id="f9d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在新选项卡上运行测试后，使用以下代码再次切换到第一个选项卡</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b144" class="jx jy hi jt b fi jz ka l kb kc">ArrayList&lt;String&gt; tab_list=new ArrayList&lt;String&gt; (driver.getWindowHandles()); driver.switchTo().window(tab_list.get(0));</span></pre><p id="5fb4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 8。设置页面加载超时</strong></p><p id="1835" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时网页需要一些时间来完全加载。要设置页面加载超时，请使用以下代码片段</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d392" class="jx jy hi jt b fi jz ka l kb kc">driver.manage().timeouts().pageLoadTimeout(40, TimeUnit.SECONDS);</span></pre><p id="ed05" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将使页面在40秒后超时。</p><p id="80d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> 9。刷新网页</strong></p><p id="efd8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时候网页中会出现元素没有加载，需要刷新页面来加载所有元素的情况。在大多数情况下，可以看到元素在第一次尝试时没有被加载，但是如果我们再次加载页面，所有的组件都会被加载</p><p id="f0d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用selenium刷新网页的方法有很多。一些方法如下:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="cbf2" class="jx jy hi jt b fi jz ka l kb kc">driver.navigate().refresh();<br/>driver.navigate().to(driver.getCurrentUrl());</span></pre><p id="0197" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设当前应用程序的url是google.co.in</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="ec1e" class="jx jy hi jt b fi jz ka l kb kc">driver.get("https://www.google.co.in");</span></pre><p id="0924" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以在任何元素上发送F5键</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="486b" class="jx jy hi jt b fi jz ka l kb kc">driver.findElement(By.id("id1")).sendKeys(Keys.F5);<br/>driver.findElement(By.id("id1")).sendKeys("\uE035");</span></pre><p id="b4ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，\uE035是id1的ASCII码</p><p id="c18d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们使用javascript执行器执行location.reload函数时，当前网页被加载</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="8f5e" class="jx jy hi jt b fi jz ka l kb kc">$ JavascriptExecutor js; $ js.executeScript("location.reload()");</span></pre><p id="7a88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">10。在浏览器窗口之间切换</p><p id="6640" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时点击一个元素，网页会打开一个新的弹出窗口，需要将驱动程序实例切换到新窗口并执行一些操作。</p><p id="468d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用下面的代码片段。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="40c4" class="jx jy hi jt b fi jz ka l kb kc">//Get the current window handle<br/><br/>String currentwindowhandle = driver.getWindowHandle();<br/><br/><br/><br/>//Click to open new windows.<br/>....<br/>....<br/>....<br/><br/><br/>//Switch to new window<br/><br/>for(String newwindowhandle: driver.getWindowHandles()){<br/><br/>driver.switchTo().window(newwindowhandle);<br/><br/>}<br/><br/><br/><br/>//Close new window<br/><br/>driver.close();<br/><br/><br/><br/>//Switch back to first window<br/><br/>driver.switchTo().window(currentwindowhandle);</span></pre></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="0429" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="kl">最初发表于</em><a class="ae km" href="https://www.linkedin.com/pulse/10-selenium-webdriver-tips-tricks-ankit-agrawal/" rel="noopener ugc nofollow" target="_blank">T5【https://www.linkedin.com】</a><em class="kl">。</em></p></div></div>    
</body>
</html>