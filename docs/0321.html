<html>
<head>
<title>Boost your Production at CSV files with Apache.commons.CSV in Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Java 中的 Apache.commons.CSV 提高 CSV 文件的产量</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/boost-your-productivity-at-csv-files-with-apache-commons-csv-in-java-c52b33037c4c?source=collection_archive---------1-----------------------#2020-03-04">https://medium.com/javarevisited/boost-your-productivity-at-csv-files-with-apache-commons-csv-in-java-c52b33037c4c?source=collection_archive---------1-----------------------#2020-03-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/aebeff20416f0ecbe987910a281b18de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZtqanFOkl_hZUHgf"/></div></div><p class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae iu" href="https://unsplash.com/@krisroller?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯托佛罗拉</a>拍摄的照片</p></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="dbab" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">1.介绍</h1><p id="a64d" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">CSV(逗号分隔值)文件广泛用于在应用程序之间交换数据。然而，对 CSV 文件的操作可能会很棘手且耗时。</p><p id="ac16" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">Apache 软件基金会给了我们<a class="ae iu" href="https://commons.apache.org/proper/commons-csv/summary.html" rel="noopener ugc nofollow" target="_blank">的 T5。Commons.CSV  </a>库，通过 CSV 文件的读/写操作使我们的生活变得更加轻松。因此它附带了 Apache 许可证 2.0。</p><p id="429a" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">CSV 文件有多种格式，在下面的例子中我们将使用经典的<a class="ae iu" href="https://tools.ietf.org/html/rfc4180" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hj"> RFC4180 </strong> </a>格式。</p><p id="45cb" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated"><strong class="kc hj"> RFC4180 </strong>格式规格根据<a class="ae iu" href="https://en.wikipedia.org/wiki/Comma-separated_values" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hj">维基百科</strong> </a>:</p><blockquote class="ld le lf"><p id="df21" class="ka kb lg kc b kd ky kf kg kh kz kj kk lh la kn ko li lb kr ks lj lc kv kw kx hb bi translated"><a class="ae iu" href="https://en.wikipedia.org/wiki/Plain_text" rel="noopener ugc nofollow" target="_blank">纯文本</a>是否使用了字符集，如<a class="ae iu" href="https://en.wikipedia.org/wiki/ASCII" rel="noopener ugc nofollow" target="_blank"> ASCII </a>、各种<a class="ae iu" href="https://en.wikipedia.org/wiki/Unicode" rel="noopener ugc nofollow" target="_blank"> Unicode </a>字符集(如<a class="ae iu" href="https://en.wikipedia.org/wiki/UTF-8" rel="noopener ugc nofollow" target="_blank"> UTF-8 </a>)、<a class="ae iu" href="https://en.wikipedia.org/wiki/EBCDIC" rel="noopener ugc nofollow" target="_blank"> EBCDIC </a>或<a class="ae iu" href="https://en.wikipedia.org/wiki/Shift_JIS" rel="noopener ugc nofollow" target="_blank"> Shift JIS </a>，</p><p id="21ba" class="ka kb lg kc b kd ky kf kg kh kz kj kk lh la kn ko li lb kr ks lj lc kv kw kx hb bi translated">由<a class="ae iu" href="https://en.wikipedia.org/wiki/Record_(computer_science)" rel="noopener ugc nofollow" target="_blank">记录</a>组成(通常每行一条记录)，</p><p id="623e" class="ka kb lg kc b kd ky kf kg kh kz kj kk lh la kn ko li lb kr ks lj lc kv kw kx hb bi translated">记录被分成由<a class="ae iu" href="https://en.wikipedia.org/wiki/Delimiter" rel="noopener ugc nofollow" target="_blank">分隔符</a>分隔的<a class="ae iu" href="https://en.wikipedia.org/wiki/Field_(computer_science)" rel="noopener ugc nofollow" target="_blank">字段</a>(通常是单个保留字符，如逗号、分号或制表符；有时定界符可以包括可选的空格)，</p><p id="6504" class="ka kb lg kc b kd ky kf kg kh kz kj kk lh la kn ko li lb kr ks lj lc kv kw kx hb bi translated">其中每个记录都有相同的字段序列。</p></blockquote><div class="lk ll ez fb lm ln"><a rel="noopener follow" target="_blank" href="/javarevisited/what-java-programmers-should-learn-in-2020-648050533c83"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hj fi z dy ls ea eb lt ed ef hh bi translated">2020 年 Java 程序员该学什么？</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">2020 年 Java 程序员可以学习的有用工具、技术、框架和库</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb io ln"/></div></div></a></div><h1 id="0349" class="jc jd hi bd je jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz bi translated">2.用 Apache Commons CSV 读取 CSV 文件</h1><p id="5b3d" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">创建一个名为<strong class="kc hj"> ParseCSV </strong>的新 maven 项目，并将下面的代码片段粘贴到您的<strong class="kc hj"> ParseCSV/pom.xml </strong>文件中:</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="eda1" class="mq jd hi mm b fi mr ms l mt mu">&lt;dependency&gt;</span><span id="01b7" class="mq jd hi mm b fi mv ms l mt mu">&lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</span><span id="84f4" class="mq jd hi mm b fi mv ms l mt mu">&lt;artifactId&gt;commons-csv&lt;/artifactId&gt;</span><span id="f219" class="mq jd hi mm b fi mv ms l mt mu">&lt;version&gt;1.8&lt;/version&gt;</span><span id="9fa0" class="mq jd hi mm b fi mv ms l mt mu">&lt;/dependency&gt;</span></pre><p id="87fa" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">上述依赖项将为我们的示例下载必要的库。</p><p id="617c" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">下载一个包含国家的示例<a class="ae iu" href="https://gist.github.com/petranb2/5f2f877df3b15042151cf80ba49bba4a" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hj"> CSV </strong> </a>文件，并将其粘贴到您的项目目录<strong class="kc hj"><em class="lg">parse CSV/countries . CSV</em></strong>。</p><p id="2dad" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">将以下代码添加到您的 main 方法中:</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="257a" class="mq jd hi mm b fi mr ms l mt mu">try {</span><span id="4726" class="mq jd hi mm b fi mv ms l mt mu">Reader csvData = new FileReader("countries.csv");</span><span id="3084" class="mq jd hi mm b fi mv ms l mt mu">CSVParser parser = CSVFormat.RFC4180.withFirstRecordAsHeader().parse(csvData);</span><span id="9b8c" class="mq jd hi mm b fi mv ms l mt mu">for (CSVRecord csvRecord : parser) {</span><span id="8215" class="mq jd hi mm b fi mv ms l mt mu">System.out.println(csvRecord.getRecordNumber()+":"+csvRecord.get("name"));</span><span id="d962" class="mq jd hi mm b fi mv ms l mt mu">}</span><span id="43ea" class="mq jd hi mm b fi mv ms l mt mu">} catch (FileNotFoundException e) {</span><span id="7492" class="mq jd hi mm b fi mv ms l mt mu">e.printStackTrace();</span><span id="4aed" class="mq jd hi mm b fi mv ms l mt mu">} catch (IOException e) {</span><span id="dc14" class="mq jd hi mm b fi mv ms l mt mu">e.printStackTrace();</span><span id="aa66" class="mq jd hi mm b fi mv ms l mt mu">}</span></pre><p id="f2ae" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">让我们解释一下上面的代码片段:</p><p id="f515" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">首先，我们创建一个<strong class="kc hj"> Reader </strong>对象来读取<strong class="kc hj"> countries.csv </strong>文件。</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="7878" class="mq jd hi mm b fi mr ms l mt mu">Reader csvData = new FileReader("countries.csv");</span></pre><p id="741e" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">我们使用<strong class="kc hj"> CSVFormat </strong>静态对象创建一个<strong class="kc hj"> CSVParser </strong>解析 CSV 文件，格式为<strong class="kc hj"> RFC4180 </strong>，头为<strong class="kc hj">第一条记录</strong>。</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="4c29" class="mq jd hi mm b fi mr ms l mt mu">CSVParser parser = CSVFormat.RFC4180.withFirstRecordAsHeader().parse(csvData);</span></pre><p id="425f" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">最后，迭代<strong class="kc hj">解析器</strong>对象从文件中获取数据。</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="e932" class="mq jd hi mm b fi mr ms l mt mu">for (CSVRecord csvRecord : parser) {</span><span id="f774" class="mq jd hi mm b fi mv ms l mt mu">System.out.println(csvRecord.getRecordNumber()+":"+csvRecord.get("name"));</span><span id="b37b" class="mq jd hi mm b fi mv ms l mt mu">}</span></pre><p id="5296" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated"><a class="ae iu" href="https://commons.apache.org/proper/commons-csv/summary.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hj">阿帕奇。Commons.CSV </strong> </a> <strong class="kc hj"> </strong>提供了几种方法来读取 CSV 文件中的字段，在本例中，我们使用标题名来访问数据，但也可以使用索引号来访问数据。</p><div class="lk ll ez fb lm ln"><a rel="noopener follow" target="_blank" href="/javarevisited/what-next-for-senior-developers-in-tech-project-manager-technical-architect-or-a-devops-engineer-b532a80c9ba1"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hj fi z dy ls ea eb lt ed ef hh bi translated">高科技领域的高级开发人员接下来会做什么？项目经理、技术架构师或 DevOps 工程师</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">是时候考虑职业生涯的下一个层次了。</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">medium.com</p></div></div><div class="lw l"><div class="mw l ly lz ma lw mb io ln"/></div></div></a></div><h1 id="1119" class="jc jd hi bd je jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz bi translated">3.用 Apache Commons CSV 编写 CSV 文件</h1><p id="dde8" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">用<a class="ae iu" href="https://commons.apache.org/proper/commons-csv/summary.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hj"> Apache 写<strong class="kc hj"> CSV </strong>文件。Commons.CSV </strong> </a>一样简单。</p><p id="2db9" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">复制并粘贴以下代码片段:</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="4905" class="mq jd hi mm b fi mr ms l mt mu">try {</span><span id="d266" class="mq jd hi mm b fi mv ms l mt mu">FileWriter fileWriter = new FileWriter("./mountains.csv", true);</span><span id="5cfb" class="mq jd hi mm b fi mv ms l mt mu">try (CSVPrinter csvPrinter = new CSVPrinter(fileWriter, CSVFormat.RFC4180)) {</span><span id="3e82" class="mq jd hi mm b fi mv ms l mt mu">//HEADER record</span><span id="5686" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("mountain","meters");</span><span id="a9af" class="mq jd hi mm b fi mv ms l mt mu">//DATA records</span><span id="bd57" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("Mount Everest","8.848");</span><span id="8f66" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("K2","8.611");</span><span id="aa08" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("Kangchenjunga","8.586");</span><span id="6317" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("olumpus","2.918");</span><span id="dc2a" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.flush();</span><span id="796b" class="mq jd hi mm b fi mv ms l mt mu">}</span><span id="58b1" class="mq jd hi mm b fi mv ms l mt mu">} catch (IOException e) {</span><span id="ccd3" class="mq jd hi mm b fi mv ms l mt mu">e.printStackTrace();</span><span id="052b" class="mq jd hi mm b fi mv ms l mt mu">}</span></pre><p id="1019" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">让我们解释一下上面的代码片段:</p><p id="f1b7" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">第一步创建一个<strong class="kc hj">文件写入器</strong>，以便写入 mountains.csv 文件</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="fda9" class="mq jd hi mm b fi mr ms l mt mu">FileWriter fileWriter = new FileWriter("./mountains.csv", true);</span></pre><p id="45b8" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">接下来，使用<strong class="kc hj"> CSVPrinter </strong>类生成一个 csvWriter 并开始编写</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="6a8f" class="mq jd hi mm b fi mr ms l mt mu">CSVPrinter csvPrinter= new CSVPrinter(fileWriter, CSVFormat.RFC4180)</span></pre><p id="8cb1" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">终于到了开始写数据的时候了</p><pre class="mh mi mj mk fd ml mm mn mo aw mp bi"><span id="44f2" class="mq jd hi mm b fi mr ms l mt mu">//HEADER record</span><span id="5278" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("mountain","meters");</span><span id="70cd" class="mq jd hi mm b fi mv ms l mt mu">//DATA records</span><span id="c45a" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("Mount Everest","8.848");</span><span id="c68a" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("K2","8.611");</span><span id="b7c5" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("Kangchenjunga","8.586");</span><span id="cc3d" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.printRecord("olumpus","2.918");</span><span id="7e5b" class="mq jd hi mm b fi mv ms l mt mu">csvPrinter.flush();</span></pre><h1 id="426c" class="jc jd hi bd je jf mc jh ji jj md jl jm jn me jp jq jr mf jt ju jv mg jx jy jz bi translated">4.结论</h1><p id="18bb" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated"><a class="ae iu" href="https://commons.apache.org/proper/commons-csv/summary.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hj">阿帕奇。Commons.CSV </strong> </a>为 CSV 文件的读/写操作提供了一个简单的接口。</p><p id="55c3" class="pw-post-body-paragraph ka kb hi kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hb bi translated">然而，Apache Commons CSV 是最好的库之一，具有定期更新和丰富的文档。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><figure class="mh mi mj mk fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="2c2b" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">您可能还喜欢:</h1><div class="lk ll ez fb lm ln"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/how-to-build-a-rest-api-with-node-js-and-oracle-18c-xe-f57bbbdd9b09"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hj fi z dy ls ea eb lt ed ef hh bi translated">用 Node.js 和 Oracle 18c XE 像专业人士一样在 5 分钟内构建一个 REST Api。</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">在本教程中，我们将介绍如何使用 node.js 和 Oracle 18c XE 构建 REST API。</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">medium.com</p></div></div><div class="lw l"><div class="mz l ly lz ma lw mb io ln"/></div></div></a></div><div class="lk ll ez fb lm ln"><a rel="noopener follow" target="_blank" href="/javascript-in-plain-english/learn-to-use-regular-expressions-like-a-ninja-in-node-js-20cfb6806f26"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hj fi z dy ls ea eb lt ed ef hh bi translated">Node.js 中的正则表达式备忘单</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">轻松学习、编写和执行正则表达式的详细故事。</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">medium.com</p></div></div><div class="lw l"><div class="na l ly lz ma lw mb io ln"/></div></div></a></div></div></div>    
</body>
</html>