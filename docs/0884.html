<html>
<head>
<title>Java’s Records vs Kotlin’s Data Classes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Java的记录与Kotlin的数据类</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/javas-records-vs-kotlin-s-data-classes-b3fef851155a?source=collection_archive---------2-----------------------#2020-12-31">https://medium.com/javarevisited/javas-records-vs-kotlin-s-data-classes-b3fef851155a?source=collection_archive---------2-----------------------#2020-12-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="80cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Java中的记录类与Kotlin的数据类相比如何。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/151a090e8aedde03b12d5d96612f949d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_GNCAliJziMztyBkB7eKNA.jpeg"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@asthetik?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">迈克·肯尼利</a>在<a class="ae jt" href="https://unsplash.com/s/photos/java?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="11c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近发布的Java有一些非常值得注意的和开发人员友好的特性，包括记录类的概念。从<code class="du ju jv jw jx b">Record</code>类的Java文档中:</p><blockquote class="jy jz ka"><p id="45f0" class="if ig kb ih b ii ij ik il im in io ip kc ir is it kd iv iw ix ke iz ja jb jc hb bi translated">记录类是一个不可变的透明载体，它包含一组固定的值，称为记录组件。Java语言<a class="ae jt" rel="noopener" href="/javarevisited/python-or-java-which-programming-language-beginners-should-learn-in-2020-de992b2650ec">为声明记录类提供了简洁的语法，记录组件在记录头中声明。记录头中声明的记录成分列表构成了记录描述符。</a></p></blockquote><p id="be19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我看到这个类的第一个想法是，作为一个已经使用了<a class="ae jt" rel="noopener" href="/javarevisited/top-5-courses-to-learn-kotlin-in-2020-dfc3fa7706d8?source=---------16------------------"> Kotlin </a>一段时间的人，我不禁想知道这听起来和Kotlin的<a class="ae jt" href="https://kotlinlang.org/docs/reference/data-classes.html" rel="noopener ugc nofollow" target="_blank">数据类</a>有多相似。</p><p id="9843" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我做了一些探索，这是我比较Java的记录和Kotlin的数据类的第一印象。但在此之前，让我们快速了解一下这些是什么，以及我们如何创建一个:</p><h1 id="8945" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">记录</h1><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="11d6" class="lh kg hi jx b fi li lj l lk ll">public record Sample (String key, String value) {}</span></pre><p id="8b56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">记录是从Java的基类<code class="du ju jv jw jx b">Record</code>扩展而来的数据容器。记录类的一个关键特性是</p><ul class=""><li id="2715" class="lm ln hi ih b ii ij im in iq lo iu lp iy lq jc lr ls lt lu bi translated">所有属性都是最终的和私有的。</li><li id="4561" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">使用<code class="du ju jv jw jx b">record</code>关键字声明一个类会生成<code class="du ju jv jw jx b">equals()</code>、<code class="du ju jv jw jx b">hashcode()</code>和<code class="du ju jv jw jx b">toString()</code>方法，从而减少锅炉板代码。</li></ul><h1 id="f557" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">数据类</h1><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="8c44" class="lh kg hi jx b fi li lj l lk ll">data class Sample (val key, val value)</span></pre><p id="1460" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据类是<a class="ae jt" rel="noopener" href="/javarevisited/7-free-courses-to-learn-kotlin-in-2020-327c3872c1e1?source=collection_home---4------2-----------------------"> Kotlin的</a>数据容器类，它的一些关键特性是:</p><ul class=""><li id="8357" class="lm ln hi ih b ii ij im in iq lo iu lp iy lq jc lr ls lt lu bi translated">属性可以是最终的，也可以不是(将属性声明为<code class="du ju jv jw jx b"><a class="ae jt" href="https://javarevisited.blogspot.com/2018/03/finally-java-10-has-var-to-declare-local-variables.html" rel="noopener ugc nofollow" target="_blank">var</a></code> <a class="ae jt" href="https://javarevisited.blogspot.com/2018/03/finally-java-10-has-var-to-declare-local-variables.html" rel="noopener ugc nofollow" target="_blank"> </a>会使它们不是最终的，因此它们可以被更改)。</li><li id="a19f" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">与记录类类似，将类声明为数据类会自动生成<code class="du ju jv jw jx b"><a class="ae jt" href="https://javarevisited.blogspot.com/2015/01/why-override-equals-hashcode-or-tostring-java.html" rel="noopener ugc nofollow" target="_blank">equals()</a></code>、<code class="du ju jv jw jx b"><a class="ae jt" href="http://www.java67.com/2013/04/example-of-overriding-equals-hashcode-compareTo-java-method.html" rel="noopener ugc nofollow" target="_blank">hashcode()</a></code>和<code class="du ju jv jw jx b"><a class="ae jt" href="https://javarevisited.blogspot.com/2012/12/3-example-to-print-array-values-in-java.html" rel="noopener ugc nofollow" target="_blank">toString()</a></code>方法。</li></ul><p id="6212" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">抛开基本定义不谈，让我们来谈谈一些关键的相同点和不同点:</p><h1 id="13e0" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">类似</h1><p id="ba7a" class="pw-post-body-paragraph if ig hi ih b ii ma ik il im mb io ip iq mc is it iu md iw ix iy me ja jb jc hb bi translated">首先想到的显然是这两个特性如何通过自动生成三个方法来消除对样板代码的需求:<code class="du ju jv jw jx b">equals()</code>、<code class="du ju jv jw jx b">hashcode()</code>和<code class="du ju jv jw jx b">toString()</code>。在引擎盖下，这些代码是如何生成的是不同的，但是从一个高级开发人员的角度来看，代码是自动生成的。</p><h1 id="f7f1" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">差异</h1><p id="95e6" class="pw-post-body-paragraph if ig hi ih b ii ma ik il im mb io ip iq mc is it iu md iw ix iy me ja jb jc hb bi translated"><strong class="ih hj"> 1: </strong>数据类提供了一个额外的现成的<code class="du ju jv jw jx b">copy()</code>方法，允许您通过为该字段指定一个新值来选择性地更改类的属性值，而不必复制所有其他不需要新值的值。</p><p id="04c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，让我们创建一个<code class="du ju jv jw jx b">Sample</code>数据类的对象:</p><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="af0b" class="lh kg hi jx b fi li lj l lk ll">var sample1 = Sample("Key-1", "Value-1")</span></pre><p id="3956" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们要创建另一个类似于<code class="du ju jv jw jx b">sample1</code>的样本对象，但只改变关键字段的值，我们可以这样做:</p><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="2b17" class="lh kg hi jx b fi li lj l lk ll">val sample2 = sample1.copy(key = "Key-2")</span></pre><p id="aff0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您的数据类中有多个字段，而您只需更改其中一个字段时，这一特性就会大放异彩。记录没有这种功能。</p><p id="ea03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2: </strong>记录类中的字段都是私有的和最终的，但是对于数据类，情况并不总是这样，因为这取决于字段是如何声明的。例如，如果我们要将<code class="du ju jv jw jx b">Sample</code>类更新如下:</p><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="eb57" class="lh kg hi jx b fi li lj l lk ll">data class Sample(var key, var value)</span></pre><p id="0263" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以更改字段<code class="du ju jv jw jx b">key</code>和<code class="du ju jv jw jx b">value</code>的值，因为它们现在是<code class="du ju jv jw jx b">var</code>对<code class="du ju jv jw jx b">val</code>。</p><p id="b9e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3: </strong>没有基本的数据类，相反,<code class="du ju jv jw jx b">data</code>只是一个关键字，用来表示声明的是什么类型的类。对于记录，JDK中提供了一个基类<code class="du ju jv jw jx b">Record</code>，所有声明为<code class="du ju jv jw jx b">record</code>类的类都是从这个基类扩展而来的。基类<code class="du ju jv jw jx b">Record</code>提供了<code class="du ju jv jw jx b">hashCode()</code>、<code class="du ju jv jw jx b">toString()</code>和<code class="du ju jv jw jx b"><a class="ae jt" href="http://javarevisited.blogspot.sg/2013/08/10-equals-and-hashcode-interview.html" rel="noopener ugc nofollow" target="_blank">equals()</a></code>方法。</p><p id="ec0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4: </strong>数据类可以扩展<a class="ae jt" href="https://javarevisited.blogspot.com/2018/02/5-courses-to-learn-kotlin-programming-java-android.html#axzz6NpvpUald" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>中的其他类，如果这些类可以并且被标记为开放的(使其可继承)。注意，在<a class="ae jt" href="https://www.java67.com/2020/05/5-free-courses-to-learn-kotlin-for-java-and-Android-developers.html" rel="noopener ugc nofollow" target="_blank"> Koltin </a>中，所有的类默认都是最终的，除非它们被标记为<code class="du ju jv jw jx b">open</code>。但是Java的记录类不能扩展其他类。例如，以下代码将在Kotlin中工作:</p><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="85d2" class="lh kg hi jx b fi li lj l lk ll">open class Parent<br/></span><span id="ccc4" class="lh kg hi jx b fi mf lj l lk ll">data class Sample(var key, var value): Parent()</span></pre><p id="a802" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，下面的代码不能在Java中编译(假设<code class="du ju jv jw jx b">Parent</code>类是</p><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="fe48" class="lh kg hi jx b fi li lj l lk ll">class Parent {</span><span id="d285" class="lh kg hi jx b fi mf lj l lk ll">}<br/></span><span id="ab46" class="lh kg hi jx b fi mf lj l lk ll">public record SampleRecord(String key, String value) extends Parent</span><span id="fa03" class="lh kg hi jx b fi mf lj l lk ll">// The above line will fail to compile with "No extends clause <br/>// allowed for record"</span></pre><p id="c40e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5: </strong>记录和数据类之间最后也是最重要的区别(在我看来)是定义实例变量的能力。在数据类中，我们可以执行以下操作:</p><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="f936" class="lh kg hi jx b fi li lj l lk ll">data class Sample(var key, var value) {</span><span id="bb90" class="lh kg hi jx b fi mf lj l lk ll">    var option: String? = ""</span><span id="ba51" class="lh kg hi jx b fi mf lj l lk ll">}</span></pre><p id="b7c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们创建一个类型为<code class="du ju jv jw jx b">Sample</code>的对象时，我们可以选择为<code class="du ju jv jw jx b">option</code>字段提供一个值。另一方面，记录类不允许实例变量。因此下面的代码不会编译:</p><pre class="je jf jg jh fd ld jx le lf aw lg bi"><span id="b628" class="lh kg hi jx b fi li lj l lk ll">public record SampleRecord(String key, String value) {<br/><br/>    String hello = "";     // This line will not compile.<br/>}</span></pre><h1 id="70e8" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">结论</h1><p id="11fe" class="pw-post-body-paragraph if ig hi ih b ii ma ik il im mb io ip iq mc is it iu md iw ix iy me ja jb jc hb bi translated">我希望这是Java的记录类与Kotlin的数据类相比的一个很好的总结！与数据类相比，记录类无疑更加不可变，数据类的<a class="ae jt" rel="noopener" href="/javarevisited/how-to-create-an-immutable-list-list-and-map-in-java-5ac1254c128?source=---------31------------------">不变性</a>取决于类的声明方式。但是两者之间的相似性是所有开发人员的一大胜利:自动生成样板代码！</p></div></div>    
</body>
</html>