<html>
<head>
<title>End to end testing with Cucumber, Playwright and Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黄瓜、剧作家和硒的端到端测试</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/end-to-end-testing-with-cucumber-playwright-and-selenium-928af278e789?source=collection_archive---------3-----------------------#2022-12-02">https://medium.com/javarevisited/end-to-end-testing-with-cucumber-playwright-and-selenium-928af278e789?source=collection_archive---------3-----------------------#2022-12-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="eb39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于应用程序来说，有几种有用的测试，但是当然，端到端测试(<strong class="ih hj"> e2e </strong>)是最重要的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/7e03d4f4a538fa68d37b22069d895941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/0*qMZYcF58H1di9-G0.jpg"/></div></figure></div><div class="ab cl jl jm gp jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="hb hc hd he hf"><p id="0273" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们看一看<a class="ae js" href="https://www.mountaingoatsoftware.com/blog/the-forgotten-layer-of-the-test-automation-pyramid" rel="noopener ugc nofollow" target="_blank">迈克·科恩的概念</a>，被称为<strong class="ih hj">测试金字塔</strong>，很明显，e2e测试是我们可以为我们的应用程序产生的最高级别的测试形式，考虑到软件是一个黑匣子，我们的主要关注点与行为和功能有关。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://medium.com/javarevisited/my-favorite-free-courses-to-learn-selenium-web-drive-for-automation-testing-2f248c8fe6aa"><div class="er es jt"><img src="../Images/63ec488a8e499c8a0486b22382313645.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/0*JC9Fw0VQz-H-k5eB.png"/></div></a></figure><p id="ab23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当引入新功能/开发时，我们的系统必须如何工作的知识以及以“自动方式”注册和检查它的可能性可能是有用的，我们希望确保避免回归问题。除此之外，如果我们想要模拟一个负载测试，自动化测试也会很有用。</p><p id="17a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一种有趣的方法是定义应用程序行为，描述用户和浏览器之间的交互。我们可以使用许多框架和库来进行这些测试，而带有<strong class="ih hj">小黄瓜</strong>语法的<strong class="ih hj"> BDD </strong>，<a class="ae js" rel="noopener" href="/javarevisited/cucumber-testcontainer-a-bdd-perfect-match-956cf62cdf47">就像这里看到的</a>一样，是描述功能的一个很好的解决方案。</p><h1 id="ccb1" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">小黄瓜和范例项目</h1><p id="b5b4" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">假设我们的系统有一个前端<strong class="ih hj"> Angular </strong>应用程序，它可以从几个后端端点调用服务(我们不关心这个)。我们将使用来自<a class="ae js" href="https://jasonwatmore.com/post/2020/04/28/angular-9-user-registration-and-login-example-tutorial" rel="noopener ugc nofollow" target="_blank">本文</a>的一个示例登录/注册项目，它可以在<a class="ae js" href="https://github.com/fpaparoni/test-e2e" rel="noopener ugc nofollow" target="_blank">Github资源库</a>中找到，其中包含与本文相关的所有源代码。</p><p id="fd8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们想描述一些与用户注册功能相关的场景</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://medium.com/javarevisited/my-favorite-free-courses-to-learn-selenium-web-drive-for-automation-testing-2f248c8fe6aa"><div class="er es kx"><img src="../Images/301d353157c27f5535c3f06c30378805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SgvnTYNFDN7J3AGY.png"/></div></a></figure><p id="d51f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">描述这种场景所需的小黄瓜语法非常简单，您可以从下一个特性文件中找到，在这里我们创建了4个注册失败的场景和1个一切正常的场景</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><h1 id="9626" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">硒&amp;黄瓜测试实施</h1><p id="3908" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">正如我们所说，有很多工具可以创建e2e测试，在本文中，我们将使用<a class="ae js" href="https://www.selenium.dev/" rel="noopener ugc nofollow" target="_blank"> Selenium </a>和<a class="ae js" href="https://cucumber.io/" rel="noopener ugc nofollow" target="_blank">cumber</a>。诞生于2004年的开源项目<a class="ae js" rel="noopener" href="/javarevisited/my-favorite-free-courses-to-learn-selenium-web-drive-for-automation-testing-2f248c8fe6aa"> <strong class="ih hj"> Selenium </strong> </a>，如今通常被认为是端到端web测试事实上的标准框架。</p><p id="cae3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以找到许多与Selenium相关的项目和扩展，尽管它年代久远，但它仍然是一个非常有用和完整的工具。</p><p id="a669" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的测试项目将使用<a class="ae js" rel="noopener" href="/javarevisited/top-7-courses-to-learn-selenium-for-java-and-c-developers-to-learn-automation-testing-free-and-e91637cd9622?source=---------19------------------"> Selenium </a>来驱动浏览器，遵循使用Gherkin描述并由<a class="ae js" rel="noopener" href="/javarevisited/top-7-courses-to-learn-selenium-for-java-and-c-developers-to-learn-automation-testing-free-and-e91637cd9622?source=---------19------------------">cumber</a>执行的场景。让我们给pom.xml添加一些<strong class="ih hj"> Maven </strong>依赖项</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="8bc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">先前定义的小黄瓜场景将保存在一个特征文件中，Cucumber使用它来驱动测试的执行。</p><p id="a4f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以设置Selenium引擎，使用一个简单的实用程序类创建一个<strong class="ih hj"> WebDriver </strong>类实例。如果我们想选择一个特定的浏览器，我们必须将它的驱动程序下载到我们的环境中。在下面的列表中，您可以找到这个项目中使用的浏览器以及您必须设置的相关env属性(也可以在启动最终测试程序时从命令行设置)</p><ul class=""><li id="a68a" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated"><strong class="ih hj">Chrome</strong>:<a class="ae js" href="http://chromedriver.chromium.org" rel="noopener ugc nofollow" target="_blank">Chrome driver</a>(web driver . Chrome . driver = path/to/the/driver)</li><li id="c683" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated"><strong class="ih hj">火狐</strong>:<a class="ae js" href="https://github.com/mozilla/geckodriver/releases" rel="noopener ugc nofollow" target="_blank">GeckoDriver</a>(web driver . gecko . driver = path/to/the/driver)</li></ul><p id="bf84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<strong class="ih hj">测试浏览器</strong>环境变量你可以选择使用哪个浏览器，默认选择将是Chrome</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="794b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在注释之后添加<a class="ae js" href="https://javarevisited.blogspot.com/2021/04/junit-interview-questions-with-answers.html#axzz6w2HbPhVo" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> JUnit </strong> <strong class="ih hj">我们可以选择在单个测试执行结束时要做的事情。如果我们的场景失败了，我们使用Selenium从浏览器中保存一个截图，这样我们可以稍后进行调查。</strong></a></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="29ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们实现的最后一步是使用Selenium API来描述与前端应用程序的交互。你可以从头开始写，也可以使用浏览器插件<a class="ae js" href="https://www.selenium.dev/selenium-ide/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Selenium IDE </strong> </a>。</p><p id="e4d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我最喜欢的方法是使用Selenium IDE创建一个草案版本，然后我可以重构它</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="e756" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，我们的测试实现试图复制用户与浏览器的交互。例如，当我想确认注册时，我会检查页面上的文本“注册成功”。</p><h1 id="a347" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">剧作家&amp;黄瓜测试实现</h1><p id="e351" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">使用相同的特征文件我们可以使用另一个有趣的工具:<a class="ae js" href="https://playwright.dev/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">剧作家</strong> </a>。</p><p id="0f52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个<strong class="ih hj">微软</strong>开源项目，提供了一个完整的API来创建端到端测试。这个项目有多个绑定，这里我们将使用<a class="ae js" href="https://github.com/microsoft/playwright-java" rel="noopener ugc nofollow" target="_blank"> Java实现</a>。</p><p id="002f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与<a class="ae js" href="https://javarevisited.blogspot.com/2020/08/top-5-courses-to-learn-selenium-for.html#axzz6oau61e3Q" rel="noopener ugc nofollow" target="_blank"> Selenium </a>相比，它是一个更新的项目，具有有趣的特性，并且可能与现代web应用程序更加“兼容”,但是我们必须在一些实际实现中使用它来评估这个项目的成熟度。</p><p id="8a76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们将依赖项添加到pom.xml中</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="8272" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">测试用例实现将遵循我们用于Selenium的相同“模式”。所以我们必须定义一个测试类来匹配黄瓜和剧作家</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="0bac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有Setup类的定义，在这里我们选择浏览器并设置一些参数</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="bad4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">剧作家没有浏览器驱动程序安装作为先决条件，因为如果它不可用，剧作家将在第一次测试执行时自动下载它。</p><p id="53ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除此之外，我们还有一个非常有趣的特性(Selenium中没有):<strong class="ih hj">视频</strong>注册我们的测试。</p><p id="d064" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们必须使用剧作家API来实现测试用例(与Selenium相比，它看起来有点可读性，但这是个人观点)</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="bec7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以使用剧作家特性来记录视频，从而管理失败的测试执行。如果场景失败，我们可以将这个<strong class="ih hj"> WebM </strong>视频添加到Cucumber报告中</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ky kz l"/></div></figure><h1 id="b12f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">让我们开始测试</h1><p id="3319" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们必须开始角度应用。您可以进入<strong class="ih hj">angular-9-registration-log in-example</strong>文件夹，使用以下命令创建一个<a class="ae js" rel="noopener" href="/javarevisited/5-best-docker-courses-for-java-and-spring-boot-developers-bbf01c5e6542">T21Docker</a>图像</p><p id="d90b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lo lp lq lr b">docker build --no-cache -t bddfe .</code></p><p id="83b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后你就可以开始了</p><p id="4b1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lo lp lq lr b">docker run -p 80:80 -t bddfe</code></p><p id="8562" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你将浏览器指向<a class="ae js" href="http://localhost" rel="noopener ugc nofollow" target="_blank"> http://localhost </a>，你应该会看到应用程序正在运行。现在您可以启动测试了(记得在您的env中定义<strong class="ih hj"> webdriver.gecko.driver </strong>或<strong class="ih hj"> webdriver.chrome.driver </strong>，否则您必须只为Selenium传递这个附加参数)</p><p id="7d3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lo lp lq lr b">mvn install</code>T3】</p><p id="58ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将在您的计算机上看到一些"<em class="ls">浏览器窗口在跳舞</em>，在执行测试之后，您可以使用<strong class="ih hj">cumber</strong>报告来控制结果，该报告位于<strong class="ih hj">target/cumber _ reports/</strong>文件夹中</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://javarevisited.blogspot.com/2019/05/top-5-courses-to-learn-docker-and-kubernetes-for-devops.html#axzz7DP5DDtxT"><div class="er es kx"><img src="../Images/cdbd9359e40b2c4994b9a9d3b79d0d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PMeucwSJVmo_r0g0.png"/></div></a></figure><p id="67ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用了两个不同的端到端测试引擎(Selenium和剧作家)和相同的特性文件，所以我们将有两个不同的cumber报告。</p><p id="9676" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们想模拟一个错误，我们可以将字符串“注册成功”上的复选标记改为“doh”以再次启动测试。在Selenium报告中，我们将看到一个截图</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lt"><img src="../Images/6bcb08134f3e2c3132e506c7dcf5dfb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4rAKLIjGTRjqZ3wDBl07tA.png"/></div></div></figure><p id="e070" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在《剧作家》中，我们会有一个关于我们问题的视频</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ly kz l"/></div></figure><h1 id="ad4c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="e4bf" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">本文中使用的测试项目实现展示了使用一个库来描述端到端测试(Cucumber)和其他工具来使用一个真实的浏览器驱动程序模拟这些测试(Selenium和剧作家)的可能性。</p><p id="cb17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些库还提供了不同的语言实现，所以你也可以使用<a class="ae js" rel="noopener" href="/javarevisited/top-10-free-typescript-courses-to-learn-online-best-of-lot-44bce9da41d1"> Typescript </a>、<a class="ae js" rel="noopener" href="/javarevisited/7-best-python-online-courses-for-beginners-to-learn-programming-abe12cecb1ad"> Python </a>或<a class="ae js" rel="noopener" href="/javarevisited/5-best-c-c-sharp-programming-courses-for-beginners-in-2020-494f7afc7a5c"> C# </a>来重新创建这个混搭。</p><p id="6085" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个<a class="ae js" href="https://github.com/fpaparoni/test-e2e" rel="noopener ugc nofollow" target="_blank">仓库</a>中，您可以找到与本文相关的源代码。</p></div></div>    
</body>
</html>