<html>
<head>
<title>Spring Cloud Alibaba’s Tutorial from Getting Started to a Master (2) — Nacos Service Registration Discovery Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">春云阿里巴巴从入门到精通的教程(二)——Nacos服务注册发现功能</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/spring-cloud-alibaba-from-fresh-to-profession-tutorial-2-quick-integration-configuration-1aecb16bae5d?source=collection_archive---------6-----------------------#2022-05-18">https://medium.com/javarevisited/spring-cloud-alibaba-from-fresh-to-profession-tutorial-2-quick-integration-configuration-1aecb16bae5d?source=collection_archive---------6-----------------------#2022-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="371d" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">项目中的快速集成配置中心Nacos服务注册发现功能</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f60e111492c6fad3efc560d6e217fe0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ijv2jcAFTiRhwig4dtf4oQ.jpeg"/></div></div><p class="jj jk et er es jl jm bd b be z dx translated">自己在<a class="ae jn" href="https://www.instagram.com/keith00751/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/keith00751/</a>的照片</p></figure><h2 id="a545" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">需求背景</strong></h2><p id="5a47" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">项目中的快速集成配置中心Nacos服务注册发现功能</p><p id="7790" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated"><strong class="ko hj">提示技术要点</strong></p><ol class=""><li id="d233" class="lk ll hi ko b kp lf ks lg jz lm kd ln kh lo le lp lq lr ls bi translated"><a class="ae jn" href="https://www.java67.com/2018/12/top-5-spring-cloud-annotations-for-java.html" rel="noopener ugc nofollow" target="_blank"> @EnableDiscoveryClient注释</a></li></ol><ul class=""><li id="4b4c" class="lk ll hi ko b kp lf ks lg jz lm kd ln kh lo le lt lq lr ls bi translated">启用Nacos服务注册发现功能</li></ul><p id="a4fc" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">2.区分不同环境，实现服务注册发现功能</p><ul class=""><li id="0e5c" class="lk ll hi ko b kp lf ks lg jz lm kd ln kh lo le lt lq lr ls bi translated">登录Nacos控制台，添加三个不同的环境，dev / test / prod，对应:开发环境/测试环境/生产环境</li><li id="80e8" class="lk ll hi ko b kp lu ks lv jz lw kd lx kh ly le lt lq lr ls bi translated">不熟悉控制台，看教程:</li></ul><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/javarevisited/spring-cloud-alibabas-tutorial-from-getting-started-to-a-master-1-introduction-to-nacos-954598300a01"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hj fi z dy mh ea eb mi ed ef hh bi translated">春云阿里巴巴从入门到精通教程(一)Nacos入门</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">Configuration Center服务器启动安装中的Nacos快速入门介绍</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq jh mc"/></div></div></a></div><figure class="iy iz ja jb fd jc er es paragraph-image"><a href="https://www.java67.com/2021/01/spring-cloud-interview-questions-with-answers-java.html"><div class="er es mr"><img src="../Images/82c1d1dfe3961141f55d01f7c0d3bd0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I6UfeZ04PZM4irjo"/></div></a></figure><h2 id="db73" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">代码演示</h2><ol class=""><li id="6f20" class="lk ll hi ko b kp kq ks kt jz ms kd mt kh mu le lp lq lr ls bi translated">项目目录结构</li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/05/top-20-spring-boot-interview-questions-answers.html"><div class="er es mv"><img src="../Images/40f83ab62720de6d22eb508beefe12de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/0*JN8JIvpnUSZ-9p7z"/></div></a></figure><p id="188e" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">2.pom.xml相关组件</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="562e" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">3.bootstrap.yaml配置文件</p><p id="0939" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">这里的名称空间值是:对应于dev环境的名称空间id值</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="0d23" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">4.启动类</p><p id="c887" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">添加<a class="ae jn" href="http://twitter.com/EnableDiscoveryClien" rel="noopener ugc nofollow" target="_blank"> @EnableDiscoveryClien </a> t注释</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="19ad" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">5.服务注册是否成功</p><p id="e65f" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">启动项目后，可以在dev名称空间中发现这个服务，这意味着服务注册发现功能生效。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><a href="https://www.java67.com/2018/06/top-15-spring-boot-interview-questions-answers-java-jee-programmers.html"><div class="er es mr"><img src="../Images/9e4b75fc83ca7bfd1535bc3c5c491f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0bAPOVEQaH2bGrWr"/></div></a></figure><p id="8624" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">您可以点击“详细信息”查看更多信息。它还可以执行“离线”操作功能等。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><a href="https://www.java67.com/2021/02/microservices-interview-questions-answers-java-spring.html"><div class="er es mr"><img src="../Images/5c97dcfaac5b638754aff2a47fc4f009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iVZshtA9kUVibK3Z"/></div></a></figure><h2 id="5edc" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">区分不同的环境</h2><ol class=""><li id="24ac" class="lk ll hi ko b kp kq ks kt jz ms kd mt kh mu le lp lq lr ls bi translated">使用配置文件:bootstrap.yaml.bak</li></ol><p id="c6c6" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">将上面的bootstrap.yaml重命名为bootstrap.yaml2，将bootstrap.yaml.bak重命名为bootstrap.yaml</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mw mx l"/></div></figure><p id="a0de" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">2.通过配置文件激活不同的环境配置</p><p id="201a" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">如果您使用:test，您可以看到服务已经在这个名称空间下注册，并且在dev下消失了</p><figure class="iy iz ja jb fd jc er es paragraph-image"><a href="https://javarevisited.blogspot.com/2022/03/spring-boot-redis-example-in-java.html"><div class="er es mr"><img src="../Images/02ccf2f47ec3609d1e637d3c143232e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Go15skZf-8j4HlU8"/></div></a></figure><p id="6390" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">3.启动服务包的脚本</p><p id="35a4" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">不同的环境使用不同的配置，并通过指定启动参数来使用不同的配置文件，例如:</p><ul class=""><li id="9368" class="lk ll hi ko b kp lf ks lg jz lm kd ln kh lo le lt lq lr ls bi translated">开发环境:Java-jar XXX . jar—spring . profiles . active = dev</li><li id="f19c" class="lk ll hi ko b kp lu ks lv jz lw kd lx kh ly le lt lq lr ls bi translated">生产环境:Java-jar XXX . jar—spring . profiles . active = prod</li></ul><p id="78e7" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">您可以转到该项目的根目录并执行:</p><pre class="iy iz ja jb fd my mz na nb aw nc bi"><span id="851a" class="jo jp hi mz b fi nd ne l nf ng">java -jar target/microservice-alibaba-nacos-discovery.jar --spring.profiles.active=test</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><a href="https://javarevisited.blogspot.com/2022/01/spring-boot-reactjs-example-for-java.html"><div class="er es mr"><img src="../Images/87d7d98222dd9e0b4e9f90b208047f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ROoQiwTUaXsL3rpO"/></div></a></figure><p id="ced7" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">可以看到profiles.active=test配置已经生效，还可以看到这个服务已经在test名称空间下成功注册了</p><p id="ca32" class="pw-post-body-paragraph km kn hi ko b kp lf ij kr ks lg im ku jz lh kw kx kd li kz la kh lj lc ld le hb bi translated">注意:这些值也可以通过<a class="ae jn" href="https://javarevisited.blogspot.com/2012/08/how-to-get-environment-variables-in.html" rel="noopener ugc nofollow" target="_blank">环境变量</a>导入，比如server-addr值、名称空间值等。</p><div class="lz ma ez fb mb mc"><a href="https://javarevisited.blogspot.com/2022/04/how-to-use-environment-variables-in.html" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hj fi z dy mh ea eb mi ed ef hh bi translated">如何在Spring Boot的application.properties文件中使用环境变量？示例教程</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">如何在Spring boot的application.properties中使用环境变量是一个主要问题</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">javarevisited.blogspot.com</p></div></div><div class="ml l"><div class="nh l mn mo mp ml mq jh mc"/></div></div></a></div></div></div>    
</body>
</html>