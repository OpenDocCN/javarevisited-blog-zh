<html>
<head>
<title>Writing a Unit Test using Spring Boot (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Spring Boot 编写单元测试(第 2 部分)</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/writing-a-unit-test-using-spring-boot-part-2-b16847484cb9?source=collection_archive---------0-----------------------#2019-06-16">https://medium.com/javarevisited/writing-a-unit-test-using-spring-boot-part-2-b16847484cb9?source=collection_archive---------0-----------------------#2019-06-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="429d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我描述了“<a class="ae jd" rel="noopener" href="/@yigitcannalci/building-a-rest-service-with-spring-boot-and-mongodb-3aa5cd2dce73?source=friends_link&amp;sk=582face6df6e23be283b543ae804552e"> <em class="je">如何使用 Spring Boot 和 MongoDB </em> </a>开发 REST 服务”之后，我决定解释一下<em class="je">如何使用 Spring Boot </em>编写单元测试。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/830552352f46b45c7ec447ba70c97c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wLiOxLHD-M4IQCH-lYCW7w.jpeg"/></div></div><p class="jr js et er es jt ju bd b be z dx translated">乌德米</p></figure><p id="4c46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，单元测试是在前面的故事中开发的项目<a class="ae jd" rel="noopener" href="/@yigitcannalci/building-a-rest-service-with-spring-boot-and-mongodb-3aa5cd2dce73?source=friends_link&amp;sk=582face6df6e23be283b543ae804552e">中编写的，所以前面的项目中使用的技术和设置是相同的。</a></p><p id="6bad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以从这个<a class="ae jd" href="https://github.com/ragcrix/StudentInformationSystem" rel="noopener ugc nofollow" target="_blank"> GitHub </a>链接下载项目源代码。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es jv"><img src="../Images/4e6828ac44eb9dd9c8c7de6f9d212114.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*MR-bbhz8fQD5Na-GBGm9lA.png"/></div><p class="jr js et er es jt ju bd b be z dx translated">开源代码库</p></figure><p id="536e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Spring Boot 用<code class="du jw jx jy jz b">SpringRunner</code>简化单元测试。用<code class="du jw jx jy jz b">MockMVC</code>为 REST 控制器编写单元测试也更容易。为了编写一个单元测试，Spring Boot 启动测试依赖项应该被添加到您的构建配置文件中(对于我们的项目，<strong class="ih hj"> pom.xml </strong>)。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="c19f" class="ke kf hi jz b fi kg kh l ki kj">&lt;dependency&gt;<br/>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;<br/>    &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;</span></pre><p id="e4fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样做之后，我们就可以编写我们的第一个单元测试了。</p><h1 id="b274" class="kk kf hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">StudentService.java 的测试</h1><p id="5680" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">在这一节中，我们将为图中所示的<strong class="ih hj">StudentService.java</strong>实现一个单元测试。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="996a" class="ke kf hi jz b fi kg kh l ki kj">@Service<br/>public class StudentServiceImpl implements StudentService {<br/><br/>    @Autowired<br/>    private StudentRepository studentRepository;<br/><br/>    @Override<br/>    public List&lt;Student&gt; findAll() {<br/>        return studentRepository.findAll();<br/>    }<br/><br/>    @Override<br/>    public Student findByStudentNumber(long studentNumber) {<br/>        return studentRepository.findByStudentNumber(studentNumber);<br/>    }<br/><br/>    @Override<br/>    public Student findByEmail(String email) {<br/>        return studentRepository.findByEmail(email);<br/>    }<br/><br/>    @Override<br/>    public List&lt;Student&gt; findAllByOrderByGpaDesc() {<br/>        return studentRepository.findAllByOrderByGpaDesc();<br/>    }<br/><br/>    @Override<br/>    public Student saveOrUpdateStudent(Student student) {<br/>        return studentRepository.save(student);<br/>    }<br/><br/>    @Override<br/>    public void deleteStudentById(String id) {<br/>        studentRepository.deleteById(id);<br/>    }<br/>}</span></pre><p id="ba8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要在类上面写<code class="du jw jx jy jz b">@RunWith(SpringRunner.class)</code>注释。这个注释使用<code class="du jw jx jy jz b">SpringJUnit4ClassRunner</code>来运行单元测试。</p><p id="585b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二，<code class="du jw jx jy jz b">@SpringBootTest</code>注释补充。这个注释为测试类提供了许多特性。更多信息请点击<a class="ae jd" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/test/context/SpringBootTest.html" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="0070" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，添加要测试的类(<strong class="ih hj">StudentService.java</strong>)及其依赖项，如下所示。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="b62b" class="ke kf hi jz b fi kg kh l ki kj">@RunWith(SpringRunner.class)<br/>@SpringBootTest<br/>public class StudentServiceTest {<br/><br/>   @Autowired<br/>    private StudentService studentService;<br/><br/>    @MockBean<br/>    private StudentRepository studentRepository;</span><span id="3741" class="ke kf hi jz b fi lm kh l ki kj">    ...</span><span id="0a5e" class="ke kf hi jz b fi lm kh l ki kj">}</span></pre><p id="c74a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以编写模拟对象来测试 StudentService.java 了。Ragcrix 和 yigit 被创建。以下值被分配给对象。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="1aee" class="ke kf hi jz b fi kg kh l ki kj">private Student ragcrix;<br/>private Student yigit;<br/><br/>private final Long ragcrixStudentNumber = 23L;<br/>private final Long yigitStudentNumber = 91L;<br/>private final String ragcrixEmail = "ragcrix@rg.com";<br/>private final String yigitEmail = "yigit@ygt.com";<br/>private final List&lt;Student&gt; students = new ArrayList&lt;&gt;();<br/><br/>@Before<br/>public void setup() {<br/>    ragcrix = new Student();<br/>    ragcrix.setId("aBc123");<br/>    ragcrix.setName("ragcrix");<br/>    ragcrix.setEmail(ragcrixEmail);<br/>    ragcrix.setStudentNumber(ragcrixStudentNumber);<br/>    ragcrix.setCourseList(Arrays.<em class="je">asList</em>("Math", "Science"));<br/>    ragcrix.setGpa(3.37f);<br/><br/>    yigit = new Student();<br/>    yigit.setId("dEf345");<br/>    yigit.setName("yigit");<br/>    yigit.setEmail(yigitEmail);<br/>    yigit.setStudentNumber(yigitStudentNumber);<br/>    yigit.setCourseList(Arrays.<em class="je">asList</em>("Turkish", "German"));<br/>    yigit.setGpa(3.58f);<br/><br/>    students.add(ragcrix);<br/>    students.add(yigit);</span></pre><p id="5b77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于学生服务中的<code class="du jw jx jy jz b">findAll()</code>方法，我们需要模仿<strong class="ih hj">StudentRepository.java</strong>中的<code class="du jw jx jy jz b">findAll()</code>方法。<strong class="ih hj"> </strong>之后，我们准备写测试方法。为此，编写了<code class="du jw jx jy jz b">testFindAll_thenStudentListShouldBeReturned()</code>方法。这个方法只是检查返回数据的大小。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="6fd9" class="ke kf hi jz b fi kg kh l ki kj">...</span><span id="28ad" class="ke kf hi jz b fi lm kh l ki kj">Mockito.<em class="je">when</em>(studentRepository.findAll()).thenReturn(students);</span><span id="e528" class="ke kf hi jz b fi lm kh l ki kj">...</span><span id="a0d2" class="ke kf hi jz b fi lm kh l ki kj">@Test<br/>public void testFindAll_thenStudentListShouldBeReturned() {<br/>    List&lt;Student&gt; foundStudents = studentService.findAll();<br/><br/>    <em class="je">assertNotNull</em>(foundStudents);<br/>    <em class="je">assertEquals</em>(2, foundStudents.size());<br/>}</span></pre><p id="4ad2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于学生服务中的<code class="du jw jx jy jz b">findByStudentNumber()</code>方法，我们需要模仿<strong class="ih hj">StudentRepository.java</strong>中的<code class="du jw jx jy jz b">findByStudentNumber()</code>方法。<strong class="ih hj"> </strong>之后，我们准备写测试方法。对于这一点，<code class="du jw jx jy jz b">testFindByStudentNumber23_thenRagcrixShouldBeReturned()</code>法是这样写的。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="c46a" class="ke kf hi jz b fi kg kh l ki kj">...</span><span id="7181" class="ke kf hi jz b fi lm kh l ki kj">Mockito.<em class="je">when</em>(studentRepository.findByStudentNumber<br/>(ragcrixStudentNumber)).thenReturn(ragcrix);</span><span id="118e" class="ke kf hi jz b fi lm kh l ki kj">...</span><span id="e22a" class="ke kf hi jz b fi lm kh l ki kj">@Test<br/>public void testFindByStudentNumber23_thenRagcrixShouldBeReturned() {<br/>    Student found = studentService.findByStudentNumber(ragcrixStudentNumber);<br/><br/>    <em class="je">assertNotNull</em>(found);<br/>    <em class="je">assertEquals</em>(ragcrix.getName(), found.getName());<br/>    <em class="je">assertEquals</em>(ragcrix.getId(), found.getId());<br/>}</span></pre><p id="7ad2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于学生服务中的<code class="du jw jx jy jz b">findByEmail()</code>、<code class="du jw jx jy jz b">findAllByOrderByGpaDesc()</code>、<code class="du jw jx jy jz b">saveOrUpdateStudent()</code>、<code class="du jw jx jy jz b">deleteStudentById()</code>方法，<strong class="ih hj">、</strong>中的相关方法同样被模仿。然后，StudentService 的测试方法编写如下。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="4a8a" class="ke kf hi jz b fi kg kh l ki kj"><br/>...</span><span id="3d50" class="ke kf hi jz b fi lm kh l ki kj">Mockito.<em class="je">when</em>(studentRepository.findByEmail(yigitEmail))<br/>        .thenReturn(yigit);<br/><br/>Mockito.<em class="je">when</em>(studentRepository.findAllByOrderByGpaDesc())<br/>        .thenReturn(students.stream().sorted(<br/>                Comparator.<em class="je">comparing</em>(Student::getGpa).reversed()).collect(Collectors.<em class="je">toList</em>()));<br/><br/>Mockito.<em class="je">when</em>(studentRepository.save(ragcrix)).thenReturn(ragcrix);</span><span id="c5bb" class="ke kf hi jz b fi lm kh l ki kj">...</span><span id="d351" class="ke kf hi jz b fi lm kh l ki kj">@Test<br/>public void testFindByEmail_thenYigitShouldBeReturned() {<br/>    Student found = studentService.findByEmail(yigitEmail);<br/><br/>    <em class="je">assertNotNull</em>(found);<br/>    <em class="je">assertEquals</em>(yigit.getName(), found.getName());<br/>    <em class="je">assertEquals</em>(yigit.getId(), found.getId());<br/>}<br/><br/>@Test<br/>public void testFindAllByOrderByGpaDesc_thenStudentsShouldBeReturned_byGPADesc() {<br/>    List&lt;Student&gt; foundStudents = studentService.findAllByOrderByGpaDesc();<br/><br/>    <em class="je">assertNotNull</em>(foundStudents);<br/>    <em class="je">assertEquals</em>(2, foundStudents.size());<br/>    <em class="je">assertEquals</em>(yigit.getName(), foundStudents.get(0).getName());<br/>    <em class="je">assertEquals</em>(yigit.getId(), foundStudents.get(0).getId());<br/>}<br/><br/>@Test<br/>public void testSaveOrUpdateStudent_thenStudentShouldBeReturned() {<br/>    Student found = studentService.saveOrUpdateStudent(ragcrix);<br/><br/>    <em class="je">assertNotNull</em>(found);<br/>    <em class="je">assertEquals</em>(ragcrix.getName(), found.getName());<br/>    <em class="je">assertEquals</em>(ragcrix.getId(), found.getId());<br/>}<br/><br/>@Test<br/>public void testDeleteStudentById() {<br/>    studentService.deleteStudentById(ragcrix.getId());<br/><br/>    Mockito.<em class="je">verify</em>(studentRepository, Mockito.<em class="je">times</em>(1))<br/>            .deleteById(ragcrix.getId());<br/>}</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ln"><img src="../Images/2c3115695f464fe28e73546fb645cf64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ofjWtX0YDfyDdfcmN2boOw.png"/></div></div><p class="jr js et er es jt ju bd b be z dx translated">StudentServiceTest.java 的测试结果</p></figure><h1 id="5b2a" class="kk kf hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">StudentRestController.java 测试</h1><p id="ea56" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">Spring Boot 提供了一种为 Rest 控制器编写单元测试的简单方法。在<strong class="ih hj">spring JUnit 4 class runner</strong>和<strong class="ih hj"> MockMVC </strong>的帮助下，可以创建一个 web 应用上下文来为 Rest 控制器编写单元测试。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lo"><img src="../Images/657fe5df80b50c6f2bc128060e9e67ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*s1Cho4SgMxrN7rRaIBCYng.jpeg"/></div></div><p class="jr js et er es jt ju bd b be z dx translated"><a class="ae jd" href="https://codeflex.co" rel="noopener ugc nofollow" target="_blank"> codeflex </a></p></figure><p id="4033" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，像前面的测试一样，我们向测试类添加必要的注释。<code class="du jw jx jy jz b">MockMvc</code>是一类 Spring Boot 测试工具，允许你测试控制器，而不必启动 HTTP 服务器。用<code class="du jw jx jy jz b">@WebMvcTest</code>测试网络控制器更容易。<a class="ae jd" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/test/autoconfigure/web/servlet/WebMvcTest.html" rel="noopener ugc nofollow" target="_blank">点击</a>了解详情。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="d96f" class="ke kf hi jz b fi kg kh l ki kj">@RunWith(SpringRunner.class)<br/>@WebMvcTest<br/>public class StudentRestControllerTest {<br/><br/>    @Autowired<br/>    private MockMvc mvc;<br/><br/>    @MockBean<br/>    private StudentService studentService;<br/><br/>    private ObjectMapper objectMapper = new ObjectMapper();</span></pre><p id="3db0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在为 web 控制器测试安排好配置之后，我们可以向这个类添加模拟对象，如下所示。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="25ca" class="ke kf hi jz b fi kg kh l ki kj">private Student ragcrix;<br/>private Student yigit;<br/><br/>private final Long ragcrixStudentNumber = 23L;<br/>private final Long yigitStudentNumber = 91L;<br/><br/>@Before<br/>public void setup() {<br/>    ragcrix = new Student();<br/>    ragcrix.setId("aBc123");<br/>    ragcrix.setName("ragcrix");<br/>    ragcrix.setEmail("ragcrix@rg.com");<br/>    ragcrix.setStudentNumber(ragcrixStudentNumber);<br/>    ragcrix.setCourseList(Arrays.<em class="je">asList</em>("Math", "Science"));<br/>    ragcrix.setGpa(3.37f);<br/><br/>    yigit = new Student();<br/>    yigit.setId("dEf345");<br/>    yigit.setName("yigit");<br/>    yigit.setEmail("yigit@ygt.com");<br/>    yigit.setStudentNumber(yigitStudentNumber);<br/>    yigit.setCourseList(Arrays.<em class="je">asList</em>("Turkish", "German"));<br/>    yigit.setGpa(3.58f);<br/>}</span></pre><p id="1eee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们准备编写第一个测试方法。对于<strong class="ih hj">StudentRestController.java</strong>中的<code class="du jw jx jy jz b">getAllStudents()</code>，编写如下方法。<code class="du jw jx jy jz b">mvc.perform()</code>方法用于测试终点。你可以用下面的方法比较预期和实际的数据。</p><p id="17e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个测试方法中，当调用<code class="du jw jx jy jz b">studentService.findAll()</code>时，将返回一个学生列表。之后，用<code class="du jw jx jy jz b">mvc.perform()</code>对控制器中的<code class="du jw jx jy jz b">getAllStudents()</code>进行测试。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="1a93" class="ke kf hi jz b fi kg kh l ki kj">@Test<br/>public void givenStudents_whenGetAllStudents_thenReturnJsonArray() throws Exception {<br/>    <em class="je">given</em>(studentService.findAll()).willReturn(Arrays.<em class="je">asList</em>(ragcrix));<br/><br/>    mvc.perform(<em class="je">get</em>("/students/")<br/>            .contentType(MediaType.<em class="je">APPLICATION_JSON</em>))<br/>            .andExpect(<em class="je">status</em>().isOk())<br/>            .andExpect(<em class="je">jsonPath</em>("$", <em class="je">hasSize</em>(1)))<br/>            .andExpect(<em class="je">jsonPath</em>("$[0].name", <em class="je">is</em>(ragcrix.getName())));<br/>}</span></pre><p id="848d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如下所示，其他<strong class="ih hj"> GET </strong>方法的测试就像<code class="du jw jx jy jz b">givenStudents_whenGetAllStudents_thenReturnJsonArray()</code>方法一样编写。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="f7b9" class="ke kf hi jz b fi kg kh l ki kj">@Test<br/>public void givenStudent_whenFindByStudentNumber_thenReturnJsonArray() throws Exception {<br/>    <em class="je">given</em>(studentService.findByStudentNumber(ragcrixStudentNumber)).willReturn(ragcrix);<br/><br/>    mvc.perform(<em class="je">get</em>("/students/byStudentNumber/{studentNumber}", ragcrixStudentNumber)<br/>            .contentType(MediaType.<em class="je">APPLICATION_JSON</em>))<br/>            .andExpect(<em class="je">status</em>().isOk())<br/>            .andExpect(<em class="je">jsonPath</em>("$.name", <em class="je">is</em>(ragcrix.getName())));<br/>}<br/><br/>@Test<br/>public void givenStudent_whenFindAllByOrderByGpaDesc_thenReturnJsonArray() throws Exception {<br/>    <em class="je">given</em>(studentService.findAllByOrderByGpaDesc()).willReturn(Arrays.<em class="je">asList</em>(yigit, ragcrix));<br/><br/>    mvc.perform(<em class="je">get</em>("/students/orderByGpa/")<br/>            .contentType(MediaType.<em class="je">APPLICATION_JSON</em>))<br/>            .andExpect(<em class="je">status</em>().isOk())<br/>            .andExpect(<em class="je">jsonPath</em>("$", <em class="je">hasSize</em>(2)))<br/>            .andExpect(<em class="je">jsonPath</em>("$[0].name", <em class="je">is</em>(yigit.getName())));<br/>}</span></pre><p id="3306" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GET 方法的测试完成后，我们就可以编写 POST 方法测试了。对于控制器中的<code class="du jw jx jy jz b">saveStudent()</code>方法，编写<code class="du jw jx jy jz b">saveStudent_itShouldReturnStatusOk()</code>方法。在这种方法中，<code class="du jw jx jy jz b">studentService.saveOrUpdateStudent()</code>法首先被嘲弄。要保存的<strong class="ih hj">学生</strong> <strong class="ih hj">对象</strong> ( <code class="du jw jx jy jz b">yigit</code>)通过<code class="du jw jx jy jz b">objectMapper</code>转换为<code class="du jw jx jy jz b">jsonString</code>。之后，使用<code class="du jw jx jy jz b">mvc.perform()</code>方法测试<code class="du jw jx jy jz b">/save</code>终点。</p><p id="5255" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与编写的其他 GET 方法一样，您也可以测试<code class="du jw jx jy jz b">/save</code>端点的返回值。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="b433" class="ke kf hi jz b fi kg kh l ki kj">@Test<br/>public void saveStudent_itShouldReturnStatusOk() throws Exception {<br/>    <em class="je">given</em>(studentService.saveOrUpdateStudent(<em class="je">any</em>(Student.class))).willReturn(yigit);<br/><br/>    String jsonString = objectMapper.writeValueAsString(yigit);<br/><br/>    mvc.perform(<em class="je">post</em>("/students/save/")<br/>            .contentType(MediaType.<em class="je">APPLICATION_JSON</em>).content(jsonString))<br/>            .andExpect(<em class="je">status</em>().isOk());<br/>}</span></pre><p id="e111" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在<strong class="ih hj">StudenRestController.java</strong>的最后一个方法是<code class="du jw jx jy jz b">deleteStudentByStudentNumber()</code>。对于这个方法，写的是<code class="du jw jx jy jz b">deleteStudentByStudentNumber_itShouldReturnStatusOk()</code>。首先，<strong class="ih hj">StudentService.java</strong>中的相关方法像其他测试方法一样被嘲讽。之后用<code class="du jw jx jy jz b">mvc.perform()</code>测试<code class="du jw jx jy jz b">/delete/{studentNumber}</code>终点。</p><pre class="jg jh ji jj fd ka jz kb kc aw kd bi"><span id="5a65" class="ke kf hi jz b fi kg kh l ki kj">@Test<br/>public void deleteStudentByStudentNumber_itShouldReturnStatusOk() throws Exception {<br/>    <em class="je">given</em>(studentService.findByStudentNumber(ragcrixStudentNumber)).willReturn(ragcrix);<br/>    Mockito.<em class="je">doNothing</em>().when(studentService).deleteStudentById(<em class="je">any</em>(String.class));<br/><br/>    mvc.perform(<em class="je">delete</em>("/students/delete/{studentNumber}", ragcrixStudentNumber)<br/>            .contentType(MediaType.<em class="je">APPLICATION_JSON</em>))<br/>            .andExpect(<em class="je">status</em>().isOk());<br/>}</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lp"><img src="../Images/c60053d8e335452e9ffbcdd44d9de0b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LWfToaxYgl9ah79YoA8Mg.png"/></div></div><p class="jr js et er es jt ju bd b be z dx translated">StudentRestControllerTest.java 的测试结果</p></figure></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="eb99" class="kk kf hi bd kl km lx ko kp kq ly ks kt ku lz kw kx ky ma la lb lc mb le lf lg bi translated">感谢您的阅读！🙏你的想法对我很有价值。请随意分享。😄</h1></div></div>    
</body>
</html>