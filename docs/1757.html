<html>
<head>
<title>GCP Certification — let’s sail together. Ensure Access &amp; Identity in Google Cloud : Challenge Lab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GCP认证——让我们一起航行。确保Google Cloud中的访问和身份:挑战实验室</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/gcp-certification-lets-sail-together-ensure-access-identity-in-google-cloud-challenge-lab-786eab033c7f?source=collection_archive---------3-----------------------#2021-11-22">https://medium.com/javarevisited/gcp-certification-lets-sail-together-ensure-access-identity-in-google-cloud-challenge-lab-786eab033c7f?source=collection_archive---------3-----------------------#2021-11-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2019/07/top-5-google-cloud-platform-gcp-courses-certifications-online.html"><div class="er es if"><img src="../Images/31ad43c36e9393260f01f8a73829b451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*59pKXZz4VVMf4b0hvCqw7g.png"/></div></a></figure><h1 id="eb43" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">让我们去确保谷歌云的访问和身份:挑战实验室</h1><p id="bb4f" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">根据在此任务中完成的差异实验，在此挑战实验中，您应该</p><ol class=""><li id="fae8" class="ki kj hi jm b jn kk jr kl jv km jz kn kd ko kh kp kq kr ks bi translated">创建自定义安全角色</li><li id="966d" class="ki kj hi jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">创建服务帐户</li><li id="4b64" class="ki kj hi jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">根据所需的最低权限将IAM安全角色绑定到服务帐户</li><li id="2d18" class="ki kj hi jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">在现有的自定义子网中创建私有Kubernetes集群</li><li id="0065" class="ki kj hi jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">最后，将应用程序部署到私有的Kubernetes集群。</li></ol><p id="2484" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated">让我们开始行动吧。</p><p id="b171" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">确保在cli命令中替换5个以下变量</strong></p><ol class=""><li id="9fb1" class="ki kj hi jm b jn kk jr kl jv km jz kn kd ko kh kp kq kr ks bi translated">项目标识:qwiklabs-gcp-02-de90f326eb51</li><li id="e97f" class="ki kj hi jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">自定义安全角色:orca_storage_manager_855</li><li id="567e" class="ki kj hi jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">服务帐户:orca-private-cluster-662-sa</li><li id="20df" class="ki kj hi jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">集群名称:orca-cluster-985</li><li id="4b93" class="ki kj hi jm b jn kt jr ku jv kv jz kw kd kx kh kp kq kr ks bi translated">orca-jump主机IP : 192.168.10.2</li></ol><p id="a169" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">让我们从基本步骤开始</strong> <br/> gcloud授权列表<br/> gcloud配置列表项目<br/> gcloud配置集计算/区域us-east1-b</p><p id="4d22" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">请注意:- </strong> <br/> 1。您可以提前获取虚拟机IP，因为已经使用以下命令创建了跳转主机虚拟机实例:—</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="b368" class="lk in hi lg b fi ll lm l ln lo">gcloud compute instances describe orca-jumphost --format='get(networkInterfaces[0].networkIP)'</span></pre><p id="84da" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated">2.您可以提前从VPC“orca-build-VPC”和子网“orca-build-subnet”获得区域详细信息，以便您可以在同一区域创建Kubernetes集群。</p><p id="932e" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">让我们深潜进去————</strong></p><p id="463c" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">步骤1:创建自定义安全角色</strong></p><p id="846e" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated">选项1:使用标志</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="c926" class="lk in hi lg b fi ll lm l ln lo">gcloud iam roles create orca_storage_manager_855 --project $DEVSHELL_PROJECT_ID --title "orca_storage_manager_855" --description "Custom role description." --permissions storage.buckets.get,storage.objects.get,storage.objects.list,storage.objects.update,storage.objects.create --stage ALPHA</span></pre><p id="3bb1" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated">方案二:使用Yaml<br/>nano custom-role-definition . Yaml<br/>title:" orca _ storage _ manager _ 855<br/>描述:" Permissions "<br/>stage:" ALPHA "<br/>included Permissions:<br/>—storage . buckets . get<br/>—storage . objects . get<br/>—storage . objects . list<br/>—storage . objects . update<br/>—storage . objects . create</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="2df2" class="lk in hi lg b fi ll lm l ln lo">gcloud iam roles create orca_storage_manager_855 --project $DEVSHELL_PROJECT_ID --file custom-role-definition.yaml</span></pre><p id="8ccd" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">第二步:创建服务帐户</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="8b22" class="lk in hi lg b fi ll lm l ln lo">gcloud iam service-accounts create orca-private-cluster-662-sa --display-name "orca-private-cluster-662-sa"</span></pre><p id="c773" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">步骤3:将IAM安全角色绑定到服务帐户。</strong> <br/>角色/monitoring.viewer <br/>角色/monitoring.metricWriter <br/>角色/logging.logWriter</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="d940" class="lk in hi lg b fi ll lm l ln lo">gcloud projects add-iam-policy-binding $DEVSHELL_PROJECT_ID --member serviceAccount:<a class="ae lp" href="mailto:orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com" rel="noopener ugc nofollow" target="_blank">orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com</a> --role roles/monitoring.viewer</span><span id="da79" class="lk in hi lg b fi lq lm l ln lo">gcloud projects add-iam-policy-binding $DEVSHELL_PROJECT_ID --member serviceAccount:<a class="ae lp" href="mailto:orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com" rel="noopener ugc nofollow" target="_blank">orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com</a> --role roles/monitoring.metricWriter</span><span id="a565" class="lk in hi lg b fi lq lm l ln lo">gcloud projects add-iam-policy-binding $DEVSHELL_PROJECT_ID --member serviceAccount:<a class="ae lp" href="mailto:orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com" rel="noopener ugc nofollow" target="_blank">orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com</a> --role roles/logging.logWriter</span><span id="e90b" class="lk in hi lg b fi lq lm l ln lo">gcloud projects add-iam-policy-binding $DEVSHELL_PROJECT_ID --member serviceAccount:<a class="ae lp" href="mailto:orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com" rel="noopener ugc nofollow" target="_blank">orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com</a> --role projects/qwiklabs-gcp-02-de90f326eb51/roles/orca_storage_manager_855</span></pre><p id="bb45" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">步骤4:在自定义子网中创建私有Kubernetes引擎集群</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="781c" class="lk in hi lg b fi ll lm l ln lo">gcloud beta container clusters create orca-cluster-985 --master-ipv4-cidr=10.142.0.0/28 --network=orca-build-vpc --subnetwork orca-build-subnet --enable-master-authorized-networks --master-authorized-networks 192.168.10.2/32 --enable-ip-alias --enable-private-nodes --enable-private-endpoint --<a class="ae lp" href="mailto:service-account=orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com" rel="noopener ugc nofollow" target="_blank">service-account=orca-private-cluster-662-sa@qwiklabs-gcp-02-de90f326eb51.iam.gserviceaccount.com</a> --zone us-east1-b</span></pre><p id="e40a" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated"><strong class="jm hj">步骤5:将应用部署到私有的Kubernetes引擎集群</strong></p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="6096" class="lk in hi lg b fi ll lm l ln lo">gcloud compute ssh orca-jumphost --zone us-east1-b</span><span id="0ace" class="lk in hi lg b fi lq lm l ln lo">gcloud container clusters get-credentials orca-cluster-985 --internal-ip --zone us-east1-b --project qwiklabs-gcp-02-de90f326eb51</span><span id="d386" class="lk in hi lg b fi lq lm l ln lo">kubectl create deployment hello-server --image=gcr.io/google-samples/hello-app:1.0</span></pre><p id="78df" class="pw-post-body-paragraph jk jl hi jm b jn kk jp jq jr kl jt ju jv ky jx jy jz kz kb kc kd la kf kg kh hb bi translated">好样的…..让我们一起航行吧。</p></div></div>    
</body>
</html>