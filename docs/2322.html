<html>
<head>
<title>Reactive Programming (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应式编程(第二部分)</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/reactive-programming-part-2-43f73f43ee68?source=collection_archive---------0-----------------------#2022-08-13">https://medium.com/javarevisited/reactive-programming-part-2-43f73f43ee68?source=collection_archive---------0-----------------------#2022-08-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4150" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再次嗨，我希望一切都好！我对下面的照片感到高兴，我建议和我有同样感觉的人，深呼吸，看看照片😄。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/b39cfdce4966247b4357d66775d7a211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VonfIABi74zvC5FS"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@aaronburden?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Aaron Burden </a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="1c3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我之前所说，我这里有一个反应式编程的实际编码示例。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://javarevisited.blogspot.com/2021/04/best-reactive-spring-and-webflux-courses-for-java-developers.html"><div class="er es ju"><img src="../Images/64e2591687b3a0af9f7d7b446181e757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cisZxOoCoj8ScssoohGQCQ.jpeg"/></div></a><p class="jp jq et er es jr js bd b be z dx translated">图自<a class="ae jt" href="https://spring.io/reactive" rel="noopener ugc nofollow" target="_blank"> https://spring.io </a></p></figure><p id="e6b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我将讲解<em class="jv">“如何用</em><a class="ae jt" rel="noopener" href="/javarevisited/7-best-webflux-and-reactive-spring-boot-courses-for-java-programmers-33b7c6fa8995"><em class="jv">Spring web flux</em></a><em class="jv">和</em><a class="ae jt" rel="noopener" href="/javarevisited/10-free-online-courses-to-learn-mongodb-and-nosql-942609611664"><em class="jv">MongoDB</em></a><em class="jv">”</em>。</p><h1 id="4069" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">技术和工具</h1><p id="e81b" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">这里的教程使用<a class="ae jt" rel="noopener" href="/javarevisited/7-best-courses-to-learn-intellij-idea-for-beginners-and-experienced-java-programmers-2e9aa9bb0c05"> IntelliJ IDEA </a>、<a class="ae jt" rel="noopener" href="/javarevisited/6-best-maven-courses-for-beginners-in-2020-23ea3cba89"> Maven </a>和<a class="ae jt" rel="noopener" href="/javarevisited/7-best-courses-to-learn-postman-tool-for-web-service-and-api-testing-f225c138fa5a"> Postman </a>进行编码、构建和REST API测试。我在马科斯·蒙特雷跑步。</p><p id="f7a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有软件都是用Java写的，用的是Spring Boot 2.6.2。<a class="ae jt" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a> 4.2社区服务器用于持久化。</p><p id="f4a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这里开始，我假设你已经安装了JDK 17.0、IntelliJ、Maven、<a class="ae jt" rel="noopener" href="/javarevisited/10-free-online-courses-to-learn-mongodb-and-nosql-942609611664"> MongoDB </a>和<a class="ae jt" href="https://javarevisited.blogspot.com/2020/02/top-5-postman-tutorials-and-courses-for-web-developers.html" rel="noopener ugc nofollow" target="_blank"> Postman </a>。</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="db01" class="jw jx hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">反应邮件服务</h1><p id="7a6f" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">这个<a class="ae jt" rel="noopener" href="/javarevisited/10-best-java-microservices-courses-with-spring-boot-and-spring-cloud-6d04556bdfed">微服务</a>提供两个端点。首先，用于发送简单的电子邮件和带有附件的电子邮件。此外，该服务将电子邮件的数据保存到<a class="ae jt" href="https://javarevisited.blogspot.com/2019/01/top-5-mongodb-online-training-courses.html#axzz7E4Jl2a5D" rel="noopener ugc nofollow" target="_blank"> MongoDB数据库</a>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/d7ebb57f3b5b3b81334d619945d893c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A0LGqmOo_x3_mstF"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">Solen Feyissa 在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="387c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在这里的目标是展示如何使用这些技术以简单的方式开发REST服务，而不会打乱业务逻辑。</p><ul class=""><li id="dd5d" class="lm ln hi ih b ii ij im in iq lo iu lp iy lq jc lr ls lt lu bi translated">POST操作用于发送电子邮件。</li><li id="227b" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">另一个POST操作用于发送带有附件的电子邮件。</li><li id="c97b" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated">服务存储、接收和返回的所有内容都被格式化为<a class="ae jt" href="https://javarevisited.blogspot.com/2017/02/how-to-consume-json-from-restful-web-services-Spring-RESTTemplate-Example.html" rel="noopener ugc nofollow" target="_blank"> JSON </a>。</li></ul><h2 id="25fa" class="ma jx hi bd jy mb mc md kc me mf mg kg iq mh mi kk iu mj mk ko iy ml mm ks mn bi translated">邮件文档模型</h2><p id="a32b" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">这个模型有6个字段:id，from，to，cc，bcc，time和MailDocument用于将数据保存到数据库中。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mo mp l"/></div><p class="jp jq et er es jr js bd b be z dx translated">MailDocument.java</p></figure><h2 id="74e4" class="ma jx hi bd jy mb mc md kc me mf mg kg iq mh mi kk iu mj mk ko iy ml mm ks mn bi translated">邮件存储库</h2><p id="ecba" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">您可以使用<a class="ae jt" rel="noopener" href="/javarevisited/5-best-spring-data-jpa-courses-for-java-developers-45e6438be3c9"> Spring数据项目</a>轻松创建一个扩展<em class="jv"> ReactiveMongoRepository </em>的接口。有了这个，就不需要实现这个接口了。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mo mp l"/></div><p class="jp jq et er es jr js bd b be z dx translated">MailRepository.java</p></figure><p id="57f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<em class="jv">ReactiveMongoRepository</em>而不是<em class="jv"> MongoRepository </em>是很重要的，因为有了这个接口，我们提供了从表示到持久化的反应性。</p><h2 id="8952" class="ma jx hi bd jy mb mc md kc me mf mg kg iq mh mi kk iu mj mk ko iy ml mm ks mn bi translated">邮件服务</h2><p id="4772" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">邮件服务有两个公共方法和五个私有方法。简单地说，这些方法提供发送带附件或不带附件的电子邮件。在s <a class="ae jt" href="https://javarevisited.blogspot.com/2014/08/how-to-send-email-from-java-program-example.html" rel="noopener ugc nofollow" target="_blank">结束电子邮件</a>之后，电子邮件数据被保存到MongoDB数据库。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mo mp l"/></div><p class="jp jq et er es jr js bd b be z dx translated">MailService.java</p></figure><h2 id="9d45" class="ma jx hi bd jy mb mc md kc me mf mg kg iq mh mi kk iu mj mk ko iy ml mm ks mn bi translated">邮件控制器</h2><p id="2f93" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated"><em class="jv">MailController.java</em>是一个<a class="ae jt" href="https://javarevisited.blogspot.com/2017/08/difference-between-restcontroller-and-controller-annotations-spring-mvc-rest.html" rel="noopener ugc nofollow" target="_blank">静止控制器</a>，它有两个<code class="du mq mr ms mt b">@PostMapping</code>。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mo mp l"/></div><p class="jp jq et er es jr js bd b be z dx translated">MailController.java</p></figure></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h2 id="6ca7" class="ma jx hi bd jy mb mc md kc me mf mg kg iq mh mi kk iu mj mk ko iy ml mm ks mn bi translated">数据库配置</h2><p id="e1da" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">您需要启动MongoDB一次来连接数据库。如果你使用<a class="ae jt" href="https://brew.sh/#install" rel="noopener ugc nofollow" target="_blank"> brew </a>，你可以编写下面的命令。</p><pre class="je jf jg jh fd mu mt mv mw aw mx bi"><span id="b5ea" class="ma jx hi mt b fi my mz l na nb">brew services start mongodb-community@4.2</span></pre><p id="1b19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您在终端窗口上看到这条消息，那么您的方法是正确的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nc"><img src="../Images/87081f9e055cd8f3a635d7a3d90e8d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qurqHVBQjVBvXeffhA7-w.png"/></div></div></figure><p id="7513" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要连接到<a class="ae jt" rel="noopener" href="/javarevisited/5-best-nosql-database-programmers-and-developers-can-learn-42a0bdfa9a12"> MongoDB数据库</a>，编辑<em class="jv">“application . properties”</em>文件中的设置，该文件是<em class="jv">“resources”</em>的一部分。以下配置就足够了。</p><pre class="je jf jg jh fd mu mt mv mw aw mx bi"><span id="382a" class="ma jx hi mt b fi my mz l na nb">#mongodb<br/>spring.data.mongodb.host=localhost<br/>spring.data.mongodb.port=27017<br/>spring.data.mongodb.database=test</span></pre></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="5887" class="jw jx hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">使用Postman运行服务和测试</h1><p id="4bbd" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">您可以轻松地运行这个项目来测试REST端点。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/05/top-20-spring-boot-interview-questions-answers.html"><div class="er es nd"><img src="../Images/19ccc88c94eaa2ea8ab9d0423035c457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qazz01yQBtSjqM8053R2Bg.png"/></div></a><p class="jp jq et er es jr js bd b be z dx translated">在IntelliJ中运行项目</p></figure><p id="4df9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行项目后，可以测试<a class="ae jt" rel="noopener" href="/javarevisited/10-best-java-web-services-rest-soap-and-api-courses-for-beginners-724a8f51298d"> REST服务</a>。为此，打开Postman，输入网址，选择如下<strong class="ih hj"> POST </strong>方法。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://javarevisited.blogspot.com/2021/10/top-5-courses-to-learn-api-development.html"><div class="er es ne"><img src="../Images/3bddb85a47cd49ec795402f8a6ddd1b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jdMkUl0faCbHwShfjhhYAg.png"/></div></a><p class="jp jq et er es jr js bd b be z dx translated">发送电子邮件</p></figure><p id="fe88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过Postman中的<strong class="ih hj">邮政</strong>方法发送邮件到指定的电子邮件地址。首先要输入<strong class="ih hj"><em class="jv">Content-Type:application/JSON</em></strong>header键值对。第二，在body标签页中，你必须输入你想要以<a class="ae jt" href="https://javarevisited.blogspot.com/2022/03/3-examples-to-parse-json-in-java-using.html" rel="noopener ugc nofollow" target="_blank"> JSON格式</a>保存数据库的邮件信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://www.java67.com/2016/10/3-ways-to-convert-string-to-json-object-in-java.html"><div class="er es nf"><img src="../Images/89bbe5b79df951d184f32d663d498691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*moVp5SZNdqFmpmq1QdP4uA.png"/></div></a><p class="jp jq et er es jr js bd b be z dx translated">发送的电子邮件</p></figure><p id="3529" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对了，还可以通过提供准确的<a class="ae jt" href="https://www.java67.com/2019/09/3-ways-to-ignore-null-fields-in-json-java-jackson.html" rel="noopener ugc nofollow" target="_blank"> JSON对象</a>来测试其他<a class="ae jt" href="https://javarevisited.blogspot.com/2016/10/difference-between-put-and-post-in-restful-web-service.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> POST </strong>方法</a>。</p><p id="75b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注:</strong>本教程重点介绍Spring数据、Spring WebFlux、MongoDB和REST API的结合。项目中没有对对象字段的验证。</p><h1 id="b38a" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">资源</h1><ul class=""><li id="0965" class="lm ln hi ih b ii ku im kv iq ng iu nh iy ni jc lr ls lt lu bi translated"><a class="ae jt" href="https://reactivex.io/" rel="noopener ugc nofollow" target="_blank">https://reactivex.io/</a></li><li id="c5d9" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated"><a class="ae jt" href="https://www.reactivemanifesto.org/" rel="noopener ugc nofollow" target="_blank">https://www.reactivemanifesto.org/</a></li><li id="9d27" class="lm ln hi ih b ii lv im lw iq lx iu ly iy lz jc lr ls lt lu bi translated"><a class="ae jt" href="https://spring.io/" rel="noopener ugc nofollow" target="_blank">https://spring.io/</a></li></ul></div></div>    
</body>
</html>