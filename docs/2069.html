<html>
<head>
<title>Map vs. Bag</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">地图vs .包</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/map-vs-bag-f4120623a6e3?source=collection_archive---------1-----------------------#2022-04-21">https://medium.com/javarevisited/map-vs-bag-f4120623a6e3?source=collection_archive---------1-----------------------#2022-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="86cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Java中发现一种更好的计数方法。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/5da441fa9f744e571c6c600a554ef295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G4tFfBtnfSIiCAwR"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@crissyjarvis?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·贾维斯</a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="bbf5" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">用地图数算盘上的珠子</strong></h1><p id="cb1c" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">这里有一个使用<code class="du kx ky kz la b">Map</code>解决的简单问题。我们如何通过颜色来计算算盘上的珠子数量？首先，我将为<code class="du kx ky kz la b">Color</code>定义一个<code class="du kx ky kz la b">enum</code>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/96d37799970cd5039ce798e7412dbef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*eG8M8UE4BeaKAEs31b5ddg.png"/></div><p class="jp jq et er es jr js bd b be z dx translated">算盘上不同颜色珠子的枚举</p></figure><p id="7742" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我将创建一个<code class="du kx ky kz la b">HashMap&lt;Color, Integer&gt;</code>并使用<code class="du kx ky kz la b">merge</code>方法来增加和减少特定颜色的值。我会从计数中去掉一个彩色珠子(<code class="du kx ky kz la b">Color.RED</code>)。然后，我将断言使用<code class="du kx ky kz la b">Map.get</code>查询<code class="du kx ky kz la b">Map</code>的颜色计数的结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lc"><img src="../Images/4db1fff2f0b341c0c96880e28f1fc742.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kihSHBf4OuDRpk5m9nRLbA.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">用地图当算盘</p></figure><p id="7879" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用同样的<code class="du kx ky kz la b">merge</code>运算做加减法。我用负的<code class="du kx ky kz la b">Integer</code>值来减去。我将方法引用<code class="du kx ky kz la b">Integer::sum</code>用于<code class="du kx ky kz la b">BiFunction</code>参数，方法<code class="du kx ky kz la b">merge</code>采用该参数来确定如何合并值。注意，尽管我在这里使用的是原始的文字值<code class="du kx ky kz la b">int</code>，但是它们被自动装箱为<code class="du kx ky kz la b">Map</code>中的<code class="du kx ky kz la b">Integer</code>对象。，而<code class="du kx ky kz la b">Integer::sum</code>调用将导致更多的<code class="du kx ky kz la b">Integer</code>对象的拆箱和装箱。</p><p id="c9b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在测试的最后一个断言中，用<code class="du kx ky kz la b">Color.RED</code>实例调用<code class="du kx ky kz la b">get</code>会返回<code class="du kx ky kz la b">null</code>。当调用<code class="du kx ky kz la b">get</code>时，我必须显式地将值设置为<code class="du kx ky kz la b">0</code>，以便它返回为<code class="du kx ky kz la b">0</code>。用<code class="du kx ky kz la b">get</code>解决<code class="du kx ky kz la b">null</code>返回问题的一种方法是使用<code class="du kx ky kz la b">getOrDefault</code>代替。这将允许您在<code class="du kx ky kz la b">Map</code>中不存在密钥的情况下返回默认值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ld"><img src="../Images/173e7fd8f10439a9c7a0de3540ddbd65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*euerI9nic5IXPa7LMQFodA.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">将地图用作算盘，使用getOrDefault处理空情况</p></figure><p id="4d78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kx ky kz la b">merge</code>和<code class="du kx ky kz la b">getOrDefault</code>方法都是在Java 8中添加的，是开发人员在<code class="du kx ky kz la b">Map</code>上理解的有用方法。</p><h1 id="007d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">使用原始地图而不是地图</h1><p id="e2a7" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在<a class="ae jt" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> Eclipse集合</a>中，有对原始地图的支持。有一个<code class="du kx ky kz la b">ObjectIntMap</code>类型和相应的实现可以用来计数珠子。我将使用一个<code class="du kx ky kz la b">MutableObjectIntMap</code>,这样我就可以使用<code class="du kx ky kz la b">ObjectIntMaps</code>工厂类改变映射并创建实现。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es le"><img src="../Images/53a27d983f600aeefe17604b181c0bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8EDsarxqkz81eRRgRJPv4A.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">使用可变对象图作为算盘</p></figure><p id="5b4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个<code class="du kx ky kz la b">MutableObjectIntMap</code>有一个<code class="du kx ky kz la b">addToValue</code>方法，可以用来在map中放入一个新值，或者添加到map中的一个现有值。方法<code class="du kx ky kz la b">getIfAbsent</code>可用于查找数值。<code class="du kx ky kz la b">0</code>值是一个<code class="du kx ky kz la b">int</code>，而不是一个<code class="du kx ky kz la b">Integer</code>对象，并且对<code class="du kx ky kz la b">addToValue</code>的任何调用都不会导致任何装箱。</p><p id="e991" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong> : Eclipse集合<code class="du kx ky kz la b">HashBag</code>类利用了一个<code class="du kx ky kz la b">MutableObjectIntMap</code>。</p><h1 id="9a7c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">用袋子数算盘上的珠子</h1><p id="e6ff" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">那么我如何使用来自<a class="ae jt" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> Eclipse集合</a>的<code class="du kx ky kz la b">MutableBag</code>来解决这个问题呢？一个<code class="du kx ky kz la b">MutableBag</code>是一个<code class="du kx ky kz la b">Collection</code>，不是一个<code class="du kx ky kz la b">Map</code>。它有<code class="du kx ky kz la b">add</code>和<code class="du kx ky kz la b">remove</code>方法，我可以用它们来添加单个项目。<code class="du kx ky kz la b">MutableBag</code>也有<code class="du kx ky kz la b">addOccurrences</code>和<code class="du kx ky kz la b">removeOccurrences</code>方法，允许一次添加特定数量的项目。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lf"><img src="../Images/b13f14d6cd5b46e109858c3544b63899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oiQ-OE9-Q8gmKfjfinrrqQ.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">用包当算盘</p></figure><p id="0c1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这个用例来说，<code class="du kx ky kz la b">Bag</code>上单独命名的方法比命名为<code class="du kx ky kz la b">merge</code>的单个方法更能揭示意图。注意，在<code class="du kx ky kz la b">Color.RED</code>的情况下，包将从对<code class="du kx ky kz la b">occurrencesOf</code>的调用中返回<code class="du kx ky kz la b">0</code>。<code class="du kx ky kz la b">Bag</code>不会遭受<code class="du kx ky kz la b">Map.get</code>所遭受的<code class="du kx ky kz la b">null</code>问题。如果一个值在<code class="du kx ky kz la b">Bag</code>中不存在，<code class="du kx ky kz la b">occurrencesOf</code>方法总是返回<code class="du kx ky kz la b">0</code>。</p><h1 id="bc59" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">更多信息</h1><p id="6b38" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">还有一些博客提供了关于Eclipse集合中的<code class="du kx ky kz la b">Bag</code>类型和支持方法(如<code class="du kx ky kz la b">countBy</code>)的更多细节。以下博客由Nikhil Nanivadekar 撰写。它描述了Eclipse集合中<code class="du kx ky kz la b">Bag</code>类型的许多实现细节，这可以带来内存和性能方面的好处。</p><div class="li lj ez fb lk ll"><a rel="noopener follow" target="_blank" href="/oracledevs/bag-the-counter-2689e901aadb"><div class="lm ab dw"><div class="ln ab lo cl cj lp"><h2 class="bd hj fi z dy lq ea eb lr ed ef hh bi translated">包——柜台</h2><div class="ls l"><h3 class="bd b fi z dy lq ea eb lr ed ef dx translated">我经常遇到计算物体数量的需要。我体验到了数数的必要性…</h3></div><div class="lt l"><p class="bd b fp z dy lq ea eb lr ed ef dx translated">medium.com</p></div></div><div class="lu l"><div class="lv l lw lx ly lu lz jn ll"/></div></div></a></div><p id="5a49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还写了一篇单独的博客，描述Eclipse集合中的<code class="du kx ky kz la b">countBy</code>方法，它提供了<code class="du kx ky kz la b">Bag</code>作为其返回类型。</p><div class="li lj ez fb lk ll"><a rel="noopener follow" target="_blank" href="/oracledevs/ec-by-example-countby-a2d6411e95e1"><div class="lm ab dw"><div class="ln ab lo cl cj lp"><h2 class="bd hj fi z dy lq ea eb lr ed ef hh bi translated">EC示例:CountBy</h2><div class="ls l"><h3 class="bd b fi z dy lq ea eb lr ed ef dx translated">了解如何在Eclipse集合中使用countBy方法。</h3></div><div class="lt l"><p class="bd b fp z dy lq ea eb lr ed ef dx translated">medium.com</p></div></div><div class="lu l"><div class="ma l lw lx ly lu lz jn ll"/></div></div></a></div><p id="7ec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你喜欢阅读这篇博客，并在这个过程中学到了一些关于<code class="du kx ky kz la b">Map</code>和<code class="du kx ky kz la b">Bag</code>类型的有用知识！</p><p id="298d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mb">我是</em><a class="ae jt" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"><em class="mb">Eclipse Collections</em></a><em class="mb">OSS项目在</em><a class="ae jt" href="https://projects.eclipse.org/projects/technology.collections" rel="noopener ugc nofollow" target="_blank"><em class="mb">Eclipse Foundation</em></a><em class="mb">的项目负责人。</em> <a class="ae jt" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> <em class="mb">月食收藏</em> </a> <em class="mb">为</em> <a class="ae jt" href="https://github.com/eclipse/eclipse-collections/blob/master/CONTRIBUTING.md" rel="noopener ugc nofollow" target="_blank"> <em class="mb">投稿</em> </a> <em class="mb">。如果你喜欢这个库，你可以在GitHub上让我们知道。</em></p><p id="1735" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能喜欢的其他Java文章</p><div class="li lj ez fb lk ll"><a rel="noopener follow" target="_blank" href="/javarevisited/the-java-programmer-roadmap-f9db163ef2c2"><div class="lm ab dw"><div class="ln ab lo cl cj lp"><h2 class="bd hj fi z dy lq ea eb lr ed ef hh bi translated">2022年Java程序员路线图</h2><div class="ls l"><h3 class="bd b fi z dy lq ea eb lr ed ef dx translated">2022年成为Java开发人员的图解指南，包含相关课程的链接</h3></div><div class="lt l"><p class="bd b fp z dy lq ea eb lr ed ef dx translated">medium.com</p></div></div><div class="lu l"><div class="mc l lw lx ly lu lz jn ll"/></div></div></a></div><div class="li lj ez fb lk ll"><a rel="noopener follow" target="_blank" href="/javarevisited/10-best-places-to-learn-java-online-for-free-ce5e713ab5b2"><div class="lm ab dw"><div class="ln ab lo cl cj lp"><h2 class="bd hj fi z dy lq ea eb lr ed ef hh bi translated">2022年免费在线学习Java的10个最佳地点</h2><div class="ls l"><h3 class="bd b fi z dy lq ea eb lr ed ef dx translated">我最喜欢的免费在线学习Java的网站，适合初学者和想学习Java编码的人…</h3></div><div class="lt l"><p class="bd b fp z dy lq ea eb lr ed ef dx translated">medium.com</p></div></div><div class="lu l"><div class="md l lw lx ly lu lz jn ll"/></div></div></a></div><div class="li lj ez fb lk ll"><a rel="noopener follow" target="_blank" href="/javarevisited/13-topics-you-should-prepare-for-your-next-spring-boot-interview-5f2993a04ff5"><div class="lm ab dw"><div class="ln ab lo cl cj lp"><h2 class="bd hj fi z dy lq ea eb lr ed ef hh bi translated">你应该为2022年的下一次Spring Boot面试准备的13个话题</h2><div class="ls l"><h3 class="bd b fi z dy lq ea eb lr ed ef dx translated">你应该为下一次Java和Spring Boot面试准备的13个基本主题的列表和学习资源…</h3></div><div class="lt l"><p class="bd b fp z dy lq ea eb lr ed ef dx translated">medium.com</p></div></div><div class="lu l"><div class="me l lw lx ly lu lz jn ll"/></div></div></a></div></div></div>    
</body>
</html>