<html>
<head>
<title>Generate Docker images with Spring Boot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Spring Boot生成Docker图像</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/generate-docker-images-with-spring-boot-d78e5a80fae4?source=collection_archive---------1-----------------------#2020-05-25">https://medium.com/javarevisited/generate-docker-images-with-spring-boot-d78e5a80fae4?source=collection_archive---------1-----------------------#2020-05-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="58fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一种简单、快速、无压力的生成Docker图像的方法，无需为Spring应用程序定义任何手动Docker文件</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/446162be2b9d48c441e202c26e07398d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ni_GtbU8h21Xd56SryIE1w.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">图片来自<a class="ae jt" href="http://undraw.co" rel="noopener ugc nofollow" target="_blank">未绘制的</a></p></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="974d" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">为什么是集装箱</h1><p id="fcaa" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在一个用户被能在几毫秒内返回数据的应用程序所吸引的世界里，只有一种工具是每个公司都倾向于用来解决请求能力增加所带来的问题的……容器。</p><p id="e03c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">无论您使用的是Docker、Kubernetes还是亚马逊的弹性计算服务(ECS)，处理系统上增加的负载都变得更加易于管理，因为您现在有了一种机制，可以在应用超过某个阈值时自动扩展应用(基于<em class="le">指标，例如CPU、RAM等)。</em>)。</p><h1 id="4f89" class="kb kc hi bd kd ke lf kg kh ki lg kk kl km lh ko kp kq li ks kt ku lj kw kx ky bi translated">Docker图像的旧状态</h1><p id="b440" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">当Docker第一次发布时，开发人员花了一些时间来习惯语法并理解他们如何容器化他们的应用程序，考虑诸如挂载卷、端口暴露等事情。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="f645" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个非常基本的docker文件示例，它允许您在端口8080上部署应用程序。对于那些对Docker一无所知的人来说，它可能看起来有点像行话…</p><p id="7117" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于那些这样做的人，你可能认为这很容易——你是对的，虽然这个例子是一个非常简单的例子，但我见过100多行长的文件来启动和运行像视频流应用程序这样简单的东西。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/23078e2555be26a8c88c2d2b3db5f77c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*cqcLk_Uf_w5MwRplOdUIKQ.png"/></div><p class="jp jq et er es jr js bd b be z dx translated">旧的部署状态</p></figure><h1 id="290d" class="kb kc hi bd kd ke lf kg kh ki lg kk kl km lh ko kp kq li ks kt ku lj kw kx ky bi translated">Spring 2.3新增功能</h1><p id="06e2" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Pivotal ( <em class="le">被VMWare </em>收购)的可爱员工认为他们可以帮助这个部门，所以他们将它添加到了Spring的<a class="ae jt" href="https://spring.io/blog/2020/01/27/creating-docker-images-with-spring-boot-2-3-0-m1" rel="noopener ugc nofollow" target="_blank">最新版本</a>！</p><h2 id="4258" class="ln kc hi bd kd lo lp lq kh lr ls lt kl iq lu lv kp iu lw lx kt iy ly lz kx ma bi translated">云原生构建包</h2><p id="37e8" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">如果你曾经在一个托管平台上使用过一个应用程序(比如CloudFoundry )，你会以某种方式使用构建包，甚至可能没有意识到这一点！由于最近对这些处理方式的更新，它与平台分离，并产生了一种新的类型，称为云原生构建包(<em class="le">CNBP</em>)——正如其名称所示，编写一次，在任何地方运行。</p><div class="mb mc ez fb md me"><a href="https://buildpacks.io/" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hj fi z dy mj ea eb mk ed ef hh bi translated">云本机构建包文档</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">与Dockerfiles相比，Buildpacks为构建应用程序提供了更高层次的抽象。具体来说，构建包…</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">buildpacks.io</p></div></div></div></a></div><p id="283e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Spring 2.3中更具体的构建包— Paketo</p><div class="mb mc ez fb md me"><a href="https://paketo.io/" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hj fi z dy mj ea eb mk ed ef hh bi translated">帕克托建筑包</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">模块化构建包，用Go编写。Paketo Buildpacks为应用程序提供语言运行时支持。他们利用…</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">paketo.io</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms jn me"/></div></div></a></div><h2 id="96de" class="ln kc hi bd kd lo lp lq kh lr ls lt kl iq lu lv kp iu lw lx kt iy ly lz kx ma bi translated">生成命令</h2><p id="9506" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Spring 2.3现在支持CNBP ( <em class="le"> Paketo </em> ) <em class="le"> </em>开箱即用。您可以在<a class="ae jt" rel="noopener" href="/@javinpaul/10-free-courses-to-learn-docker-and-devops-for-frontend-developers-691ac7652cee"> Docker </a>中生成并运行您的<a class="ae jt" href="https://www.java67.com/2018/06/5-best-courses-to-learn-spring-boot-in.html" rel="noopener ugc nofollow" target="_blank"> Spring应用程序</a>，无需任何额外的配置，只需从您的终端窗口发出一条命令！</p><p id="a8c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">美文</strong> : <code class="du mt mu mv mw b">./mvnw spring-boot:build-image</code></p><p id="0d33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">梯度</strong> : <code class="du mt mu mv mw b">./gradlew bootBuildImage</code></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/01c398130193e9955ffba84e63b2b7c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SrZdDatNk3BsezzcS6ipJA.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">用Gradle生成图像</p></figure><p id="2d25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然运行需要一段时间，但请记住，我们的这一特性是现成的！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/a95939966d5ffafc289667b0077eb00f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jA54nft7r5g5d4ukqbE9EA.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">建立成功</p></figure><p id="0f50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然构建已经完成，让您的Docker守护进程启动并运行，然后简单地运行容器(<em class="le">您的映像名称将会不同</em>)</p><p id="683f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du mt mu mv mw b">docker run -p 8080:8080 docker.io/library/docker:0.0.1-SNAPSHOT</code></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mz"><img src="../Images/2340137e56818f73212f5b2737a72b06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3DGi8iTPjvZlprMKAucPbw.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">在Docker中运行应用程序</p></figure><p id="5497" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就这样…您的应用程序现在正在Docker中运行，您可以将它部署到您选择的平台上了！</p><h1 id="22cd" class="kb kc hi bd kd ke lf kg kh ki lg kk kl km lh ko kp kq li ks kt ku lj kw kx ky bi translated">JIB谷歌图书馆</h1><p id="0a95" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">另一种自动生成和部署容器的方法是使用Google的JIB库。虽然输出仍然是可以在任何地方运行的云原生docker映像，但Google已经决定进一步优化映像层的构建方式，以便您可以在每次部署中获得最佳性能(<em class="le">构建时间</em>)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es na"><img src="../Images/20478fac01f108304117cfb47b4b85be.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*CGO9NtFg6ttfVlJju7L-Bg.png"/></div><p class="jp jq et er es jr js bd b be z dx translated">以三角帆的方式构建图像</p></figure><p id="2d27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你会问，构建上下文和图像缓存去了哪里？问得好，Google决定JIB将你的应用程序分解成逻辑层(<em class="le">，例如应用程序，依赖层</em>)，只构建你的应用程序中已经改变的部分(<em class="le">，而Docker构建所有部分</em>)，并自动生成图像——将它直接推送到你选择的容器注册表或你的本地Docker守护进程。</p><h2 id="9b01" class="ln kc hi bd kd lo lp lq kh lr ls lt kl iq lu lv kp iu lw lx kt iy ly lz kx ma bi translated">生成命令</h2><p id="163d" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在生成映像时，您有两种选择，要么是远程存储库，要么直接到本地Docker守护进程。</p><p id="ff38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/GoogleContainerTools/jib/blob/master/jib-maven-plugin" rel="noopener ugc nofollow" target="_blank">美芬</a>:</p><pre class="je jf jg jh fd nb mw nc nd aw ne bi"><span id="fddc" class="ln kc hi mw b fi nf ng l nh ni">mvn compile jib:build (remote registry)<br/>mvn compile jib:dockerBuild (local Daemon)</span></pre><p id="ac1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">格雷德:</p><pre class="je jf jg jh fd nb mw nc nd aw ne bi"><span id="45df" class="ln kc hi mw b fi nf ng l nh ni">./gradlew jib (remote registry)<br/>./gradlew jibDockerBuild (local Daemon)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nj"><img src="../Images/410aadbf19e853958219e98ca103a554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aXTT-3Pgptci7aJXaK5fzA.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">JIB构建到守护进程</p></figure><h1 id="50a1" class="kb kc hi bd kd ke lf kg kh ki lg kk kl km lh ko kp kq li ks kt ku lj kw kx ky bi translated">摘要</h1><p id="7b61" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">因此，我们研究了两种不同的方法来为您的Spring Boot应用程序生成Docker图像，该应用程序与您能想象到的所有平台都兼容。虽然它们都生成相同的输出，但每一个都有自己的优点和注意事项，所以请确保您仔细考虑了您的用例，查看了文档，然后就下一个项目使用哪一个做出明智的决定。</p><p id="638e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你喜欢这种风格的教程，请在评论中留下你的反馈，否则…下次见！</p><h2 id="18a6" class="ln kc hi bd kd lo lp lq kh lr ls lt kl iq lu lv kp iu lw lx kt iy ly lz kx ma bi translated">资源</h2><p id="c577" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated"><strong class="ih hj">Spring 2.3 Docker Docs:</strong><a class="ae jt" href="https://spring.io/blog/2020/01/27/creating-docker-images-with-spring-boot-2-3-0-m1" rel="noopener ugc nofollow" target="_blank">https://Spring . io/blog/2020/01/27/creating-Docker-images-with-Spring-boot-2-3-0-m1</a></p><p id="95d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">云原生构建包文档</strong>:<a class="ae jt" href="https://buildpacks.io" rel="noopener ugc nofollow" target="_blank">https://Build Packs . io</a></p><p id="e46a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">Paketo Docs</strong>:<a class="ae jt" href="https://paketo.io" rel="noopener ugc nofollow" target="_blank">https://Paketo . io</a></p><p id="5827" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">吊臂库</strong>:<a class="ae jt" href="https://cloud.google.com/java/getting-started/jib" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/java/getting-started/jib</a></p></div></div>    
</body>
</html>