<html>
<head>
<title>Avoid Explicit Null Checks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">避免显式空检查</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/avoid-verbose-null-checks-b3f11afbfcc9?source=collection_archive---------0-----------------------#2022-02-03">https://medium.com/javarevisited/avoid-verbose-null-checks-b3f11afbfcc9?source=collection_archive---------0-----------------------#2022-02-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/35bbe7dfa0b5365c4b9b0ba6330e8bbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZksmOsl4nDWFOID6.jpg"/></div></div></figure><p id="eedd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">阅读糟糕的代码最令人沮丧的事情之一是，你不得不在头脑中抛弃大量代码，只是为了找到相关的内容。在他的职业生涯中，谁没有至少一次发现一个充满重复的巨大方法，一个做不止一件事的样板？我可以谈论一整天的代码气味，但是今天我只想集中讨论一种非常主要的代码气味，它实际上比许多人认为的更容易避免。</p><p id="68d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">显式空值检查<br/> </strong>显式空值检查是对传入参数的空值验证，因为害怕出现<a class="ae jo" href="https://www.java67.com/2021/05/how-to-solve-nullpointerexception-in-java.html" rel="noopener ugc nofollow" target="_blank"><em class="jp">NullPointerException</em></a>。这不是一个好的做法，因为它给你的代码增加了噪音，增加了代码阅读的难度，并且违反了SRP( <em class="jp"> S </em> <a class="ae jo" href="https://javarevisited.blogspot.com/2017/04/single-responsibility-principle-example.html" rel="noopener ugc nofollow" target="_blank"> <em class="jp">单一责任原则</em> </a>)。让我们来看一个空值检查的例子。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="62c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有些人认为，“<em class="jp">但有时我别无选择，只能这样做。”。<br/> </em>真的吗？让我展示一些可以根据具体情况使用的替代方案。</p><p id="5092" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么都不做</strong> <br/>一种选择是什么都不做，这个函数的调用方，应该小心谨慎，确保不传递null。但是如果他这样做了，并且这导致了一个<a class="ae jo" href="https://javarevisited.blogspot.com/2013/05/ava-tips-and-best-practices-to-avoid-nullpointerexception-program-application.html#axzz6Kgpx2OGT" rel="noopener ugc nofollow" target="_blank"><em class="jp">NullPointerException</em></a>，这是一个知道函数被使用的方式是错误的好方法。而且我们调用的函数中的代码永远不应该返回null。空检查不好，但返回空也同样不好。</p><p id="af2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">被调用的函数可以做很多事情来避免返回nul。如果异常出现，这至少会提示一个对话，关于什么是强制的，为什么不存在？也许需要对系统设计进行更多的思考。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="b0d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">使用断言</strong><br/>Java关键字‘assert’可以与布尔表达式结合使用，通过抛出断言错误来停止程序执行。虽然这似乎是if语句的一个有趣的替代，但是在java 中默认禁用<a class="ae jo" href="https://javarevisited.blogspot.com/2012/01/what-is-assertion-in-java-java.html" rel="noopener ugc nofollow" target="_blank">断言。对于那些想小心使用它们的人来说，它们是很好的调试工具。有时一些程序员会在修复bug时启用它们，但是在生产环境中它们总是被禁用。</a></p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="b999" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">空对象模式 <br/>这种行为设计模式背后的思想是使用多态性来创建对象的空版本(M.Fowler也称它们为缺失对象)。这些空对象将有一个名为<code class="du jw jx jy jz b">isNull()</code>的函数，它对于源类总是返回false，但是对于空对象将返回true。客户端将能够选择传递一个空对象而不是空值，这将避免在方法()中进行显式的空值检查。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="84af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最新版本的java有一个名为<a class="ae jo" href="https://javarevisited.blogspot.com/2017/04/10-examples-of-optional-in-java-8.html#axzz6ccm5KWKs" rel="noopener ugc nofollow" target="_blank"> Optional </a>的类，可以用来避免返回空值。它基本上是空对象模式的一个实现。通过在客户端使用<a class="ae jo" href="https://www.java67.com/2018/06/java-8-optional-example-ispresent-orElse-get.html" rel="noopener ugc nofollow" target="_blank">可选的</a>，我们可以避免传递空值。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="6148" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">验证器、IllegalArgumentException和业务异常</strong> <br/>如果函数的调用者不在我们的控制范围内，并且我们不能确信将传递给我们函数的值，那么有其他替代空检查的方法，尽管也是防御性的，但可能对业务更友好，并且可能提供更多信息。</p><p id="926d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">验证器</strong> <br/>我在开头提到方法不应该有多重责任。如果出于某种原因，我们必须进行空检查或其他类型的验证，我们可以将它委托给一个验证器对象。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="cc7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有时，这个验证器也不是一个平滑的解决方案，可能是类中不必要的依赖。可以使用装饰模式来替换它。基本上是一个包装被装饰对象调用的函数的包装器。关于装饰器设计模式的更多信息，在我之前写的这篇文章中:<a class="ae jo" rel="noopener" href="/javarevisited/can-you-please-wrap-the-gift-it-is-for-my-grandma-1a15da02f60d">https://medium . com/Java re visited/can-you-please-wrap-the-gift-it-is-for my-granth-1a 15da 02 f 60d</a></p><p id="9667" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">非法参数异常<br/></strong><a class="ae jo" href="https://javarevisited.blogspot.com/2012/06/common-cause-of-javalangnullpointerexce.html" rel="noopener ugc nofollow" target="_blank"><em class="jp">NullPointerException</em></a>它对于客户端来说不是一个非常有用的异常。因此，如果我们决定不进行任何类型的空值检查，但我们仍然害怕空值，也许我们可以抛出一个<em class="jp"> IllegalArgumentException </em>来代替。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="9acc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">捕捉运行时异常(又名吞咽异常)，因为如你所知，程序只是继续工作。强烈建议，如果你要做这样的事情，至少你要添加一个<em class="jp"> Logger.log() </em>语句来帮助开发人员在出现问题时<a class="ae jo" href="https://javarevisited.blogspot.com/2011/07/java-debugging-tutorial-example-tips.html#axzz6bYzaddcE" rel="noopener ugc nofollow" target="_blank">调试</a>。</p><p id="775f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">业务异常</strong> <br/>正如我刚才在前面提到的，替代运行时异常不是一个值得捕捉的好东西。相反，我们可以使用业务/声明的异常，这将要求调用方函数做好准备(通过添加try和catch块..)查找潜在故障。</p><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="ju jv l"/></div></figure></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><p id="e101" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如您所见，除了显式空值检查，还有其他选择。空检查的主题很重要，因为作为干净的程序员和软件工匠，我们不仅要关心代码是否工作，还要关心它的可读性和可维护性。业界对null有很大的恐惧，这是有道理的，因为null会导致灾难性的灾难，但这并不意味着我们首先应该机械地执行冗长的null检查。</p><blockquote class="kh ki kj"><p id="2687" class="iq ir jp is b it iu iv iw ix iy iz ja kk jc jd je kl jg jh ji km jk jl jm jn hb bi translated">三思而后行</p></blockquote><p id="da63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望你喜欢这篇文章，如果你喜欢，请鼓掌👏和/或在社交媒体上与您的朋友分享。</p></div></div>    
</body>
</html>