<html>
<head>
<title>GraphQL with Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带Java的GraphQL</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/graphql-with-java-8b8c9ec5971e?source=collection_archive---------3-----------------------#2021-04-19">https://medium.com/javarevisited/graphql-with-java-8b8c9ec5971e?source=collection_archive---------3-----------------------#2021-04-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="245f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们为什么需要它，什么时候需要它？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/5b40e77385666bca3c0db808f1c29e59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p_SAJcL95PLcPL7l8qRN3w.png"/></div></div></figure><p id="20b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在深入细节之前，让我们先举个例子。</p><p id="d29f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑到我们正在构建一个OTT平台。每个用户都有一个账户，可以保存自己喜欢的节目。他应该能够从移动应用程序或浏览器等不同平台访问他的帐户。</p><p id="7b7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个平台都有自己的网络界面，有些是精简的，有些是扩展的。</p><p id="b6e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了便于学习，让我们假设用户模型只有以下细节:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jp jq l"/></div></figure><p id="f992" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ProgramInfo将提供以下详细信息:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jp jq l"/></div></figure><p id="7d83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我们使用<a class="ae jr" rel="noopener" href="/javarevisited/why-spring-is-the-best-framework-for-developing-rest-apis-in-java-784590e484a4"> Rest API </a>时，如果我们只需要账户的名称和国家，下面是我们的选项:</p><ul class=""><li id="65c2" class="js jt hi ih b ii ij im in iq ju iu jv iy jw jc jx jy jz ka bi translated">我们将需要一个最小的模型和一个单独的API来获得所需的细节</li><li id="37e7" class="js jt hi ih b ii kb im kc iq kd iu ke iy kf jc jx jy jz ka bi translated">获得整个用户的详细信息(假设用户已经将许多节目保存为收藏夹)，使得通信消息变得沉重</li></ul><p id="b383" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如您在这里看到的，客户机无法控制它想要什么，只有服务器决定客户机需要在服务器上查询什么。</p><p id="c9c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是如果我们在服务器中使用<a class="ae jr" rel="noopener" href="/javarevisited/top-5-graphql-tutorials-and-courses-for-beginners-fb5543506fc2?source=---------75------------------"> GraphQL </a>，客户端可以请求它需要访问的信息。我正在使用<a class="ae jr" href="https://github.com/graphql/graphql-playground" rel="noopener ugc nofollow" target="_blank"> Graphql playground工具</a>与我创建的Graphql应用程序进行通信。</p><p id="87d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是上述场景的查询和结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://dev.to/javinpaul/5-best-courses-to-learn-graphql-in-2020-2fo5"><div class="er es kg"><img src="../Images/40bf11ced2fdbefc95a112a9aad1ceaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Ybp-dGxzHYEmfpHMjUiVQ.png"/></div></a></figure><p id="b07b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者，如果客户端想要用户最喜欢的程序的programIds，下面是它将如何进行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://javarevisited.blogspot.com/2019/05/top-5-courses-to-learn-graphql-in-2019.html#axzz6AGTrQ8NN"><div class="er es kh"><img src="../Images/223bce12b0554e69d25bcdb1b7fb05c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V6yawcJxUTZx3mmnJaeYFQ.png"/></div></a></figure><p id="28bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很有趣，不是吗？</p><p id="20de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们实现代码来实现这一点。第一步是拥有一个graphql模式。下面是我为我们的用例定义的模式。根据我的实现，这需要放在资源文件夹中。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jp jq l"/></div></figure><p id="37e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经声明了两个定制模型，User和ProgramInfo。ProgramInfo是用户模型的一部分。</p><p id="1554" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，声明了一个查询，该查询(userById)将在Id上。为了接收用户模型，客户机需要提供一个userId来标识所请求的资源。他可以选择在用户模型中提供他想要接收的值。</p><p id="e76d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将实现模式，我使用的是graphql-java库。我将使用带有maven build的spring-boot应用程序。下面的依赖关系需要添加到我们的pom.xml中。我正在使用guava库解析模式文件。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jp jq l"/></div></figure><p id="05e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用上面定义的模式，我们需要创建服务于客户端请求的连接。下面是创建GraphQL实例所需的基本实现。</p><ol class=""><li id="51ae" class="js jt hi ih b ii ij im in iq ju iu jv iy jw jc ki jy jz ka bi translated">读取定义的模式</li><li id="93f1" class="js jt hi ih b ii kb im kc iq kd iu ke iy kf jc ki jy jz ka bi translated">解析模式并创建连接</li><li id="09a0" class="js jt hi ih b ii kb im kc iq kd iu ke iy kf jc ki jy jz ka bi translated">从解析的模式创建一个GraphQL实例</li></ol><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jp jq l"/></div></figure><p id="82a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经为我们定义的模式初始化了一个GraphQL实例。启动应用程序，通过graphql playground tool点击下面的<a class="ae jr" href="http://localhost:8080/graphql" rel="noopener ugc nofollow" target="_blank"> url </a>,请求正文包含所需的信息。</p><h1 id="1f65" class="kj kk hi bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">参考资料:</h1><p id="665a" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">GraphQL网站:【https://graphql.org/learn/ T2】</p><p id="b9e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作者的github资源库:【https://github.com/mrajaian/graphqlExample T4】</p></div></div>    
</body>
</html>