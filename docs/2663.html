<html>
<head>
<title>Avoid entering passwords to fetch Ticket Granting Ticket</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">避免输入密码来获取票证授予票证</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/avoid-entering-passwords-to-fetch-ticket-granting-ticket-d37704248503?source=collection_archive---------5-----------------------#2022-12-29">https://medium.com/javarevisited/avoid-entering-passwords-to-fetch-ticket-granting-ticket-d37704248503?source=collection_archive---------5-----------------------#2022-12-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e24e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Kerberos本地主机</p><p id="3265" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章讲述了在用户不输入 <strong class="ih hj"> <em class="je">密码</em> </strong>的情况下，获取<a class="ae jd" rel="noopener" href="/@suriyaprakhash/authenticate-without-passwords-or-tokens-cf68eeb4deef#9c44">用户主体名称</a> <em class="je">的<a class="ae jd" rel="noopener" href="/@suriyaprakhash/authenticate-without-passwords-or-tokens-cf68eeb4deef#6d57">票授予票</a>。</em></p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/46adb460d0e27e76c4792bc805473f17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NCFzZ-uP3MwDI4e3"/></div></div><p class="jr js et er es jt ju bd b be z dx translated"><a class="ae jd" href="https://unsplash.com/@leohoho?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Leohoho </a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><h2 id="da6c" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">内容</h2><ul class=""><li id="7bd5" class="kq kr hi ih b ii ks im kt iq ku iu kv iy kw jc kx ky kz la bi translated"><a class="ae jd" href="#94bf" rel="noopener ugc nofollow">为什么？</a></li><li id="05ac" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><a class="ae jd" href="#2fcd" rel="noopener ugc nofollow">假设</a></li><li id="691f" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><a class="ae jd" href="#eb66" rel="noopener ugc nofollow">如何？</a></li><li id="2903" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><a class="ae jd" href="#43c3" rel="noopener ugc nofollow">最后的想法</a></li></ul><h2 id="94bf" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">为什么？</h2><p id="cb0c" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">每当<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#6d57" rel="noopener ugc nofollow" target="_blank"> TGT </a>到期或用户每次登录计算机时，用户/系统需要执行kinit并<strong class="ih hj">传递密码</strong>以生成<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#6d57" rel="noopener ugc nofollow" target="_blank"> TGT </a>来访问资源。</p><p id="0220" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下方法将避免用户干预，因此用户不需要担心手动生成<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#6d57" rel="noopener ugc nofollow" target="_blank"> TGT </a>。</p><h2 id="2fcd" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">假设</h2><p id="7f4e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">这篇文章假设我们已经有了<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#547b" rel="noopener ugc nofollow" target="_blank"> Kerberos设置</a>，并且我们正在使用Kinit工具来获取<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#6d57" rel="noopener ugc nofollow" target="_blank">票据授予票据</a>。</p><ul class=""><li id="c441" class="kq kr hi ih b ii ij im in iq lj iu lk iy ll jc kx ky kz la bi translated">我们知道<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#b01c" rel="noopener ugc nofollow" target="_blank"> KDC </a>支持的加密类型</li><li id="4158" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated">我们知道在<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#b01c" rel="noopener ugc nofollow" target="_blank"> KDC </a>数据库中注册的<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#9c44" rel="noopener ugc nofollow" target="_blank">用户主体名称</a>及其密码</li><li id="e463" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated">安装krb5-user软件包</li></ul><h2 id="eb66" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">怎么会？</h2><ul class=""><li id="a081" class="kq kr hi ih b ii ks im kt iq ku iu kv iy kw jc kx ky kz la bi translated">使用支持的加密类型更新客户端机器中的<em class="je"> /etc/krb5.conf </em>文件。</li></ul><p id="7dac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是一个例子，</p><pre class="jg jh ji jj fd lm ln lo bn lp lq bi"><span id="4cbf" class="lr jw hi ln b be ls lt l lu lv"> default_tgs_enctypes = aes256-cts-hmac-sha1-96<br/> default_tkt_enctypes = aes256-cts-hmac-sha1-96<br/> permitted_enctypes = aes256-cts-hmac-sha1-96</span></pre><ul class=""><li id="0d39" class="kq kr hi ih b ii ij im in iq lj iu lk iy ll jc kx ky kz la bi translated">使用<a class="ae jd" href="https://web.mit.edu/kerberos/krb5-1.12/doc/admin/admin_commands/ktutil.html" rel="noopener ugc nofollow" target="_blank"> Ktutil </a>生成一个keytab文件</li></ul><pre class="jg jh ji jj fd lm ln lo bn lp lq bi"><span id="1d98" class="lr jw hi ln b be ls lt l lu lv">ktutil<br/>ktutil:  addent -password -p apacheuser@KERBEROS.COM -k 1 -e aes256-cts-hmac-sha1-96<br/>Password for apacheuser@KERBEROS.COM:<br/>ktutil:  wkt apacheuser.keytab<br/>ktutil:  q</span></pre><p id="5838" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，</p><ul class=""><li id="390a" class="kq kr hi ih b ii ij im in iq lj iu lk iy ll jc kx ky kz la bi translated"><strong class="ih hj">添加</strong>是<em class="je">添加条目</em></li><li id="8d7d" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj">-密码</strong>提示输入密码</li><li id="eb52" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> -p </strong>是委托人</li><li id="c1f2" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> -k </strong>是<a class="ae jd" href="https://web.mit.edu/kerberos/krb5-latest/doc/user/user_commands/kvno.html" rel="noopener ugc nofollow" target="_blank">密钥版本号</a></li><li id="ab07" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> -e </strong>是支持的加密类型之一</li><li id="2bc9" class="kq kr hi ih b ii lb im lc iq ld iu le iy lf jc kx ky kz la bi translated"><strong class="ih hj"> wkt </strong>是写键标签文件名</li></ul><figure class="jg jh ji jj fd jk er es paragraph-image"><a href="https://www.java67.com/2012/09/keytool-command-examples-java-add-view-certificate-ssl.html"><div class="er es lw"><img src="../Images/2425eb1784aa2c6fcb8227f737a7bb39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D57KDRwL8yh4i-WumKXm3Q.jpeg"/></div></a></figure><p id="f877" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了检查密钥表，我们将使用klist，</p><pre class="jg jh ji jj fd lm ln lo bn lp lq bi"><span id="70b1" class="lr jw hi ln b be ls lt l lu lv">klist -ekt apacheuser.keytab</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lx"><img src="../Images/2a57052a34328a021f594bea0d15fe6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GXocoJV6cAI-ZedKJs1SbQ.jpeg"/></div></div></figure><p id="0ef6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们将使用这个<strong class="ih hj"> apacheuser.keytab </strong>来生成TGT</p><pre class="jg jh ji jj fd lm ln lo bn lp lq bi"><span id="e066" class="lr jw hi ln b be ls lt l lu lv">kinit -k -t apacheuser.keytab apacheuser@KERBEROS.COM</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ly"><img src="../Images/291e26088f4b797be282ef5693a59133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P0TRtG-Pfv8JQy_1V-SXqw.png"/></div></div></figure><p id="662a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们尝试访问我们正在尝试访问的服务，</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lz"><img src="../Images/610224e090939c933ead7fe793fe1ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0A8Y30XYQiBY1YZH6BW8Q.png"/></div></div></figure><h2 id="43c3" class="jv jw hi bd jx jy jz ka kb kc kd ke kf iq kg kh ki iu kj kk kl iy km kn ko kp bi translated">最后的想法</h2><p id="72f3" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">我们可以设置一些核心任务，或者在启动时运行脚本，或者做一些对我们来说最有效的事情，以避免用户实际传递密码的干预。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ma"><img src="../Images/5b18c5fa79645be22ef762c6b3f86738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JGjTiWYg9usJCIjk"/></div></div><p class="jr js et er es jt ju bd b be z dx translated">Johannes Plenio 在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="79e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">万一密码改变<em class="je">，该脚本可以以这样的方式制作，即它将在用户下一次尝试登录或访问服务时提示输入密码</em>，并使用新密码重新生成<a class="ae jd" href="https://medium.suriyaprakhash.com/authenticate-without-passwords-or-tokens-cf68eeb4deef#e5b4" rel="noopener ugc nofollow" target="_blank"> keytab </a>。</p></div></div>    
</body>
</html>