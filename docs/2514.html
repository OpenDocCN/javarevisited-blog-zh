<html>
<head>
<title>Experimenting with Java Records, DatePicker, and TableView in JavaFX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在JavaFX中试验Java记录、日期选择器和表视图</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/experimenting-with-java-records-datepicker-and-tableview-in-javafx-446ff272dfd2?source=collection_archive---------3-----------------------#2022-11-27">https://medium.com/javarevisited/experimenting-with-java-records-datepicker-and-tableview-in-javafx-446ff272dfd2?source=collection_archive---------3-----------------------#2022-11-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6105" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将我的JavaFX ToDoList从ListView升级到TableView</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/4517816f8a93f66bf5a727be6de79847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YrcIKeqmAnCQhvXiS_xpHg.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">我的ToDoList从ListView升级到带有两个可排序列的TableView</p></figure><h1 id="ed47" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">将我的JavaFX升级到DoList应用程序</h1><p id="a20a" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在我的Java ToDoList的第一次迭代中，我使用了JavaFX <code class="du kw kx ky kz b">ListView</code>组件。在第一次迭代中，我只是在ToDo列表中保存了一个字符串<code class="du kw kx ky kz b">List</code>。你可以在下面的博客中看到我第一次迭代的结果。</p><div class="la lb ez fb lc ld"><a href="https://donraab.medium.com/my-first-javafx-application-ee70a1d48cb3" rel="noopener follow" target="_blank"><div class="le ab dw"><div class="lf ab lg cl cj lh"><h2 class="bd hj fi z dy li ea eb lj ed ef hh bi translated">我的第一个JavaFX应用程序</h2><div class="lk l"><h3 class="bd b fi z dy li ea eb lj ed ef dx translated">通过在IntelliJ中构建简单的TodoList应用程序来学习JavaFX</h3></div><div class="ll l"><p class="bd b fp z dy li ea eb lj ed ef dx translated">donraab.medium.com</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr jn ld"/></div></div></a></div><p id="9b0e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我决定让我的待办事项列表按日期记录待办事项。所以我需要在我的待办事项列表中保留一些比字符串更复杂的东西。</p><h1 id="a9c5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">将待办事项创建为记录</h1><p id="0551" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">因为我在Java 17中开发这个应用程序，所以我把我的<code class="du kw kx ky kz b">ToDoItem</code>变成了Java <code class="du kw kx ky kz b">record</code>。从Java 14开始，Java就支持记录。</p><p id="866e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我的<code class="du kw kx ky kz b">ToDoItem</code>的第一次迭代。</p><pre class="je jf jg jh fd ls kz lt bn lu lv bi"><span id="dd15" class="lw ju hi kz b be lx ly l lz ma">public record ToDoItem(String name, LocalDate date) {}</span></pre><p id="4e7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在<code class="du kw kx ky kz b">TodoController</code>类中定义了这个<code class="du kw kx ky kz b">ToDoItem</code>记录。一个<code class="du kw kx ky kz b">ToDoItem</code>有名字和日期。我本能地使用Java Time中的<code class="du kw kx ky kz b">LocalDate</code>作为日期类型，并希望JavaFX能够神奇地支持这种类型。</p><h1 id="4123" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">添加日期选择器</h1><p id="cb5a" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">JavaFX有一个名为<code class="du kw kx ky kz b">DatePicker</code>的组件，它以我希望的方式工作。我在我的待办事项的<code class="du kw kx ky kz b">TextField</code>旁边添加了<code class="du kw kx ky kz b">DatePicker</code>。</p><pre class="je jf jg jh fd ls kz lt bn lu lv bi"><span id="0403" class="lw ju hi kz b be lx ly l lz ma">&lt;HBox id="HBox1" alignment="CENTER_LEFT" spacing="5.0"&gt;<br/>    &lt;Label text="Item: " /&gt;<br/>    &lt;TextField fx:id="todoItem" /&gt;<br/>    &lt;Label text="Date: " /&gt;<br/>    &lt;DatePicker fx:id="todoDate" /&gt;<br/>&lt;/HBox&gt;</span></pre><p id="2fc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将<code class="du kw kx ky kz b">DatePicker</code>绑定到一个名为<code class="du kw kx ky kz b">todoDate</code>的变量，并将其添加到我的<code class="du kw kx ky kz b">TodoListController</code>中。现在，当我在<code class="du kw kx ky kz b">TodoListController</code>中更改<code class="du kw kx ky kz b">onAddButtonClick</code>代码时，发生了一个惊喜。</p><pre class="je jf jg jh fd ls kz lt bn lu lv bi"><span id="b2c2" class="lw ju hi kz b be lx ly l lz ma">@FXML<br/>protected void onAddButtonClick()<br/>{<br/>    ToDoItem item = new ToDoItem(<br/>        this.todoItem.getText(), <br/>        this.todoDate.getValue());<br/><br/>    this.todoList.getItems().add(item);<br/>}</span></pre><p id="ba7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从<code class="du kw kx ky kz b">DatePicker</code>实例获取日期值的代码返回一个<code class="du kw kx ky kz b">LocalDate</code>！天哪！我没想到会这样，但我感到惊喜。</p><h1 id="5d0f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">将ListView转换为TableView</h1><p id="e5cb" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">从<code class="du kw kx ky kz b">ListView</code>转换到<code class="du kw kx ky kz b">TableView</code>时，我的目标是尽可能多地将UI代码保留在FXML中。我原本以为必须通过编程来做更多的事情，因为我使用Java记录来定义我的<code class="du kw kx ky kz b">ToDoItem</code>类。我认为JavaFX可以更容易地与普通的JavaBean一起工作。我认为在最坏的情况下，我可以在我的<code class="du kw kx ky kz b">ToDoItem</code>记录中添加getter方法。</p><p id="488c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是我在FXML文件中完成的<code class="du kw kx ky kz b">TableView</code>定义。</p><pre class="je jf jg jh fd ls kz lt bn lu lv bi"><span id="b973" class="lw ju hi kz b be lx ly l lz ma">&lt;TableView fx:id="todoList"&gt;<br/>    &lt;columns&gt;<br/>        &lt;TableColumn text="Name" minWidth="75.0" sortable="true"&gt;<br/>            &lt;cellValueFactory&gt;<br/>                &lt;PropertyValueFactory property="name" /&gt;<br/>            &lt;/cellValueFactory&gt;<br/>        &lt;/TableColumn&gt;<br/>        &lt;TableColumn text="Date" minWidth="50.0" sortable="true"&gt;<br/>            &lt;cellValueFactory&gt;<br/>                &lt;PropertyValueFactory property="date" /&gt;<br/>            &lt;/cellValueFactory&gt;<br/>        &lt;/TableColumn&gt;<br/>    &lt;/columns&gt;<br/>&lt;/TableView&gt;</span></pre><p id="3ed3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使用<code class="du kw kx ky kz b">PropertyValueFactory</code>，我不得不在我的<code class="du kw kx ky kz b">ToDoItem</code>记录中添加getter(<code class="du kw kx ky kz b">getName</code>和<code class="du kw kx ky kz b">getDate</code>)。我知道我本可以使用带有<code class="du kw kx ky kz b">setCellValueFactory</code>的lambda，但是这需要我在我的控制器类中放入更多的代码，我还不想这么做。</p><p id="a87f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，正如您在上面的FXML片段中看到的，我能够简单地为两列设置一个名为<code class="du kw kx ky kz b">sortable</code>到<code class="du kw kx ky kz b">true</code>的属性。这使得我的待办事项列表可排序。</p><h1 id="6697" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">到目前为止，一切顺利</h1><p id="46f9" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在我的待办事项应用程序中，没有太多其他需要改变的地方。下面是我的FXML、应用程序和控制器文件的代码。</p><p id="e730" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kw kx ky kz b">todolist-view.xml</code></p><pre class="je jf jg jh fd ls kz lt bn lu lv bi"><span id="7802" class="lw ju hi kz b be lx ly l lz ma">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/><br/>&lt;?import javafx.geometry.Insets?&gt;<br/>&lt;?import javafx.scene.control.Button?&gt;<br/>&lt;?import javafx.scene.control.cell.PropertyValueFactory?&gt;<br/>&lt;?import javafx.scene.control.DatePicker?&gt;<br/>&lt;?import javafx.scene.control.Label?&gt;<br/>&lt;?import javafx.scene.control.TableColumn?&gt;<br/>&lt;?import javafx.scene.control.TableView?&gt;<br/>&lt;?import javafx.scene.control.TextField?&gt;<br/>&lt;?import javafx.scene.layout.HBox?&gt;<br/>&lt;?import javafx.scene.layout.VBox?&gt;<br/>&lt;VBox alignment="CENTER" spacing="20.0" xmlns:fx="http://javafx.com/fxml"<br/>    fx:controller="example.todolist.TodoListController"&gt;<br/>    &lt;padding&gt;<br/>        &lt;Insets bottom="20.0" left="20.0" right="20.0" top="20.0" /&gt;<br/>    &lt;/padding&gt;<br/><br/>    &lt;HBox id="HBox1" alignment="CENTER_LEFT" spacing="5.0"&gt;<br/>        &lt;Label text="Item: " /&gt;<br/>        &lt;TextField fx:id="todoItem" /&gt;<br/>        &lt;Label text="Date: " /&gt;<br/>        &lt;DatePicker fx:id="todoDate" /&gt;<br/>    &lt;/HBox&gt;<br/>    &lt;TableView fx:id="todoList"&gt;<br/>        &lt;columns&gt;<br/>            &lt;TableColumn text="Name" minWidth="75.0" sortable="true"&gt;<br/>                &lt;cellValueFactory&gt;<br/>                    &lt;PropertyValueFactory property="name" /&gt;<br/>                &lt;/cellValueFactory&gt;<br/>            &lt;/TableColumn&gt;<br/>            &lt;TableColumn text="Date" minWidth="50.0" sortable="true"&gt;<br/>                &lt;cellValueFactory&gt;<br/>                    &lt;PropertyValueFactory property="date" /&gt;<br/>                &lt;/cellValueFactory&gt;<br/>            &lt;/TableColumn&gt;<br/>        &lt;/columns&gt;<br/>    &lt;/TableView&gt;<br/>    &lt;HBox id="HBox2" alignment="CENTER" spacing="5.0"&gt;<br/>        &lt;Button text="Add" onAction="#onAddButtonClick" alignment="BOTTOM_LEFT" /&gt;<br/>        &lt;Button text="Remove" onAction="#onRemoveButtonClick" alignment="BOTTOM_RIGHT" /&gt;<br/>    &lt;/HBox&gt;<br/>&lt;/VBox&gt;</span></pre><p id="8811" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kw kx ky kz b">TodoListApplication</code>阶级</p><pre class="je jf jg jh fd ls kz lt bn lu lv bi"><span id="031d" class="lw ju hi kz b be lx ly l lz ma">package example.todolist;<br/><br/>import javafx.application.Application;<br/>import javafx.fxml.FXMLLoader;<br/>import javafx.scene.Scene;<br/>import javafx.stage.Stage;<br/><br/>import java.io.IOException;<br/><br/>public class TodoListApplication extends Application<br/>{<br/>    @Override<br/>    public void start(Stage stage) throws IOException<br/>    {<br/>        FXMLLoader fxmlLoader = new FXMLLoader(<br/>                TodoListApplication.class.getResource("todolist-view.fxml"));<br/>        Scene scene = new Scene(fxmlLoader.load(), 640, 480);<br/>        stage.setTitle("Todo List");<br/>        stage.setScene(scene);<br/>        stage.show();<br/>    }<br/><br/>    public static void main(String[] args)<br/>    {<br/>        TodoListApplication.launch();<br/>    }<br/>}</span></pre><p id="9bf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kw kx ky kz b">TodoListController</code>类</p><pre class="je jf jg jh fd ls kz lt bn lu lv bi"><span id="0e27" class="lw ju hi kz b be lx ly l lz ma">package example.todolist;<br/><br/>import java.time.LocalDate;<br/><br/>import javafx.collections.FXCollections;<br/>import javafx.collections.ObservableList;<br/>import javafx.fxml.FXML;<br/>import javafx.scene.control.DatePicker;<br/>import javafx.scene.control.TableView;<br/>import javafx.scene.control.TextField;<br/>import org.eclipse.collections.api.factory.Lists;<br/>import org.eclipse.collections.api.list.MutableList;<br/><br/>public class TodoListController<br/>{<br/>    @FXML<br/>    private TextField todoItem;<br/><br/>    @FXML<br/>    private DatePicker todoDate;<br/><br/>    @FXML<br/>    private TableView&lt;ToDoItem&gt; todoList;<br/><br/>    @FXML<br/>    protected void initialize()<br/>    {<br/>        this.todoList.setColumnResizePolicy(TableView.CONSTRAINED_RESIZE_POLICY);<br/>        MutableList&lt;ToDoItem&gt; items = Lists.mutable.empty();<br/>        ObservableList&lt;ToDoItem&gt; list = FXCollections.observableList(items);<br/>        this.todoList.setItems(list);<br/>    }<br/><br/>    @FXML<br/>    protected void onAddButtonClick()<br/>    {<br/>        ToDoItem item = new ToDoItem(<br/>                this.todoItem.getText(),<br/>                this.todoDate.getValue());<br/><br/>        this.todoList.getItems().add(item);<br/>    }<br/><br/>    @FXML<br/>    protected void onRemoveButtonClick()<br/>    {<br/>        int indexToRemove = this.todoList.getSelectionModel().getSelectedIndex();<br/>        this.todoList.getItems().remove(indexToRemove);<br/>    }<br/><br/>    public record ToDoItem(String name, LocalDate date) {<br/><br/>        public String getName()<br/>        {<br/>            return this.name;<br/>        }<br/>        public String getDate()<br/>        {<br/>            return this.date.toString();<br/>        }<br/>    }<br/>}</span></pre><h1 id="b685" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">后续步骤</h1><p id="06ca" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我的下一步将是使我的待办事项列表持久化。我可能会看看是否可以使用<a class="ae mb" href="https://github.com/FasterXML/jackson-datatypes-collections" rel="noopener ugc nofollow" target="_blank"> Jackson对Eclipse集合的支持</a>来写出和读入ToDo列表中的数据。我使用了来自<a class="ae mb" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> Eclipse集合</a>的<code class="du kw kx ky kz b">MutableList</code>，并使用名为<code class="du kw kx ky kz b">FXCollections</code>的JavaFX实用程序类将其包装在一个<code class="du kw kx ky kz b">ObservableList</code>中。如果我不在ToDo List应用程序中使用Eclipse集合，我就不会是一个Eclipse集合的拥护者。😀</p><p id="5321" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读！</p><p id="d261" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mc">我是</em><a class="ae mb" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"><em class="mc">Eclipse Collections</em></a><em class="mc">OSS项目的创建者和提交者，该项目由</em><a class="ae mb" href="https://projects.eclipse.org/projects/technology.collections" rel="noopener ugc nofollow" target="_blank"><em class="mc">Eclipse Foundation</em></a><em class="mc">管理。Eclipse Collections为</em> <a class="ae mb" href="https://github.com/eclipse/eclipse-collections/blob/master/CONTRIBUTING.md" rel="noopener ugc nofollow" target="_blank"> <em class="mc">投稿</em> </a> <em class="mc">开放。</em></p></div></div>    
</body>
</html>