<html>
<head>
<title>Generate API client with OpenApi codegen</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用OpenApi codegen生成API客户端</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/generate-api-client-with-openapi-codegen-763e3f2f8703?source=collection_archive---------0-----------------------#2021-10-08">https://medium.com/javarevisited/generate-api-client-with-openapi-codegen-763e3f2f8703?source=collection_archive---------0-----------------------#2021-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="4250" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在银河系中追踪绝地</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/24da2552a978d2b9be750eb22bd191b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q5BlTDkba1NHrGOO.jpg"/></div></div></figure><p id="b5e3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">许多API都是使用<a class="ae kf" href="https://swagger.io/" rel="noopener ugc nofollow" target="_blank"> Swagger </a>编写的，这对我们开发人员来说是一件好事，有助于理解它们如何工作以及如何调用它们。<br/>在这篇文章中，我将尽力帮助你使用这些文档来生成一个调用这些API的客户端。</p></div><div class="ab cl kg kh gp ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hb hc hd he hf"><h1 id="d1e1" class="kn ko hi bd kp kq kr ks kt ku kv kw kx io ky ip kz ir la is lb iu lc iv ld le bi translated">你需要什么</h1><p id="1b9d" class="pw-post-body-paragraph jj jk hi jl b jm lf ij jo jp lg im jr js lh ju jv jw li jy jz ka lj kc kd ke hb bi translated">为了遵循本教程，您将需要一个<a class="ae kf" rel="noopener" href="/javarevisited/top-5-books-and-courses-to-learn-restful-web-services-in-java-using-spring-mvc-and-spring-boot-79ec4b351d12?source=---------17------------------"> REST API </a>，因此您可以:</p><ul class=""><li id="fcc0" class="lk ll hi jl b jm jn jp jq js lm jw ln ka lo ke lp lq lr ls bi translated">按照那些<a class="ae kf" rel="noopener" href="/javarevisited/building-a-simple-rest-api-with-springboot-3f2e4b123ebb">教程来构建你的API </a>，<a class="ae kf" rel="noopener" href="/javarevisited/documenting-your-api-with-swagger-c27a94104135">一个来文档化它</a>，然后<a class="ae kf" rel="noopener" href="/javarevisited/migration-from-swagger-2-to-openapi-3-391f3e97da73">迁移到openApi </a></li><li id="bb73" class="lk ll hi jl b jm lt jp lu js lv jw lw ka lx ke lp lq lr ls bi translated">用openApi 2准备好另一个API文档</li></ul><h1 id="8df4" class="kn ko hi bd kp kq ly ks kt ku lz kw kx io ma ip kz ir mb is lb iu mc iv ld le bi translated">步骤1:导入api json文档</h1><p id="7299" class="pw-post-body-paragraph jj jk hi jl b jm lf ij jo jp lg im jr js lh ju jv jw li jy jz ka lj kc kd ke hb bi translated">本教程最简单的部分是导入您希望第一个调用的api的json文档，并将其放在ressource文件夹中。<br/>在我的例子中，我将使用我的克隆API，我已经创建了一个jedi API，所以为了让我的克隆取回Jedi，我将导入Jedi文档文件，然后生成它的客户端</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es md"><img src="../Images/aefac57c9ab535020ba3c1fe1a8f21f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*YsvtAE7hc5lkjajZ5VQJ5g.png"/></div></figure><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="me mf l"/></div></figure><h1 id="dc5f" class="kn ko hi bd kp kq ly ks kt ku lz kw kx io ma ip kz ir mb is lb iu mc iv ld le bi translated">步骤2:更新pom.xml</h1><p id="8601" class="pw-post-body-paragraph jj jk hi jl b jm lf ij jo jp lg im jr js lh ju jv jw li jy jz ka lj kc kd ke hb bi translated">为了生成客户端，我们将使用<a class="ae kf" href="https://github.com/OpenAPITools/openapi-generator" rel="noopener ugc nofollow" target="_blank"> openApi codegen maven插件</a>。</p><p id="fd07" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为此，我们需要更新pom.xml的构建部分并添加插件。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="0573" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">让我们看看这里有什么:</p><ul class=""><li id="8648" class="lk ll hi jl b jm jn jp jq js lm jw ln ka lo ke lp lq lr ls bi translated">目标generate告诉我们，客户端将在我们构建的… generate阶段生成，或者可以使用maven命令<em class="mg"> mvn generate生成。</em></li></ul><p id="4f52" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">该配置将包含一些用于定制生成的客户端的选项，如:</p><ul class=""><li id="c059" class="lk ll hi jl b jm jn jp jq js lm jw ln ka lo ke lp lq lr ls bi translated">inputSpec告诉插件在哪里可以找到导入的文件</li><li id="b30a" class="lk ll hi jl b jm lt jp lu js lv jw lw ka lx ke lp lq lr ls bi translated">案例的generatorName</li><li id="0369" class="lk ll hi jl b jm lt jp lu js lv jw lw ka lx ke lp lq lr ls bi translated">sourceFolder将是我的客户端将在我的ressource文件夹中生成的位置</li></ul><p id="2417" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">您可以添加更多选项，我建议您阅读项目的<a class="ae kf" href="https://github.com/OpenAPITools/openapi-generator/blob/master/modules/openapi-generator-maven-plugin/README.md" rel="noopener ugc nofollow" target="_blank"> README.md </a>以更好地了解可能的选项，并选择适合您情况的选项。</p><h1 id="1bac" class="kn ko hi bd kp kq ly ks kt ku lz kw kx io ma ip kz ir mb is lb iu mc iv ld le bi translated">步骤3:启动构建</h1><p id="a246" class="pw-post-body-paragraph jj jk hi jl b jm lf ij jo jp lg im jr js lh ju jv jw li jy jz ka lj kc kd ke hb bi translated">现在我们已经实现了插件用法，让我们转到<em class="mg">全新安装</em>我们的项目。如果一切顺利，你的目标文件夹中应该有这样的内容:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/aadbf39133e44810dd23165b3ee45c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PU1b0_CtnQpDqHGEuk5JXA.png"/></div></div></figure><p id="3b0d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如您所见，在pluggin配置中描述的路径上，我有我的控制器jediControllerApi，它使用ApiClient调用jedi API和我的文档中描述的模型Jedi。</p><p id="a593" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">有了它，我可以在我的项目中直接使用这个对象，而不必创建自己的对象，然后进行一些映射。</p><h1 id="f1e8" class="kn ko hi bd kp kq ly ks kt ku lz kw kx io ma ip kz ir mb is lb iu mc iv ld le bi translated">步骤4:浏览生成的文件</h1><p id="b7d3" class="pw-post-body-paragraph jj jk hi jl b jm lf ij jo jp lg im jr js lh ju jv jw li jy jz ka lj kc kd ke hb bi translated">如果您已经仔细阅读了步骤1，在我的文档文件中，服务器url是我使用端口8082的本地主机，所以在我的ApiClient中我也有一个字段(basepath)包含这个值</p><pre class="iy iz ja jb fd mi mj mk ml aw mm bi"><span id="2540" class="mn ko hi mj b fi mo mp l mq mr">private String basePath = “http://localhost:8082";</span></pre><p id="a99e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">默认情况下，生成的客户端将使用Okhttp进行api调用，因此您可能需要向pom.xml添加更多的依赖项，以便运行您的应用程序。</p><h1 id="2a30" class="kn ko hi bd kp kq ly ks kt ku lz kw kx io ma ip kz ir mb is lb iu mc iv ld le bi translated">步骤5:使用客户端</h1><p id="a060" class="pw-post-body-paragraph jj jk hi jl b jm lf ij jo jp lg im jr js lh ju jv jw li jy jz ka lj kc kd ke hb bi translated">既然我们已经一路走过了客户端的生成，那么使用它将是最好的，你不这样认为吗？这里没什么难的，只需声明你生成的控制器并调用它来达到第二个API</p><pre class="iy iz ja jb fd mi mj mk ml aw mm bi"><span id="6231" class="mn ko hi mj b fi mo mp l mq mr">JediControllerApi jediControllerApi = <strong class="mj hj">new </strong>JediControllerApi();<br/><strong class="mj hj">return </strong>jediControllerApi.getAllJedi();</span></pre></div><div class="ab cl kg kh gp ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hb hc hd he hf"><p id="436c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">感谢您的阅读，和以前一样，本教程中使用的代码可以在<a class="ae kf" href="https://github.com/ErwanLT/HumanCloningFacilities" rel="noopener ugc nofollow" target="_blank">这个Github库</a>的分支openApiCodeGen中找到。</p></div></div>    
</body>
</html>