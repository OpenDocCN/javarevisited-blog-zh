<html>
<head>
<title>Exception Handling in Eclipse Collections</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Eclipse集合中的异常处理</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/exception-handling-in-eclipse-collections-9e37a68fc6a9?source=collection_archive---------1-----------------------#2020-09-17">https://medium.com/javarevisited/exception-handling-in-eclipse-collections-9e37a68fc6a9?source=collection_archive---------1-----------------------#2020-09-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ca44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Java 8之前和之后处理<a class="ae jd" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> Eclipse集合</a>中异常的一些策略</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/9dc651a50a9e727c274be6c77634b691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQd876my5P5hED-Ay9SRag.jpeg"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">用迭代模式和lambdas处理检查过的异常可能感觉像在冰上行走</p></figure><h1 id="8c03" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">这篇文章的灵感来源</h1><p id="809f" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">Brian Vermeer写了一篇关于Java流中异常处理的博客。</p><div class="kz la ez fb lb lc"><a href="https://dev.to/brianverm/exception-handling-in-java-streams-2mjh" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab dw"><div class="le ab lf cl cj lg"><h2 class="bd hj fi z dy lh ea eb li ed ef hh bi translated">Java流中的异常处理</h2><div class="lj l"><h3 class="bd b fi z dy lh ea eb li ed ef dx translated">自版本8以来，流API和lambda是Java的一大改进。从那时起，我们可以和…</h3></div><div class="lk l"><p class="bd b fp z dy lh ea eb li ed ef dx translated">开发到</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq jo lc"/></div></div></a></div><p id="1ba8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章让我想起了几年来我们在<a class="ae jd" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> Eclipse集合</a>中对异常处理的支持。我想我会展示一些在Java 8之前和之后使用Eclipse集合处理检查异常的简单例子。我还将展示将与<a class="ae jd" rel="noopener" href="/javarevisited/7-best-java-tutorials-and-books-to-learn-lambda-expression-and-stream-api-and-other-features-3083e6038e14"> Java流</a>一起工作的例子。</p><h1 id="db98" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">可靠的附件</h1><p id="e4df" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">Java里有个接口叫<code class="du lr ls lt lu b">Appendable</code>。<code class="du lr ls lt lu b">Appendable</code>是<code class="du lr ls lt lu b">StringBuilder</code>、<code class="du lr ls lt lu b">StringBuffer</code>、<code class="du lr ls lt lu b">PrintStream</code>等几个类的父接口。这个接口从Java 5开始就存在了。它定义了一个方法<code class="du lr ls lt lu b">append</code>，如下所示:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/c6655a9059f55671dc14bb1e594ab97b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P-XpHDRslrkrCdsFRpI0kA.png"/></div></div></figure><p id="314f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我创建了一个<code class="du lr ls lt lu b">String</code>的<code class="du lr ls lt lu b">MutableList</code>，并试图使用<code class="du lr ls lt lu b">append</code>作为<code class="du lr ls lt lu b">forEach</code>方法的方法引用，我的IDE会给我一个警告，说有一个未处理的异常:<code class="du lr ls lt lu b">java.io.IOException</code>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lw"><img src="../Images/77a1942ba293f98e6e8f7c0593a0acb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OWzuxQegtqJbSQIPKbp9dg.png"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">未处理的异常:<code class="du lr ls lt lu b">java.io.IOException</code></p></figure><p id="3cfa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实证明，<code class="du lr ls lt lu b">StringBuilder</code>并没有在<code class="du lr ls lt lu b">append</code>方法的方法签名中抛出一个<code class="du lr ls lt lu b">java.io.IOException</code>。所以如果我把类型改成<code class="du lr ls lt lu b">StringBuilder</code>，异常就会消失。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lx"><img src="../Images/6e63344c912647c003892deeabfbe01d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D9AUogMJXiusU9260QFv1g.png"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">StringBuilder accept方法不会抛出<code class="du lr ls lt lu b">java.io.IOException</code></p></figure><p id="e6b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我将代码改为使用<code class="du lr ls lt lu b">StringBuffer</code>，情况也是如此。然而，所有处理文件的<code class="du lr ls lt lu b">Appendable</code>实现很可能会抛出异常。因此，如果我使用接口，而不是具体的实现，我将不得不处理异常。Java 8 之前处理异常<strong class="ih hj">的丑陋方式可能如下所示。</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ly"><img src="../Images/c95f3883b423c752b9412d7bd63c4e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MspVJ_iLw9KZDFEmTe13Dw.png"/></div></div></figure><p id="46ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一种常见的模式，捕捉一个被检查的异常并抛出一个<code class="du lr ls lt lu b">RuntimeException</code>。在Java 8之前，我们经常在Eclipse集合中拥有不同功能接口的特定“检查”版本。每个函数接口包(函数、谓词、过程)中都有一个名为“checked”的包。使用<code class="du lr ls lt lu b"><a class="ae jd" href="https://www.eclipse.org/collections/javadoc/10.4.0/org/eclipse/collections/impl/block/procedure/checked/CheckedProcedure.html" rel="noopener ugc nofollow" target="_blank">CheckedProcedure</a></code>，我们可以将代码简化如下:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/b303f861f5e4707577e926be3345ce2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkm_easz_NcOoYl59ApjAA.png"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">Java 8之前如何处理检查异常</p></figure><p id="0492" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果<code class="du lr ls lt lu b">Appendable</code>抛出异常，异常将被捕获，如果是<code class="du lr ls lt lu b">RuntimeException</code>，异常将被冒泡。如果是已检查的异常，将创建一个<code class="du lr ls lt lu b">RuntimeException</code>并抛出，将已检查的异常设置为原因。</p><p id="1793" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Java 8之后，我们引入了新的接口来处理检查异常。对于每种功能接口类型(<code class="du lr ls lt lu b">Function</code>、<code class="du lr ls lt lu b">Predicate</code>、<code class="du lr ls lt lu b">Procedure</code>)，都有相应的“投掷”类型(<code class="du lr ls lt lu b"><a class="ae jd" href="https://www.eclipse.org/collections/javadoc/10.4.0/org/eclipse/collections/impl/block/function/checked/ThrowingFunction.html" rel="noopener ugc nofollow" target="_blank">ThrowingFunction</a></code>、<code class="du lr ls lt lu b"><a class="ae jd" href="https://www.eclipse.org/collections/javadoc/10.4.0/org/eclipse/collections/impl/block/predicate/checked/ThrowingPredicate.html" rel="noopener ugc nofollow" target="_blank">ThrowingPredicate</a></code>、<code class="du lr ls lt lu b"><a class="ae jd" href="https://www.eclipse.org/collections/javadoc/10.4.0/org/eclipse/collections/impl/block/procedure/checked/ThrowingProcedure.html" rel="noopener ugc nofollow" target="_blank">ThrowingProcedure</a></code>)。功能接口在工厂上也有相应的方法(<code class="du lr ls lt lu b"><a class="ae jd" href="https://www.eclipse.org/collections/javadoc/10.4.0/org/eclipse/collections/impl/block/factory/Functions.html#throwing(org.eclipse.collections.impl.block.function.checked.ThrowingFunction)" rel="noopener ugc nofollow" target="_blank">Functions.throwing</a></code>、<code class="du lr ls lt lu b"><a class="ae jd" href="https://www.eclipse.org/collections/javadoc/10.4.0/org/eclipse/collections/impl/block/factory/Predicates.html#throwing(org.eclipse.collections.impl.block.predicate.checked.ThrowingPredicate)" rel="noopener ugc nofollow" target="_blank">Predicates.throwing</a></code>、<code class="du lr ls lt lu b"><a class="ae jd" href="https://www.eclipse.org/collections/javadoc/10.4.0/org/eclipse/collections/impl/block/factory/Procedures.html#throwing(org.eclipse.collections.impl.block.procedure.checked.ThrowingProcedure)" rel="noopener ugc nofollow" target="_blank">Procedures.throwing</a></code>)。将这些特性与Java 8或更高版本结合使用，我们现在可以编写以下代码:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ma"><img src="../Images/5ba822c84ea668690153e656d1a2d106.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w-ugred-W9RA1WqXjceVAQ.png"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">用Java 8或更高版本处理检查异常</p></figure><p id="9e7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您也可以对<a class="ae jd" href="https://javarevisited.blogspot.com/2020/04/top-5-courses-to-learn-java-collections-and-streams.html#axzz6XMFoMrEo" rel="noopener ugc nofollow" target="_blank"> Java集合</a>和<a class="ae jd" href="https://javarevisited.blogspot.com/2018/08/top-5-java-8-courses-to-learn-online.html" rel="noopener ugc nofollow" target="_blank"> Java流</a>使用相同的方法。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mb"><img src="../Images/a20259c4b0a6a8f0735a6eaff965d4ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3H0kT_NrTDgOu6PutPdeQ.png"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">在接受消费者的Iterable上使用Java 8+ forEach方法</p></figure><p id="4b2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这段代码有效，因为Eclipse集合中的<code class="du lr ls lt lu b">Procedure</code>接口扩展了<code class="du lr ls lt lu b">Consumer</code>接口。代码也可以作为<code class="du lr ls lt lu b">Stream</code>使用。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mc"><img src="../Images/f26dc6c527e26be15a1e3aa0df31daa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZ4vpSKI1Tm-2dH7HK04LQ.png"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">使用流forEach，它也接受消费者</p></figure><h1 id="d860" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">抛出自己的运行时异常</h1><p id="1878" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">如果您想要控制抛出的RuntimeException的类型，有一个重载版本的抛出方法支持这一点。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es md"><img src="../Images/8719cef6c71fe50395d491be75205bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xpFexOQP8YHhWqjo9WSJCg.png"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">Function2接受当前元素、捕获的异常和要重新抛出的RuntimeException类型</p></figure><p id="1818" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我想重新抛出一个<code class="du lr ls lt lu b">UndependableAppendableException</code>，以防<code class="du lr ls lt lu b">IOException</code>在调用<code class="du lr ls lt lu b">append</code>时被捕获。代码可能如下所示:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://www.java67.com/2018/10/java-8-stream-and-functional-programming-interview-questions-answers.html"><div class="er es me"><img src="../Images/95a9dbbe38fda11a757a0aa308bfd7ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m9jaAWGPmrstZIveW1bsrg.png"/></div></a><p class="jq jr et er es js jt bd b be z dx translated">UndependableAppendableException构造函数与抛出</p></figure><p id="ce2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，我在这里保留了使用Java Stream的代码。对Eclipse集合中的<code class="du lr ls lt lu b">List</code>或<code class="du lr ls lt lu b">MutableList</code>使用<code class="du lr ls lt lu b">forEach</code>也是一样。</p><h1 id="2736" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">但是等等，关于…</h1><p id="82f9" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">这是Eclipse集合中现有的异常处理功能。如果您想要额外的功能，可以考虑提交请求特性的问题，或者通过对Eclipse集合项目的pull请求做出贡献。我们欢迎Eclipse集合的新贡献者。查看下面的博客，了解更多关于如何开始的信息。</p><div class="kz la ez fb lb lc"><a rel="noopener follow" target="_blank" href="/@donraab/help-wanted-b1acf25d8c8d"><div class="ld ab dw"><div class="le ab lf cl cj lg"><h2 class="bd hj fi z dy lh ea eb li ed ef hh bi translated">寻求帮助！</h2><div class="lj l"><h3 class="bd b fi z dy lh ea eb li ed ef dx translated">嘘！我要告诉你一个秘密。对于一些人来说，这可能只是改变他们的软件…</h3></div><div class="lk l"><p class="bd b fp z dy lh ea eb li ed ef dx translated">medium.com</p></div></div><div class="ll l"><div class="mf l ln lo lp ll lq jo lc"/></div></div></a></div><p id="d29c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mg">我是</em><a class="ae jd" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"><em class="mg">Eclipse Collections</em></a><em class="mg">OSS项目在</em><a class="ae jd" href="https://projects.eclipse.org/projects/technology.collections" rel="noopener ugc nofollow" target="_blank"><em class="mg">Eclipse Foundation</em></a><em class="mg">的项目负责人和提交人。</em> <a class="ae jd" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> <em class="mg">月食收藏</em> </a> <em class="mg">为</em> <a class="ae jd" href="https://github.com/eclipse/eclipse-collections/blob/master/CONTRIBUTING.md" rel="noopener ugc nofollow" target="_blank"> <em class="mg">投稿</em> </a> <em class="mg">。如果你喜欢这个库，你可以在GitHub上让我们知道。</em></p></div></div>    
</body>
</html>