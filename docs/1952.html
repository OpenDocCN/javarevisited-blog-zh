<html>
<head>
<title>Just Don’t Return null!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">只是不要返回null！</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/just-dont-return-null-dcdf5d77128f?source=collection_archive---------2-----------------------#2022-02-15">https://medium.com/javarevisited/just-dont-return-null-dcdf5d77128f?source=collection_archive---------2-----------------------#2022-02-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2013/05/ava-tips-and-best-practices-to-avoid-nullpointerexception-program-application.html#axzz6Kgpx2OGT"><div class="er es if"><img src="../Images/c0de32a6bb018d093ea1dc7531fb6c7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NcQYqA2p-p9kL8sa"/></div></a></figure><p id="3776" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在我的文章避免<a class="ae jk" rel="noopener" href="/javarevisited/avoid-verbose-null-checks-b3f11afbfcc9"> <em class="jl">显式空值检查</em> </a> <em class="jl"> </em>中，我谈到了处理<em class="jl">空值</em>的替代方法，这种方法不涉及显式执行<em class="jl">空值</em>检查。</p><p id="d2d0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">写完那篇文章后，我仍然觉得我需要更多地强调说明，如果我们不返回空值，那么这些方法都是不必要的！首先。返回null是一个问题的诱因，它只是在调用代码中丢失了一个null检查，混乱就发生了。</p><p id="41c1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你的代码产生一个空值，我们需要以某种方式抑制它，而不是返回它。对此我们可以做一些事情，我们需要习惯于应用这些选项中的一个，因为如果我们不这样做，那么处理那个<em class="jl"> null </em>将成为调用者的责任。</p><blockquote class="jm jn jo"><p id="d6ea" class="im in jl io b ip iq ir is it iu iv iw jp iy iz ja jq jc jd je jr jg jh ji jj hb bi translated">返回null是一种懒惰的坏习惯，会给应用程序增加不必要的风险。</p></blockquote><p id="79b6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们来看看一些代码。</p><figure class="js jt ju jv fd ij"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="354a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在上面的例子中，在对可用性进行一些检查之后，一个商品被标记为已售，然后被退回。该方法使用了<em class="jl">项目</em>返回类型，这意味着即使项目不可用也需要返回一些东西。返回一个空引用很有诱惑力，但是这可能会给调用者带来问题。如果调用者(或多个调用者)未能执行<a class="ae jk" href="https://javarevisited.blogspot.com/2016/01/how-to-check-if-string-is-not-null-and-empty-in-java-example.html" rel="noopener ugc nofollow" target="_blank"> <em class="jl"> null </em>检查</a>，那么如果使用了来自item对象的某个值，可能会导致抛出<a class="ae jk" href="https://www.java67.com/2021/05/how-to-solve-nullpointerexception-in-java.html" rel="noopener ugc nofollow" target="_blank"><em class="jl">NullPointerException</em></a>。或者更糟的是，<em class="jl"> null </em>项可能会被进一步发送到最终用户或其他系统，并造成大量损害。</p><p id="314d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们看看我们能做些什么，而不是返回空值。</p><p id="f09b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">抛出异常我们可以抛出一个运行时异常。可能是一个名为<em class="jl">可用性异常</em>的自定义异常，包含一个<em class="jl">信息</em>日志消息</p><figure class="js jt ju jv fd ij"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="e753" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">甚至不需要自定义异常，我们可以只使用一个<em class="jl"> IllegalArgumentException。抛出一个异常比返回<em class="jl"> null要好。</em>也许有人会认为使用<a class="ae jk" href="https://javarevisited.blogspot.com/2013/06/10-java-exception-and-error-interview-questions-answers-programming.html#axzz6kGEVKsf7" rel="noopener ugc nofollow" target="_blank">异常</a>来控制正常的业务流程不是一个好的做法。好吧，很公平，我同意。然后让我们看看我们还能做些什么。</em></p><p id="a8ae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">返回一个“特例”对象<br/> </strong>特例对象是我们返回的东西，而不是返回<em class="jl"> null。</em>有一种模式叫做<em class="jl"> null </em> value object，我已经在另一篇文章中<a class="ae jk" rel="noopener" href="/javarevisited/avoid-verbose-null-checks-b3f11afbfcc9">解释过了，所以我不打算在这里再解释了，取而代之的是，我将使用</a><a class="ae jk" href="https://javarevisited.blogspot.com/2017/04/10-examples-of-optional-in-java-8.html" rel="noopener ugc nofollow" target="_blank">Java 8<em class="jl">optional . empty()</em></a>，它只是Java对该模式的实现。</p><figure class="js jt ju jv fd ij"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="87db" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用<em class="jl"> Optional.empty() </em>是一个特例对象，它将保护调用者免受<a class="ae jk" href="https://javarevisited.blogspot.com/2012/06/common-cause-of-javalangnullpointerexce.html" rel="noopener ugc nofollow" target="_blank"><em class="jl">NullPointerException</em></a>的影响。是我最喜欢的方法，而不是返回空值，我个人经常使用。</p><p id="6323" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">类似特例对象的另一个常见例子是<em class="jl">collections . empty List()</em>，它将返回一个<a class="ae jk" href="https://javarevisited.blogspot.com/2014/07/java-optimization-empty-arraylist-and-Hashmap-cost-less-memory-jdk-17040-update.html" rel="noopener ugc nofollow" target="_blank">空的<em class="jl">列表</em> </a>，这在类似的情况下非常有用，我们不想返回<em class="jl">空的</em>，但是需要一个<em class="jl">列表</em>。</p><p id="b065" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">不幸的是，有很多很多开发者认为，仅仅因为Java允许<em class="jl"> null </em>，就可以返回它。但是从干净编码和软件工艺的角度来看，我们需要承担责任，不要让null 离开我们编写的方法。也许最好是我们一起停止使用空引用。</p><figure class="js jt ju jv fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2017/12/top-5-android-online-training-courses-for-Java-developers.html"><div class="er es jy"><img src="../Images/6066e5e6bec06f28bdd9b99b37c3f596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8ZF7MrWLyw93avld.jpg"/></div></a></figure><p id="d6bd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我希望你喜欢这篇文章，如果你喜欢，请鼓掌👏和/或在社交媒体上与朋友分享。</p></div></div>    
</body>
</html>