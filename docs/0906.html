<html>
<head>
<title>Solve the Best Time to Buy and Sell Stock Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决买卖股票的最佳时机问题</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/solve-the-best-time-to-buy-and-sell-stock-problem-8ab9c9ff895e?source=collection_archive---------3-----------------------#2021-01-08">https://medium.com/javarevisited/solve-the-best-time-to-buy-and-sell-stock-problem-8ab9c9ff895e?source=collection_archive---------3-----------------------#2021-01-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ccccc77c868c83fb6c1244704310ccee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CjKwAPJeE4ZWteGnth0tCA.jpeg"/></div></div><p class="iq ir et er es is it bd b be z dx translated">图片由<a class="ae iu" href="https://www.freepik.com/free-photo/capital-tablet-exchange-screen-skyscraper_1088871.htm#page=1&amp;query=stock&amp;position=5" rel="noopener ugc nofollow" target="_blank"> FreePik </a></p></figure><h1 id="30ff" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">1.问题陈述</h1><p id="95ee" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">给你一个价格的整数数组，其中prices[i]是给定股票在第I天的价格。设计一个算法，求最大利润。</p><p id="05ba" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">一些限制如下:</p><ul class=""><li id="73c3" class="kw kx hi jv b jw kr ka ks ke ky ki kz km la kq lb lc ld le bi translated">您最多可以完成k笔交易。</li><li id="ab8c" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">您不得同时进行多项交易(即，您必须先卖出股票，然后才能再次买入)。</li></ul><p id="14c9" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">示例1:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="e2e6" class="lt iw hi lp b fi lu lv l lw lx">Input: k = 2, prices = [2,4,1]<br/>Output: 2<br/>Explanation: Buy on day 1 (price = 2) and sell on day 2 (price = 4), profit = 4-2 = 2.</span></pre><p id="17c1" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">示例2:</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="4f3c" class="lt iw hi lp b fi lu lv l lw lx">Input: k = 2, prices = [3,2,6,5,0,3]<br/>Output: 7<br/>Explanation: Buy on day 2 (price = 2) and sell on day 3 (price = 6), profit = 6-2 = 4. Then buy on day 5 (price = 0) and sell on day 6 (price = 3), profit = 3-0 = 3.</span></pre><h1 id="e57e" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">2.解决办法</h1><p id="80bf" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">问题是找出你在某段时间内，对一只股票能获得的最大利润。</p><h2 id="0cd9" class="lt iw hi bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">州</h2><p id="f80d" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">一只股票一天有两种状态(I):</p><blockquote class="ml mm mn"><p id="8b1d" class="jt ju mo jv b jw kr jy jz ka ks kc kd mp kt kg kh mq ku kk kl mr kv ko kp kq hb bi translated">买入:<br/> *股票的最后一个交易动作是买入。<br/> *该<strong class="jv hj">发起</strong>一笔交易，冲高交易数。</p><p id="13ed" class="jt ju mo jv b jw kr jy jz ka ks kc kd mp kt kg kh mq ku kk kl mr kv ko kp kq hb bi translated">卖出:<br/> *股票的最后一个交易动作是卖出。<br/> *此<strong class="jv hj">关闭</strong>交易。</p></blockquote><h2 id="1105" class="lt iw hi bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">行动</h2><p id="6693" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">因此，你可以在第一天采取3种可能的行动:</p><blockquote class="ml mm mn"><p id="b713" class="jt ju mo jv b jw kr jy jz ka ks kc kd mp kt kg kh mq ku kk kl mr kv ko kp kq hb bi translated">行动1。如果前一天没有买入，就买入股票。<br/>动作二。如果前一天有买入，卖出股票。<br/>动作3。什么都不做。</p></blockquote><h2 id="be0f" class="lt iw hi bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">状态和操作</h2><p id="3e34" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们把上面的重新整理成动作和状态。<br/>目标是计算最大利润，同时确保当天的状态(买入或卖出)不变，并且没有交易重叠。</p><blockquote class="ml mm mn"><p id="2155" class="jt ju mo jv b jw kr jy jz ka ks kc kd mp kt kg kh mq ku kk kl mr kv ko kp kq hb bi translated">第(I)天|买入:<br/> *操作1:什么都不做=从第(i-1)天的买入状态保持盈利<br/>或<br/> *操作2:从第(i-1)天的卖出状态买入盈利的股票<br/>【确保在启动另一笔交易之前完成前一笔交易】</p><p id="41cc" class="jt ju mo jv b jw kr jy jz ka ks kc kd mp kt kg kh mq ku kk kl mr kv ko kp kq hb bi translated">第(I)天|卖出:<br/> *动作1:什么都不做=在第(i-1)天保持卖出状态的利润<br/>或<br/> *动作2:卖出股票并增加第(i-1)天买入状态的利润<br/>【卖出之前买入的股票】</p></blockquote><h2 id="91c5" class="lt iw hi bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">状态&amp;动作&amp;交易</h2><p id="d5b5" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">现在让我们添加事务计数约束。<br/>目标是计算最大利润，同时确保状态(买入或卖出)在当天保持不变，没有交易重叠，并且交易计数在限制范围内。</p><blockquote class="ml mm mn"><p id="2ba6" class="jt ju mo jv b jw kr jy jz ka ks kc kd mp kt kg kh mq ku kk kl mr kv ko kp kq hb bi translated">Day(I)|<strong class="jv hj">Transaction(t)</strong>| Buy:<br/>* Action 1:什么都不做=从第(i-1)天的买入状态获利&amp;<strong class="jv hj">Transaction(t)</strong><br/>或<br/> * Action 2:从第(i-1)天的卖出状态获利买入股票&amp;<br/><strong class="jv hj">Transaction(t-1)</strong><br/>【确保在开始另一笔交易和<strong class="jv hj">进行买入之前先完成前一笔交易</strong></p><p id="cab2" class="jt ju mo jv b jw kr jy jz ka ks kc kd mp kt kg kh mq ku kk kl mr kv ko kp kq hb bi translated">日(i) | <strong class="jv hj">交易(t) </strong> |卖出:<br/> *动作1:什么都不做=从日(i-1) &amp; <strong class="jv hj">的卖出状态中获利交易(t) </strong> <br/>或<br/> *动作2:卖出股票并从日(i-1) &amp; <strong class="jv hj">的买入状态中获利交易(t) </strong> <br/>【卖出之前买入的股票】</p></blockquote><p id="c66c" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果我们计算所有天数和交易计数的上述状态，我们将最终找出具有卖出状态的最后一天的最大利润。卖出应该是最后一种状态，因为我们希望交易在接近结束时结束，因为在结束时买入是一种浪费金钱的损失。</p><h2 id="40ab" class="lt iw hi bd ix ly lz ma jb mb mc md jf ke me mf jj ki mg mh jn km mi mj jr mk bi translated">时间和空间复杂性</h2><ul class=""><li id="7bb2" class="kw kx hi jv b jw jx ka kb ke ms ki mt km mu kq lb lc ld le bi translated">时间复杂度:O(n * k)其中n是最大天数，k是允许的最大事务数。这是因为我们必须为所有可能的天数和交易计数组合计算2个州的利润。</li><li id="71c6" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">空间复杂度:O(k ),其中k是允许的最大事务。</li></ul><h1 id="3edd" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">3.最佳化</h1><p id="e5af" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">如果k小于可能的最大事务数，上述O(n * k)解决方案工作得非常好。</p><p id="47d8" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">但是，如果事务计数是无限的，或者换句话说，大于那些日子里可能的互斥事务的最大数量，那该怎么办呢？我们能做得更好吗？</p><p id="2b5d" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">对于这种情况，一个更简单的解决方案是迭代几天，每当我们看到一个本地的低谷时就开始交易，并在本地的高峰时卖出。</p><figure class="lk ll lm ln fd ij er es paragraph-image"><a href="https://www.java67.com/2018/06/data-structure-and-algorithm-interview-questions-programmers.html"><div class="er es mv"><img src="../Images/b2809a4e9f2d738339fc0428687f9fbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XMo8yJgmiD7puDZak5WzNg.png"/></div></a><p class="iq ir et er es is it bd b be z dx translated"><strong class="bd ix">买卖</strong></p></figure><h1 id="9f01" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">4.代码(Java)</h1><p id="9dc6" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">下面的代码用Java实现了上面解释的逻辑。<br/>买入状态用1表示，卖出状态用0表示。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="3b17" class="lt iw hi lp b fi lu lv l lw lx"><strong class="lp hj">public int maxProfit(int k, int[] prices) {</strong><br/>    int days = prices.length;<br/>    if (days&lt;=0 || k&lt;= 0) {<br/>      return 0;<br/>    }<br/> <br/>    <strong class="lp hj">// If transactions allowed are max possible ...</strong><br/>    if (k &gt;= (days/2)) {<br/>      int maxProfit = 0;<br/>      int min = prices[0];<br/>      for (int i=1; i&lt;days; i++) {<br/>        if (prices[i] &lt; min) {<br/>          min = prices[i];<br/>        } else {<br/>          maxProfit += (prices[i] — min);<br/>          min = prices[i];<br/>        }<br/>      }<br/>      return maxProfit;<br/>    }</span><span id="1761" class="lt iw hi lp b fi mw lv l lw lx">    <strong class="lp hj">// Find max profit for additional day with 0-k transactions.<br/>    </strong>int dp[][] = new int[k+1][2];<br/>    <strong class="lp hj">// Assigning negative values for cases which are not applicable</strong>.   <br/>    for (int t = 0; t &lt;= k; t++) {<br/>      dp[t][0] = -10000;<br/>      dp[t][1] = -10000;<br/>    }<br/>    dp[0][0] = 0;<br/>    dp[1][1] = -prices[0];<br/>    for (int d=1; d&lt;days; d++) {<br/>      int dpNew[][] = dp.clone();<br/>      for (int t=0; t&lt;=k; t++) { <br/>        dpNew[t][0] = Math.max(dp[t][0], dp[t][1] + prices[d]); <br/>        if (t==0) {<br/>          continue;<br/>        }<br/>        dpNew[t][1] = Math.max(dp[t][1], dp[t-1][0] — prices[d]); <br/>      }<br/>    }<br/> <br/>    <strong class="lp hj">// Find the max profit for the last day.</strong><br/>    int maxProfit = 0;<br/>    for (int t=0; t&lt;=k; t++) {<br/>      maxProfit = Math.max(maxProfit, dp[t][0]);<br/>    }<br/>    return maxProfit;<br/> <strong class="lp hj">}</strong></span></pre></div><div class="ab cl mx my gp mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="hb hc hd he hf"><p id="647a" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果你觉得这篇文章有用，<strong class="jv hj">请帮助我接触更多的开发学习者！</strong></p><p id="8a2a" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">通过“鼓掌”来展示一些❤👏在页面的左边距(在桌面上)或底部(在手机上)。通过连续点击，您可以这样做多达<strong class="jv hj"> 50 </strong>次！</p><h1 id="070f" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">阿努姆·马利克</h1><p id="cfcc" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在Twitter<a class="ae iu" href="https://twitter.com/anumsarmadmalik" rel="noopener ugc nofollow" target="_blank">上关注NMTechBytes</a>获取我的每日技术信息:)</p></div><div class="ab cl mx my gp mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="hb hc hd he hf"><h1 id="1997" class="iv iw hi bd ix iy ne ja jb jc nf je jf jg ng ji jj jk nh jm jn jo ni jq jr js bi translated">特别感谢:</h1><ul class=""><li id="ac17" class="kw kx hi jv b jw jx ka kb ke ms ki mt km mu kq lb lc ld le bi translated"><a class="ae iu" href="https://leetcode.com/problems/best-time-to-buy-and-sell-stock-iv/submissions/" rel="noopener ugc nofollow" target="_blank"> LeetCode库存问题</a></li></ul></div></div>    
</body>
</html>