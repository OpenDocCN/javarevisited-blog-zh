<html>
<head>
<title>JPA Specification: A Generic Search</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JPA规范:通用搜索</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/jpa-specification-a-generic-search-e8695b1d19ec?source=collection_archive---------0-----------------------#2020-11-16">https://medium.com/javarevisited/jpa-specification-a-generic-search-e8695b1d19ec?source=collection_archive---------0-----------------------#2020-11-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a15f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">了解如何创建简单而通用的搜索</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/4bc4f4027dee8e60ba156f60ebdbdd54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*W6I9goEAW37YRewp"/></div></div><p class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/@isaacbenhesed?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">is AAC benhessed</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="957c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在本文中，我们将讨论JPA规范的一个常见用例。</p><p id="391c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，我们将从使用JPA规范会简化我们整体实现的场景开始。接下来，我们将看看如何在我们的代码中使用它。最后，我们将探索它的实现。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="48a4" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">方案</h1><p id="cb7c" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated"><strong class="jq hj">一个常见的用例是，当我们需要基于一些列来查找记录时，我们在运行时定义这些列。</strong></p><p id="9916" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，让我们假设我们正在处理一个图书馆管理系统。想象一下，要求使用关键字搜索书籍，而不明确指出它是否来自<code class="du lo lp lq lr b">title</code>、<code class="du lo lp lq lr b">genre</code>、<code class="du lo lp lq lr b">author</code>、<em class="ls">、</em>等等。此外，在这个需求中，我们需要对我们的大多数域应用这种搜索，而不仅仅是<code class="du lo lp lq lr b">Book</code>。</p><p id="44a6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有了这个需求，现在让我们看看我们的抽象解决方案。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="1320" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated"><strong class="ak">解决方案</strong></h1><p id="7838" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">在深入研究它的实现之前，让我们看一下这个解决方案的整体以及我们将如何使用它。</p><p id="4cf1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，让我们快速创建一个数据集。为简单起见，我们将使用XML:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="942a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有了这个数据集，让我们尝试使用<code class="du lo lp lq lr b">“Spring”</code>作为关键字来搜索书籍。</p><p id="ac59" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了演示我们的解决方案，现在让我们创建一个简单的集成测试:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="b5c3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">从断言中我们可以看到，搜索<code class="du lo lp lq lr b">“Spring”</code>作为关键字，成功检索到2本书:<a class="ae jn" rel="noopener" href="/javarevisited/5-advanced-spring-framework-books-experienced-java-developers-should-read-in-2020-best-of-lot-2a786fc5ad31?source=---------6-----------------------">春天在行动</a>和<a class="ae jn" rel="noopener" href="/hackernoon/top-5-spring-boot-and-spring-cloud-books-for-java-developers-75df155dcedc?source=---------23------------------"> <em class="ls">春天在行动</em> </a>。</p><p id="fef1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">此外，值得强调的是<code class="du lo lp lq lr b">BookRepository</code>需要扩展<code class="du lo lp lq lr b">JpaSpecificationExecutor</code>，以拥有<code class="du lo lp lq lr b">findAll(searchSpecification)</code>方法。</p><p id="3d76" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在很清楚，<code class="du lo lp lq lr b">GenericSearchSpecification</code> <em class="ls"> </em> <strong class="jq hj">使我们能够将这种搜索应用到我们的任何领域</strong>。现在让我们讨论它的实现。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="29cb" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">履行</h1><p id="6226" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">在前一节中，我们已经看到了名为<code class="du lo lp lq lr b">GenericSearchSpecification</code>的类的使用。现在让我们来处理它的实现。</p><p id="6f81" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">(如果你想看整个项目，我已经包括了下面的链接。)<br/>以下是仅必要部分的片段:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="10d0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">正如我们从片段中看到的，我们创建了实现<code class="du lo lp lq lr b">Specification</code>接口的<code class="du lo lp lq lr b">GenericSearchSpecification</code>类。它有两个属性:一个列表<code class="du lo lp lq lr b">columns</code>和一个<code class="du lo lp lq lr b">search</code>字符串。</p><p id="5c6c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接下来，我们从<code class="du lo lp lq lr b">Specification</code>接口实现了<code class="du lo lp lq lr b">toPredicate</code>方法。此外，我们创建了一个<code class="du lo lp lq lr b">buildExpression</code>方法来处理域嵌套属性的搜索，比如<code class="du lo lp lq lr b">“author.name”</code>。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="7932" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">结论</h1><p id="56ae" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">在本教程中，我们探索了JPA规范的一个常见用例，以及解决方案及其实现。</p><p id="fae6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">本文的完整源代码可以在<a class="ae jn" href="https://github.com/emyasa/medium-articles/tree/master/java-persistence-api" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得。</p><p id="fde8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果您正在寻找另一篇与<a class="ae jn" href="https://javarevisited.blogspot.com/2018/01/top-5-hibernate-and-jpa-courses-for-java-programmers-learn-online.html" rel="noopener ugc nofollow" target="_blank"> JPA </a>相关的有趣文章，请随意查看:</p><div class="lv lw ez fb lx ly"><a rel="noopener follow" target="_blank" href="/javarevisited/spring-jpa-when-to-use-join-fetch-a6cec898c4c6"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hj fi z dy md ea eb me ed ef hh bi translated">Spring JPA:何时使用“Join Fetch”</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">避免N+1次查询并保留检索逻辑</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm jh ly"/></div></div></a></div></div></div>    
</body>
</html>