<html>
<head>
<title>Create your own Dynamic Object in C#</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在C#中创建自己的动态对象</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/create-your-own-dynamic-object-in-c-2c8e53ecba30?source=collection_archive---------1-----------------------#2021-11-01">https://medium.com/javarevisited/create-your-own-dynamic-object-in-c-2c8e53ecba30?source=collection_archive---------1-----------------------#2021-11-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c46b1bc21139c01ae314e14d07b52338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SgcQuvkOoTtlhhG4"/></div></div><p class="iq ir et er es is it bd b be z dx translated">由<a class="ae iu" href="https://unsplash.com/@momentsbygabriel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Gabriel Crismariu </a>在<a class="ae iu" href="https://unsplash.com/s/photos/dynamic?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="63f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您使用的是NoSQL数据库，您可能希望创建一个类，该类除了包含标准属性之外，还可以包含可扩展属性，以便利用NoSQL中的动态模式功能。</p><p id="0d6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以依赖Json Serialiser，尤其是System.Text.Json。</p><p id="61c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">什么是系统。Text.Json？</strong></p><p id="2895" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">系统。Json是微软默认的Json串行器。它比<a class="ae iu" href="https://www.newtonsoft.com/" rel="noopener ugc nofollow" target="_blank">牛顿软件</a>快大约2倍。</p><p id="979c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">英寸与. NET 5中的初始版本相比，微软在性能方面有了显著的提高。网芯3.1。</p><p id="48f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">进场</strong></p><p id="7f8e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将依赖来自<a class="ae iu" href="https://docs.microsoft.com/en-us/dotnet/api/system.text.json.serialization?view=net-5.0" rel="noopener ugc nofollow" target="_blank">系统的<code class="du jt ju jv jw b"><a class="ae iu" href="https://docs.microsoft.com/en-us/dotnet/api/system.text.json.serialization.jsonextensiondataattribute?view=net-5.0" rel="noopener ugc nofollow" target="_blank">JsonExtensionData</a></code>属性。Text.Json.Serialization </a>命名空间，它将被分配给一个字符串到object/JsonElement的字典。该字典将用于保存未显式声明为类属性的附加属性。就像任何其他Json属性一样，这个属性需要一个public修饰符。</p><p id="a7ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您不需要自己手动实例化一个可扩展对象，则不需要在构造函数中实例化dictionary对象。换句话说，如果您只使用Json serialiser在整个应用程序中构造可扩展对象，那么dictionary对象的实例化将在序列化/反序列化操作期间处理。</p><p id="afe5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">声明了一个索引器方法，以允许轻松访问存储在字典中的附加属性。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="kb kc l"/></div><p class="iq ir et er es is it bd b be z dx translated">基本可扩展对象类</p></figure><p id="87a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个可扩展的对象类将只处理附加的属性，并且不知道该类中声明的其他现有属性。这将消除使用反射来访问现有属性的需要。</p><p id="64b1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">用途</strong></p><p id="b060" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，您希望有一个动态的动物类。</p><figure class="jx jy jz ka fd ij"><div class="bz dy l di"><div class="kb kc l"/></div><p class="iq ir et er es is it bd b be z dx translated">具有可扩展属性的派生类的示例</p></figure><p id="ac78" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它将能够接受下面的JSON有效负载，并相应地将值解析为各自的属性。</p><pre class="jx jy jz ka fd kd jw ke kf aw kg bi"><span id="0ecc" class="kh ki hi jw b fi kj kk l kl km">// Duck type</span><span id="e0b5" class="kh ki hi jw b fi kn kk l kl km">{<br/>"Name": "Mallory",<br/>"Gender": 1, // 1 is male, 0 is female<br/>"DateOfBirth": "2018-09-19T12:00",<br/>"IsMammal": true,<br/>"BeakColor": "Red" // additional property can be found in dictionary<br/>}</span><span id="f8a0" class="kh ki hi jw b fi kn kk l kl km">// Dog type</span><span id="0643" class="kh ki hi jw b fi kn kk l kl km">{<br/>"Name": "Groot",<br/>"Gender": 1, // 1 is male, 0 is female<br/>"DateOfBirth": "2018-09-19T12:00",<br/>"IsMammal": true,<br/>"EyeColor": "Brown" // additional property can be found in dictionary<br/>}</span></pre><p id="0862" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">应该用Object还是JsonElement作为可扩展字典的值的类型？</strong></p><p id="2d8c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对象是基类类型，可以在您的代码库中实例化。这使您能够轻松地向可扩展字典添加更多的键/值对。</p><p id="3271" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">JsonElement是一个只能在系统内实例化的对象。Json包。因此，如果您需要向字典中添加更多的值，将会更加麻烦。</p><p id="d1c8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">除此之外，JsonElement有一个GetRawText方法，它为您提供被解析的原始字符串值。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="0ac4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望这篇文章对你有所帮助。感谢您的阅读，敬请关注更多C#相关文章！</p></div></div>    
</body>
</html>