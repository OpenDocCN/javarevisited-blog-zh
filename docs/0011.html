<html>
<head>
<title>Happy Holidays!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">节日快乐！</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/happy-holidays-dee5c9ccf0c4?source=collection_archive---------8-----------------------#2017-12-22">https://medium.com/javarevisited/happy-holidays-dee5c9ccf0c4?source=collection_archive---------8-----------------------#2017-12-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b25e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候玩一些爪哇驯鹿游戏了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ab332972b45057031f11972f9a34ba25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dY2ZJiShZomX-GCfmjHMnA.png"/></div></div><p class="jp jq et er es jr js bd b be z dx translated">纽约的灯节</p></figure><p id="94d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个博客将主要是代码。我将展示一些 Eclipse 集合和 Java 流 API，并加入一些节日元素。在 Eclipse Collections 的帮助下，我将从用 Java 实现一个驯鹿枚举开始。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="cc77" class="jz ka hi jv b fi kb kc l kd ke">public enum Reindeer<br/>{<br/>    <strong class="jv hj"><em class="kf">Dasher</em></strong>, <strong class="jv hj"><em class="kf">Dancer, Prancer</em></strong>, <strong class="jv hj"><em class="kf">Vixen</em></strong>, <strong class="jv hj"><em class="kf">Comet</em></strong>, <strong class="jv hj"><em class="kf">Cupid</em></strong>, <strong class="jv hj"><em class="kf">Donner</em></strong>, <strong class="jv hj"><em class="kf">Blitzen</em></strong>,<br/>    <strong class="jv hj"><em class="kf">Rudolph</em></strong>;</span><span id="f9f1" class="jz ka hi jv b fi kg kc l kd ke">    public static ImmutableList&lt;Reindeer&gt; all()<br/>    {<br/>        return <em class="kf">theMostFamousReindeerOfAll</em>()<br/>                .newWithAll(<em class="kf">theOtherReindeer</em>()<br/>                        .flatCollect(Reindeer::<em class="kf">toList</em>));<br/>    }</span><span id="adb5" class="jz ka hi jv b fi kg kc l kd ke">    private static ImmutableList&lt;Twin&lt;Reindeer&gt;&gt; theOtherReindeer()<br/>    {<br/>        return Lists.<strong class="jv hj"><em class="kf">immutable</em></strong>.with(<br/>                <strong class="jv hj"><em class="kf">Dasher</em></strong>.and(<strong class="jv hj"><em class="kf">Dancer</em></strong>),<br/>                <strong class="jv hj"><em class="kf">Prancer</em></strong>.and(<strong class="jv hj"><em class="kf">Vixen</em></strong>),<br/>                <strong class="jv hj"><em class="kf">Comet</em></strong>.and(<strong class="jv hj"><em class="kf">Cupid</em></strong>),<br/>                <strong class="jv hj"><em class="kf">Donner</em></strong>.and(<strong class="jv hj"><em class="kf">Blitzen</em></strong>));<br/>    }</span><span id="0a98" class="jz ka hi jv b fi kg kc l kd ke">    private static <br/>    ImmutableList&lt;Reindeer&gt; theMostFamousReindeerOfAll()<br/>    {<br/>        return Lists.<strong class="jv hj"><em class="kf">immutable</em></strong>.with(Reindeer.<strong class="jv hj"><em class="kf">Rudolph</em></strong>);<br/>    }</span><span id="bc06" class="jz ka hi jv b fi kg kc l kd ke">    private static <br/>    ImmutableList&lt;Reindeer&gt; toList(Twin&lt;Reindeer&gt; twin)<br/>    {<br/>        return Lists.<strong class="jv hj"><em class="kf">immutable</em></strong>.with(twin.getOne(), twin.getTwo());<br/>    }</span><span id="f55e" class="jz ka hi jv b fi kg kc l kd ke">    public Twin&lt;Reindeer&gt; and(Reindeer other)<br/>    {<br/>        return Tuples.<em class="kf">twin</em>(this, other);<br/>    }</span><span id="ae03" class="jz ka hi jv b fi kg kc l kd ke">    public int nameLength()<br/>    {<br/>        return this.name().length();<br/>    }</span><span id="8b95" class="jz ka hi jv b fi kg kc l kd ke">    public Character firstLetterOfName()<br/>    {<br/>        return Character.<em class="kf">valueOf</em>(this.name().charAt(0));<br/>    }<br/>}</span></pre><p id="c3a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我用名为<code class="du kh ki kj jv b">all</code>的方法创建了一个鲁道夫在前面的驯鹿<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/list/ImmutableList.html" rel="noopener ugc nofollow" target="_blank">ImmutableList</a></code>。我创建了一个其他驯鹿的<code class="du kh ki kj jv b">ImmutableList</code>，基于它们在流行歌曲中的通常顺序。我使用类型<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/tuple/Twin.html" rel="noopener ugc nofollow" target="_blank">Twin</a></code>，它是一个<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/tuple/Pair.html" rel="noopener ugc nofollow" target="_blank">Pair</a></code>，对于两个项目具有相同的类型。最后，我使用方法<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/list/ImmutableList.html#flatCollect-org.eclipse.collections.api.block.function.Function-" rel="noopener ugc nofollow" target="_blank">flatCollect</a></code>将所有的驯鹿组合成一个列表，这个列表被添加到鲁道夫使用<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/list/ImmutableList.html#newWithAll-java.lang.Iterable-" rel="noopener ugc nofollow" target="_blank">newWithAll</a></code>方法的<code class="du kh ki kj jv b">ImmutableList</code>中。</p><p id="3752" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我将为驯鹿命名游戏实现一些测试。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="7993" class="jz ka hi jv b fi kb kc l kd ke"><em class="kf">/**<br/> * Create a comma separated String of the Reindeer names.<br/> */<br/></em>@Test<br/>public void reindeerNameGame1()<br/>{<br/>    String expectedNames = <strong class="jv hj">"Rudolph, " </strong>+<br/>            <strong class="jv hj">"Dasher, Dancer, " </strong>+<br/>            <strong class="jv hj">"Prancer, Vixen, " </strong>+<br/>            <strong class="jv hj">"Comet, Cupid, " </strong>+<br/>            <strong class="jv hj">"Donner, Blitzen"</strong>;</span><span id="8860" class="jz ka hi jv b fi kg kc l kd ke">    Assert.<em class="kf">assertEquals</em>(<br/>            expectedNames,<br/>            Reindeer.<em class="kf">all</em>().makeString(<strong class="jv hj">", "</strong>));</span><span id="a166" class="jz ka hi jv b fi kg kc l kd ke">    Assert.<em class="kf">assertEquals</em>(<br/>            expectedNames,<br/>            String.<em class="kf">join</em>(<strong class="jv hj">", "</strong>,<br/>                    Reindeer.<em class="kf">all</em>()<br/>                            .asLazy()<br/>                            .collect(Reindeer::name)));</span><span id="bf62" class="jz ka hi jv b fi kg kc l kd ke">    Assert.<em class="kf">assertEquals</em>(<br/>            expectedNames,<br/>            Reindeer.<em class="kf">all</em>()<br/>                    .stream()<br/>                    .map(Reindeer::name)<br/>                    .collect(Collectors.<em class="kf">joining</em>(<strong class="jv hj">", "</strong>)));<br/>}</span></pre><p id="485e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个测试中，我展示了三种不同的方法来创建驯鹿名的逗号分隔的字符串<strong class="ih hj"><em class="kf"/></strong>。首先，我使用 Eclipse 集合中的<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/RichIterable.html#makeString-java.lang.String-" rel="noopener ugc nofollow" target="_blank">makeString</a></code>。方法<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/RichIterable.html#makeString-java.lang.String-" rel="noopener ugc nofollow" target="_blank">makeString</a></code>不要求对象是一个<code class="du kh ki kj jv b">CharSequence</code>。它使用对象的<code class="du kh ki kj jv b">toString</code>实现。</p><p id="6abb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我使用 Java 8 中添加的<code class="du kh ki kj jv b"><a class="ae jt" href="https://docs.oracle.com/javase/9/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.Iterable-" rel="noopener ugc nofollow" target="_blank">String.join</a></code> <em class="kf"> </em>。这个方法采用了一个<code class="du kh ki kj jv b">CharSequence</code>的<code class="du kh ki kj jv b">Iterable</code>，它是我用一个带有<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/LazyIterable.html#collect-org.eclipse.collections.api.block.function.Function-" rel="noopener ugc nofollow" target="_blank">collect</a></code>的<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/LazyIterable.html" rel="noopener ugc nofollow" target="_blank">LazyIterable</a></code>创建的。</p><p id="c4cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我用一个<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/collection/ImmutableCollection.html#stream--" rel="noopener ugc nofollow" target="_blank">stream</a></code>和从<code class="du kh ki kj jv b">all</code>返回的<code class="du kh ki kj jv b">ImmutableList</code>，然后用<code class="du kh ki kj jv b">map</code>将每个<code class="du kh ki kj jv b">Reindeer</code>传递给它的<code class="du kh ki kj jv b">name</code>，用<code class="du kh ki kj jv b">Collectors.joining</code>将它们全部转化成一个<code class="du kh ki kj jv b">String</code>。所有三种方法都有完全相同的结果。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="a864" class="jz ka hi jv b fi kb kc l kd ke"><em class="kf">/**<br/> * Count the Reindeer names based on their size.<br/> */<br/></em>@Test<br/>public void reindeerNameGame2()<br/>{<br/>    IntBag nameCounts =<br/>            Reindeer.<em class="kf">all</em>()<br/>                    .asLazy()<br/>                    .collectInt(Reindeer::nameLength).toBag();<br/><br/>    IntBag nameCountsFromIntStream =<br/>            IntBags.<strong class="jv hj"><em class="kf">mutable</em></strong>.withAll(<br/>                    Reindeer.<em class="kf">all</em>()<br/>                            .stream()<br/>                            .mapToInt(Reindeer::nameLength));<br/><br/>    Assert.<em class="kf">assertEquals</em>(nameCounts, nameCountsFromIntStream);<br/>    Assert.<em class="kf">assertEquals</em>(3, nameCounts.occurrencesOf(5));<br/>    Assert.<em class="kf">assertEquals</em>(3, nameCounts.occurrencesOf(6));<br/>    Assert.<em class="kf">assertEquals</em>(3, nameCounts.occurrencesOf(7));<br/><br/>    Bag&lt;Integer&gt; nameCountsBy =<br/>            Reindeer.<em class="kf">all</em>().<strong class="jv hj">countBy</strong>(Reindeer::nameLength);<br/><br/>    Assert.<em class="kf">assertEquals</em>(3, nameCountsBy.occurrencesOf(5));<br/>    Assert.<em class="kf">assertEquals</em>(3, nameCountsBy.occurrencesOf(6));<br/>    Assert.<em class="kf">assertEquals</em>(3, nameCountsBy.occurrencesOf(7));<br/><br/>    Map&lt;Integer, Long&gt; streamNameCounts =<br/>            Reindeer.<em class="kf">all</em>()<br/>                    .stream()<br/>                    .collect(Collectors.<em class="kf">groupingBy</em>(<br/>                            Reindeer::nameLength,<br/>                            Collectors.<em class="kf">counting</em>()));<br/><br/>    Assert.<em class="kf">assertEquals</em>(new Long(3), streamNameCounts.get(5));<br/>    Assert.<em class="kf">assertEquals</em>(new Long(3), streamNameCounts.get(6));<br/>    Assert.<em class="kf">assertEquals</em>(new Long(3), streamNameCounts.get(7));<br/>}</span></pre><p id="f4d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个测试中，我展示了四种不同的方法来计算驯鹿的长度。首先，我创建一个<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/bag/primitive/IntBag.html" rel="noopener ugc nofollow" target="_blank">IntBag</a></code>，通过使用<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/LazyIterable.html#collectInt-org.eclipse.collections.api.block.function.primitive.IntFunction-" rel="noopener ugc nofollow" target="_blank">collectInt</a></code>收集驯鹿的所有名字长度，然后转换结果<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/IntIterable.html#toBag--" rel="noopener ugc nofollow" target="_blank">toBag</a></code>。</p><p id="7c91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第二个例子中，我通过使用<code class="du kh ki kj jv b">mapToInt</code>将驯鹿的名字长度映射到一个 int，从驯鹿创建了一个<code class="du kh ki kj jv b">IntStream</code>。我使用<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/factory/bag/primitive/MutableIntBagFactory.html#withAll-java.util.stream.IntStream-" rel="noopener ugc nofollow" target="_blank">withAll</a></code>方法从一个<code class="du kh ki kj jv b">IntStream</code>创建一个<code class="du kh ki kj jv b">IntBag</code>。</p><p id="136d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个方法在<a class="ae jt" rel="noopener" href="/@donraab/nine-features-in-eclipse-collections-9-0-a2ca97dfdf74"> Eclipse Collections 9.0 </a>中变得可用(查看第 3 项以获得与以前版本的比较)。第三种解决方案是最简单的。我使用方法<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/RichIterable.html#countBy-org.eclipse.collections.api.block.function.Function-" rel="noopener ugc nofollow" target="_blank">countBy</a></code>，该方法可用于 Eclipse 集合中扩展<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/RichIterable.html" rel="noopener ugc nofollow" target="_blank">RichIterable</a></code>的类型。</p><p id="fe87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我用<code class="du kh ki kj jv b"><a class="ae jt" rel="noopener" href="/javarevisited/7-best-java-collections-and-stream-api-courses-for-beginners-in-2020-3ad18d52c38">Stream</a></code> <a class="ae jt" rel="noopener" href="/javarevisited/7-best-java-collections-and-stream-api-courses-for-beginners-in-2020-3ad18d52c38"> </a>搭配<code class="du kh ki kj jv b"><a class="ae jt" rel="noopener" href="/javarevisited/7-best-java-collections-and-stream-api-courses-for-beginners-in-2020-3ad18d52c38">Collectors.groupingBy</a></code>和<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.java67.com/2014/04/java-8-stream-examples-and-tutorial.html" rel="noopener ugc nofollow" target="_blank">Collectors.counting</a></code> <strong class="ih hj"> <em class="kf"> </em> </strong>，这样就产生了<code class="du kh ki kj jv b">Integer</code>到<code class="du kh ki kj jv b">Long</code>的<code class="du kh ki kj jv b">Map</code>。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="738f" class="jz ka hi jv b fi kb kc l kd ke"><em class="kf">/**<br/> * Group Reindeer by the first letter of their names.<br/> */<br/></em>@Test<br/>public void reindeerNameGame3()<br/>{<br/>    Multimap&lt;Character, Reindeer&gt; multimap =<br/>            Reindeer.<em class="kf">all</em>().groupBy(Reindeer::firstLetterOfName);</span><span id="c9d2" class="jz ka hi jv b fi kg kc l kd ke">    Map&lt;Character, List&lt;Reindeer&gt;&gt; mapOfLists =<br/>            Reindeer.<em class="kf">all</em>()<br/>                    .stream()<br/>                    .collect(Collectors.<em class="kf">groupingBy</em>(<br/>                            Reindeer::firstLetterOfName));</span><span id="da9d" class="jz ka hi jv b fi kg kc l kd ke">    Assert.<em class="kf">assertEquals</em>(<strong class="jv hj">"Dasher, Dancer, Donner"</strong>,<br/>            multimap.get(<strong class="jv hj">'D'</strong>).makeString(<strong class="jv hj">", "</strong>));<br/>    Assert.<em class="kf">assertEquals</em>(<strong class="jv hj">"Comet, Cupid"</strong>,<br/>            multimap.get(<strong class="jv hj">'C'</strong>).makeString(<strong class="jv hj">", "</strong>));</span><span id="1d1c" class="jz ka hi jv b fi kg kc l kd ke">    Assert.<em class="kf">assertEquals</em>(multimap.get(<strong class="jv hj">'D'</strong>), mapOfLists.get(<strong class="jv hj">'D'</strong>));<br/>    Assert.<em class="kf">assertEquals</em>(multimap.get(<strong class="jv hj">'C'</strong>), mapOfLists.get(<strong class="jv hj">'C'</strong>));<br/>}</span></pre><p id="da8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个测试中，我展示了两种根据驯鹿姓氏的第一个字母对它们进行分组的方法。首先，我使用直接在<code class="du kh ki kj jv b">ImmutableList</code>上可用的<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/list/ImmutableList.html#groupBy-org.eclipse.collections.api.block.function.Function-" rel="noopener ugc nofollow" target="_blank">groupBy</a></code>方法，它返回一个<code class="du kh ki kj jv b"><a class="ae jt" href="https://www.eclipse.org/collections/javadoc/9.0.0/org/eclipse/collections/api/multimap/Multimap.html" rel="noopener ugc nofollow" target="_blank">Multimap</a></code>。</p><p id="ddd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第二个例子中，我在<a class="ae jt" href="https://javarevisited.blogspot.com/2018/02/java-9-example-factory-methods-for-collections-immutable-list-set-map.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="kf">上使用 stream 方法，在</em> </strong> </a>上使用 ImmutableList，在<code class="du kh ki kj jv b"><a class="ae jt" href="https://docs.oracle.com/javase/9/docs/api/java/util/stream/Collectors.html" rel="noopener ugc nofollow" target="_blank">Collectors</a></code>实用程序类上使用<code class="du kh ki kj jv b">groupingBy Collector</code>使用 collect 方法。</p><p id="d8e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你喜欢参加这些驯鹿游戏。在这三个例子中，我探索了一堆<a class="ae jt" href="https://www.eclipse.org/collections/" rel="noopener ugc nofollow" target="_blank"> Eclipse 集合</a>和<a class="ae jt" href="https://docs.oracle.com/javase/9/docs/api/java/util/stream/Stream.html" rel="noopener ugc nofollow" target="_blank">Streams</a>API，它们可能对您自己的 Java 代码有用。</p><p id="7ff4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">祝节日快乐，新年快乐！</p><p id="c4e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/eclipse/eclipse-collections" rel="noopener ugc nofollow" target="_blank"> <em class="kf">月食收藏</em> </a> <em class="kf">为</em> <a class="ae jt" href="https://github.com/eclipse/eclipse-collections/blob/master/CONTRIBUTING.md" rel="noopener ugc nofollow" target="_blank"> <em class="kf">投稿</em> </a> <em class="kf">。如果你喜欢这个库，你可以在 GitHub 上让我们知道。</em></p></div></div>    
</body>
</html>