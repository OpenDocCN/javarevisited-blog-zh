<html>
<head>
<title>How to display a Progress Bar on the Standard Console using Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Java在标准控制台上显示进度条</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/how-to-display-progressbar-on-the-standard-console-using-java-18f01d52b30e?source=collection_archive---------1-----------------------#2022-04-27">https://medium.com/javarevisited/how-to-display-progressbar-on-the-standard-console-using-java-18f01d52b30e?source=collection_archive---------1-----------------------#2022-04-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a267" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你有没有想过一个进度条是如何在标准控制台上显示的(特别是当像npm这样的包管理器被用来下载包的时候)？我确信，即使你没有想过这个问题，你也会喜欢了解这个问题。请注意，这篇文章不会涉及跟踪任务的进展或类似的事情。事不宜迟，让我们来探索解决方案。</p><p id="ba66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们创建一个名为<code class="du jd je jf jg b">printMsgWithProgressBar()</code>的方法，它接受要打印的<code class="du jd je jf jg b"><a class="ae jh" href="https://www.java67.com/2019/11/how-to-remove-duplicate-characters-from-string-in-java.html" rel="noopener ugc nofollow" target="_blank">String</a></code>消息、<code class="du jd je jf jg b"><a class="ae jh" href="https://www.java67.com/2016/01/3-ways-to-convert-int-value-to-string-in-java.html" rel="noopener ugc nofollow" target="_blank">int</a></code> <a class="ae jh" href="https://www.java67.com/2016/01/3-ways-to-convert-int-value-to-string-in-java.html" rel="noopener ugc nofollow" target="_blank"> </a>进度条的长度和<code class="du jd je jf jg b">long</code>决定动画应该多快出现的时间间隔。因为我们要从<code class="du jd je jf jg b">static main()</code>方法中调用该方法，所以我们必须给<code class="du jd je jf jg b">printMsgWithProgressBar()</code>方法添加<code class="du jd je jf jg b">static</code>修饰符。该方法类似于:</p><p id="f92d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">public static void printMsgWithProgressBar(String message, int length, long timeInterval){ }</code></p><p id="c76e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用Java中的<code class="du jd je jf jg b"><a class="ae jh" href="https://javarevisited.blogspot.com/2017/08/10-differences-between-stringbuffer-and-StringBuilder-in-java.html" rel="noopener ugc nofollow" target="_blank">StringBuilder</a></code> <a class="ae jh" href="https://javarevisited.blogspot.com/2017/08/10-differences-between-stringbuffer-and-StringBuilder-in-java.html" rel="noopener ugc nofollow" target="_blank"> </a>类将进度条构造为<code class="du jd je jf jg b">String</code>。你可能想知道<code class="du jd je jf jg b">String</code>看起来会像一个进度条。现在，神奇的部分来了；-).我们将使用两个<strong class="ih hj"> Unicode字符:</strong></p><ol class=""><li id="8e07" class="ji jj hi ih b ii ij im in iq jk iu jl iy jm jc jn jo jp jq bi translated">用于显示未完成进度的<strong class="ih hj">u+2591</strong>t19】unicode字符 ░。</li><li id="9eec" class="ji jj hi ih b ii jr im js iq jt iu ju iy jv jc jn jo jp jq bi translated">用于显示完成进度的<strong class="ih hj">u+2588</strong>t23】unicode字符 █。</li></ol><p id="d5c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，不支持<strong class="ih hj"> Unicode字符的控制台可能不支持这些字符。</strong>您可以考虑使用其他符号，如<code class="du jd je jf jg b">=</code>或<code class="du jd je jf jg b">-</code>作为进度条字符。</p><p id="049a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还需要一个<code class="du jd je jf jg b"><a class="ae jh" href="https://www.java67.com/2014/05/difference-between-stringbuilder-and-StringBuffer-java.html" rel="noopener ugc nofollow" target="_blank">StringBuilder</a></code> <a class="ae jh" href="https://www.java67.com/2014/05/difference-between-stringbuilder-and-StringBuffer-java.html" rel="noopener ugc nofollow" target="_blank"> </a>实例来构建进度条。我们将使用Java <code class="du jd je jf jg b"><a class="ae jh" rel="noopener" href="/javarevisited/7-best-java-tutorials-and-books-to-learn-lambda-expression-and-stream-api-and-other-features-3083e6038e14">Stream</a></code> <a class="ae jh" rel="noopener" href="/javarevisited/7-best-java-tutorials-and-books-to-learn-lambda-expression-and-stream-api-and-other-features-3083e6038e14"> </a> API中的工厂方法<code class="du jd je jf jg b">generate()</code>来生成带有不完整Unicode字符的进度条。我们也可以使用一个简单的循环来达到同样的目的。在这个阶段，您的代码应该看起来像这样:</p><pre class="jw jx jy jz fd ka jg kb kc aw kd bi"><span id="1d94" class="ke kf hi jg b fi kg kh l ki kj">public static void printMsgWithProgressBar(String message, int length, long timeInterval)    <br/>{        <br/>char incomplete = '░'; // U+2591 Unicode Character        <br/>char complete = '█'; // U+2588 Unicode Character        StringBuilder builder = new StringBuilder();<br/>Stream.generate(() -&gt; incomplete).limit(length).forEach(builder::append);<br/>}</span></pre><p id="5ee8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们需要在显示进度条之前先打印消息。我们必须用一个从<code class="du jd je jf jg b">0</code>迭代到<code class="du jd je jf jg b">length-1</code>的<code class="du jd je jf jg b">int</code>迭代器声明一个<code class="du jd je jf jg b"><a class="ae jh" href="https://www.java67.com/2014/05/3-examples-to-loop-map-in-java-foreach.html" rel="noopener ugc nofollow" target="_blank">for</a></code> <a class="ae jh" href="https://www.java67.com/2014/05/3-examples-to-loop-map-in-java-foreach.html" rel="noopener ugc nofollow" target="_blank">循环</a>。在循环内部，我们必须用完整的块Unicode字符替换<code class="du jd je jf jg b">builder</code>的第<code class="du jd je jf jg b">i</code>个字符，并打印进度条。现在，代码应该看起来像这样:</p><pre class="jw jx jy jz fd ka jg kb kc aw kd bi"><span id="cadc" class="ke kf hi jg b fi kg kh l ki kj">public static void printMsgWithProgressBar(String message, int length, long timeInterval)    <br/>{        <br/>char incomplete = '░'; // U+2591 Unicode Character        <br/>char complete = '█'; // U+2588 Unicode Character        StringBuilder builder = new StringBuilder();<br/>Stream.generate(() -&gt; incomplete).limit(length).forEach(builder::append);<br/>for(int i = 0; i &lt; length; i++)        <br/>{            <br/>builder.replace(i,i+1,String.valueOf(complete));<br/>System.out.print(builder);<br/>}<br/>}</span></pre><p id="860f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果您使用<code class="du jd je jf jg b"><a class="ae jh" href="https://www.java67.com/2016/01/main-method-interview-questions-in-java-answers.html" rel="noopener ugc nofollow" target="_blank">main()</a></code>方法执行这个方法，它将不会打印进度条，而是在每个循环中重新打印<code class="du jd je jf jg b">String</code>，甚至可能会转到新的一行。那么，如何在每次迭代中将更新后的进度条打印在同一行呢？这里我们要使用的技巧是<strong class="ih hj">回车</strong> <code class="du jd je jf jg b">\r</code> <strong class="ih hj">转义序列</strong>。打印完<code class="du jd je jf jg b">String</code>后，强制控制台将光标移动到行首。我们必须在打印之前将<code class="du jd je jf jg b">\r</code>转义序列字符附加到<code class="du jd je jf jg b">builder</code>上。现在，代码应该看起来像这样:</p><pre class="jw jx jy jz fd ka jg kb kc aw kd bi"><span id="8532" class="ke kf hi jg b fi kg kh l ki kj">public static void printMsgWithProgressBar(String message, int length, long timeInterval)    <br/>{        <br/>char incomplete = '░'; // U+2591 Unicode Character        <br/>char complete = '█'; // U+2588 Unicode Character        StringBuilder builder = new StringBuilder();<br/>Stream.generate(() -&gt; incomplete).limit(length).forEach(builder::append);<br/>for(int i = 0; i &lt; length; i++)        <br/>{            <br/>builder.replace(i,i+1,String.valueOf(complete));<br/>String progressBar = "\r" + builder;<br/>System.out.print(progressBar);<br/>}<br/>}</span></pre><p id="615a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果您运行代码，您将在一行中看到进度条，但它看起来不像动画，因为在填充进度条时不会有任何延迟。为了增加填充的延迟，我们将使用作为方法参数得到的<code class="du jd je jf jg b">timeInterval</code>值。我们将使用带有<code class="du jd je jf jg b">timeInterval</code>参数的<code class="du jd je jf jg b">Thread.sleep()</code>方法定期暂停执行。</p><p id="a07d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">就这样</strong>！现在，如果您运行代码，您将在控制台上看到一个动画进度条。下面是完整的代码:</p><figure class="jw jx jy jz fd kk"><div class="bz dy l di"><div class="kl km l"/></div><p class="kn ko et er es kp kq bd b be z dx translated">在控制台上显示进度条的完整代码</p></figure><p id="8574" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当进度条不完整时，它看起来像这样:</p><figure class="jw jx jy jz fd kk er es paragraph-image"><div class="er es kr"><img src="../Images/0cf367c7398995381a73b8d17c4a6f45.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*7PoIylGso7NOrzFa0PRtVg.png"/></div><p class="kn ko et er es kp kq bd b be z dx translated">控制台上的进度条不完整</p></figure><p id="63fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">动画结束后，看起来会像这样:</p><figure class="jw jx jy jz fd kk er es paragraph-image"><div class="er es ku"><img src="../Images/f22bca61c67eb4b78bba4ae535fad2ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*4rArqm387FOrdAGf00HYsw.png"/></div><p class="kn ko et er es kp kq bd b be z dx translated">控制台上带有已完成进度的进度条</p></figure><p id="21d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我第一篇关于Medium.com的文章！我希望在这篇文章的帮助下，你能学到一些新的东西。感谢阅读这篇文章！请关注我，获取更多有趣的文章！祝您愉快:-)！</p></div></div>    
</body>
</html>