<html>
<head>
<title>Unit and Integration Tests against a real database with Continuous Integration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">针对具有持续集成的真实数据库的单元和集成测试</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/unit-and-integration-tests-against-a-real-database-with-continuous-integration-a62d1be664f3?source=collection_archive---------5-----------------------#2019-08-28">https://medium.com/javarevisited/unit-and-integration-tests-against-a-real-database-with-continuous-integration-a62d1be664f3?source=collection_archive---------5-----------------------#2019-08-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="35c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用 Github、Travis CI、Java/Spring 和 PostgreSQL 的真实项目示例。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/329d5231b39e73439e0b279494de284e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hlKX1OTBZ61ALy-ZA0I3Gg.png"/></div></div></figure><p id="bc1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将解释一个非常简单的免费解决方案，我在我雄心勃勃的项目<strong class="ih hj"> Gemini </strong>中使用了这个方案，它从一个简单的 DSL 模型开始，从头开始自动生成后端<a class="ae jp" href="https://javarevisited.blogspot.com/2018/02/top-5-restful-web-services-with-spring-courses-for-experienced-java-programmers.html" rel="noopener ugc nofollow" target="_blank"> REST API </a>。</p><p id="af6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在 Gemini 中，我做了许多自以为是的操作，将我定义的抽象类型转换成真正的 SQL 语句和查询，有时使用一些特定于数据库的特性(如 PostgreSQL 中的域)。</p><div class="jq jr ez fb js jt"><a href="https://github.com/h4t0n/gemini" rel="noopener  ugc nofollow" target="_blank"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hj fi z dy jy ea eb jz ed ef hh bi translated">h4t0n/双子星</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">Gemini 使得 REST API 开发速度更快。您可以创建微服务、完整的后端 web/移动应用程序和 MVPs</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">github.com</p></div></div><div class="kc l"><div class="kd l ke kf kg kc kh jn jt"/></div></div></a></div><p id="b6fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我开发了许多使用真实 PostgreSQL 数据库的集成测试，每次需要测试一个宏特性时，我都会从一个新的数据库开始完全删除集成测试数据库。我知道这个过程可能需要一些时间来完成，但这并不重要。我很少在编程时运行所有的代码库测试。我只运行可能受影响的部分，如果有任何问题，特拉维斯和<a class="ae jp" href="https://www.java67.com/2019/04/top-5-courses-to-learn-git-and-github.html" rel="noopener ugc nofollow" target="_blank"> Github </a>会注意到我。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="6250" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，让我们深入探讨一下，但我不想在这里解释我是如何启动 Spring context 或删除数据库的。如果您需要关于<a class="ae jp" href="https://javarevisited.blogspot.com/2018/06/top-6-spring-framework-online-courses-Java-programmers.html" rel="noopener ugc nofollow" target="_blank">Spring</a>/Gradle/<a class="ae jp" rel="noopener" href="/javarevisited/10-free-courses-to-learn-java-in-2019-22d1f33a3915">Java</a>的帮助，您可以联系我或浏览 Gemini 的<a class="ae jp" href="https://github.com/h4t0n/gemini" rel="noopener ugc nofollow" target="_blank">代码。</a></p><p id="7da4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相反，我想解释如何设置和使用 Github 和 Travis 的组合来开始集成测试。这样，如果你不使用<a class="ae jp" href="https://javarevisited.blogspot.com/2018/05/top-5-java-courses-for-beginners-to-learn-online.html" rel="noopener ugc nofollow" target="_blank"> Java </a>或<a class="ae jp" href="https://javarevisited.blogspot.com/2016/12/top-5-spring-and-hibernate-training-courses-java-jee-programmers.html" rel="noopener ugc nofollow" target="_blank"> Spring </a>你可以设置持续集成过程，用你自己的语言/命令替换它们。</p><p id="ce21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，您需要在 Github 存储库设置中启用 Travis Webhook(因此您需要一个 Travis 帐户)。</p><p id="971d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后只需在项目的根目录中提供一个合适的<strong class="ih hj"> .travis.yml </strong>。以下是我给双子座的。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="28dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这真的很简单:</p><ol class=""><li id="8af4" class="kr ks hi ih b ii ij im in iq kt iu ku iy kv jc kw kx ky kz bi translated">定义你正在使用的语言。在我的例子中，java 和 openjdk 10</li><li id="91d6" class="kr ks hi ih b ii la im lb iq lc iu ld iy le jc kw kx ky kz bi translated">然后在<em class="lf"> before_install </em>部分安装测试所需的工具和数据库。我需要<strong class="ih hj">格拉德</strong>和<strong class="ih hj"> postgreslq11 </strong></li><li id="16f3" class="kr ks hi ih b ii la im lb iq lc iu ld iy le jc kw kx ky kz bi translated"><em class="lf"> before_script </em>是初始化服务。我创建了我在集成测试中使用的数据库来连接</li><li id="df64" class="kr ks hi ih b ii la im lb iq lc iu ld iy le jc kw kx ky kz bi translated"><em class="lf">脚本</em>是开始测试流程的部分。例如，我清理了所有的 gradle 上下文，并运行了一个 gradle 任务<em class="lf"> jacocoRootReport </em>来编译所有内容，并开始测试我的 Spring 项目的每个子模块</li></ol><p id="8240" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仅此而已。Github 和 Travis 会完成剩下的工作。例如，看看拉取请求合并的结果…</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lg"><img src="../Images/797aa1e7a9fad65ea13e1b12a7e9ee02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9RYQTGwYkbhEDUKeguALYA.png"/></div></div></figure><p id="64df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他<strong class="ih hj">编程文章</strong>你可能喜欢的<br/><a class="ae jp" href="https://hackernoon.com/the-2019-web-developer-roadmap-ab89ac3c380e" rel="noopener ugc nofollow" target="_blank">2019 年 Web 开发者路线图</a><br/><a class="ae jp" href="https://javarevisited.blogspot.com/2018/05/10-reasons-to-learn-python-programming.html" rel="noopener ugc nofollow" target="_blank">2019 年学习 Python 的 10 个理由</a><br/><a class="ae jp" href="http://www.java67.com/2017/12/10-programming-languages-to-learn-in.html" rel="noopener ugc nofollow" target="_blank">2019 年你可以学习的 10 种编程语言</a> <br/> <a class="ae jp" href="http://www.java67.com/2018/04/10-tools-java-developers-should-learn.html" rel="noopener ugc nofollow" target="_blank">每个 Java 开发者都应该知道的 10 个工具</a> <br/> <a class="ae jp" href="http://javarevisited.blogspot.sg/2013/04/10-reasons-to-learn-java-programming.html" rel="noopener ugc nofollow" target="_blank">学习 Java 编程语言的 10 个理由</a><br/><a class="ae jp" href="http://javarevisited.blogspot.sg/2018/01/10-frameworks-java-and-web-developers-should-learn.html" rel="noopener ugc nofollow" target="_blank">Java 和 Web 开发者应该学习的 10 个框架 2019</a><br/><a class="ae jp" href="http://javarevisited.blogspot.sg/2018/04/top-5-java-frameworks-to-learn-in-2018_27.html" rel="noopener ugc nofollow" target="_blank">2019 年要学习的 5 大 Java 框架</a> <br/> <a class="ae jp" href="https://medium.freecodecamp.org/these-are-the-top-testing-tools-libraries-and-frameworks-for-java-developers-8c0e3f9bc11d" rel="noopener ugc nofollow" target="_blank">每个 Java 开发者都应该知道的 10 个测试库</a></p></div></div>    
</body>
</html>