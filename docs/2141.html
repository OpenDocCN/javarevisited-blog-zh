<html>
<head>
<title>How to Build a Custom Spring Boot Starter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建自定义Spring Boot启动器</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/how-to-build-a-custom-spring-boot-starter-1643fc33a903?source=collection_archive---------1-----------------------#2022-05-27">https://medium.com/javarevisited/how-to-build-a-custom-spring-boot-starter-1643fc33a903?source=collection_archive---------1-----------------------#2022-05-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9a04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的代码库可以使用spring boot自动配置。太酷了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://www.java67.com/2017/11/top-5-free-core-spring-mvc-courses-learn-online.html"><div class="er es jd"><img src="../Images/c4d2a96b0d04e1d8d13d6fa3a4af0fa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oaDY_9-i83NWWPSWfx2wIw.jpeg"/></div></a></figure><p id="0f6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一个企业java程序员，spring boot太方便了，我离不开它。它的<code class="du jl jm jn jo b">auto-configuration</code>特性允许我们通过几个简单的步骤运行您的应用程序。<a class="ae jp" rel="noopener" href="/javarevisited/10-free-spring-boot-tutorials-and-courses-for-java-developers-53dfe084587e"> Spring boot </a>提供了很多入门工具，让你的开发更快更简单。你不必担心复杂的配置和类库引用。以开发一个<a class="ae jp" rel="noopener" href="/javarevisited/top-5-books-and-courses-to-learn-restful-web-services-in-java-using-spring-mvc-and-spring-boot-79ec4b351d12?source=---------17------------------"> web服务</a>为例。</p><ul class=""><li id="3bbf" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">使用一些启动器依赖项，如<code class="du jl jm jn jo b">spring-boot-starter</code>和<code class="du jl jm jn jo b">spring-boot-starter-web</code></li><li id="504c" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">添加Webserver相关参数，如<code class="du jl jm jn jo b">server.port</code></li><li id="c870" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">启动服务器</li></ul><p id="edd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用<a class="ae jp" rel="noopener" href="/javarevisited/top-10-courses-to-learn-spring-boot-in-2020-best-of-lot-6ffce88a1b6e"> spring boot </a>来封装自己的入门库吗？答案是肯定的。那就是spring-boot，一个扩展性非常好的框架。</p><h2 id="513c" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">了解自动配置</h2><p id="7373" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">现在我们来试着了解一下<a class="ae jp" href="https://javarevisited.blogspot.com/2018/11/top-5-spring-boot-features-java.html" rel="noopener ugc nofollow" target="_blank"> spring boot的自动配置功能</a>的原理。要理解这一部分，需要对春开机豆的生命周期有具体的了解。</p><p id="06c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Spring boot使用<code class="du jl jm jn jo b"><a class="ae jp" href="https://www.java67.com/2018/05/difference-between-springbootapplication-vs-EnableAutoConfiguration-annotations-Spring-Boot.html" rel="noopener ugc nofollow" target="_blank">@EnableAutoConfiguration</a></code> <a class="ae jp" href="https://www.java67.com/2018/05/difference-between-springbootapplication-vs-EnableAutoConfiguration-annotations-Spring-Boot.html" rel="noopener ugc nofollow" target="_blank">注释</a>实现自动配置。这个注释导入了<code class="du jl jm jn jo b">autoconfigurationImportSelector</code>类，它在spring boot启动时解析<code class="du jl jm jn jo b">META-INF/spring.factories</code>文件，然后文件中的所有配置类都被加载到内存中，并注册到<a class="ae jp" href="https://javarevisited.blogspot.com/2012/12/inversion-of-control-dependency-injection-design-pattern-spring-example-tutorial.html" rel="noopener ugc nofollow" target="_blank"> spring容器</a>中。<code class="du jl jm jn jo b">spring.factories</code>文件是这样的。</p><pre class="je jf jg jh fd le jo lf lg aw lh bi"><span id="0899" class="ke kf hi jo b fi li lj l lk ll"># Auto Configure<br/>org.springframework.boot.autoconfigure.EnableAutoConfiguration=\<br/>org.springframework.boot.autoconfigure.aop.AopAutoConfiguration</span></pre><p id="c93e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<code class="du jl jm jn jo b"><a class="ae jp" href="https://javarevisited.blogspot.com/2012/11/difference-between-beanfactory-vs-applicationcontext-spring-framework.html" rel="noopener ugc nofollow" target="_blank">BeanFactory</a></code> <a class="ae jp" href="https://javarevisited.blogspot.com/2012/11/difference-between-beanfactory-vs-applicationcontext-spring-framework.html" rel="noopener ugc nofollow" target="_blank"> </a>被创建后，spring boot将调用一个特定的<code class="du jl jm jn jo b">beanFactoryPostProcessor</code> - <code class="du jl jm jn jo b">ConfigurationClassPostProcessor</code>来完成配置类解析。目的是将spring容器中配置类的<code class="du jl jm jn jo b"><a class="ae jp" href="https://www.java67.com/2021/10/pring-bean-example-what-does-bean-annotation-does.html" rel="noopener ugc nofollow" target="_blank">@Bean</a></code> <a class="ae jp" href="https://www.java67.com/2021/10/pring-bean-example-what-does-bean-annotation-does.html" rel="noopener ugc nofollow" target="_blank">注释</a>修改的方法注册为特殊beans。配置类中定义的beans由spring容器管理，我们可以用<a class="ae jp" rel="noopener" href="/javarevisited/5-advanced-spring-framework-books-experienced-java-developers-should-read-in-2020-best-of-lot-2a786fc5ad31?source=collection_home---4------4-----------------------"> spring </a>做任何事情。这就是弹簧靴的自动配置原理。</p><h2 id="4ae2" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">创建自定义初学者库</h2><p id="3935" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">首先，您需要创建一个spring项目。下面是我的例子中的pom.xml。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="9ab5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后创建您的自动配置类，并像这样在类上添加<a class="ae jp" href="https://javarevisited.blogspot.com/2019/02/difference-between-contextconfiguration-and-springapplicationConfiguration-annotations-in-spring-boot-testing.html#axzz7BnOZ1wuB" rel="noopener ugc nofollow" target="_blank"> @configuration </a>注释。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="a109" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个演示中，我创建了一个<code class="du jl jm jn jo b">MyAutoConfiguration</code>类，希望注入一个<code class="du jl jm jn jo b">UserManager</code>的java bean。</p><p id="f15d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，在<code class="du jl jm jn jo b">resources</code>目录下创建一个名为<code class="du jl jm jn jo b">META-INF</code>的目录，并创建一个名为<code class="du jl jm jn jo b">spring.factories</code>的文件，这个文件需要配置你的配置类。如下图所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://javarevisited.blogspot.com/2021/11/how-to-create-your-first-mvc-application-using-spring-mvc-.html"><div class="er es lo"><img src="../Images/0ddd161a34ba50180ffbab07ec8d2d35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EG7L-qa6PxaU2Lh_xRwQeA.png"/></div></a></figure><p id="3855" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">恭喜你。你的弹簧靴起动器已经准备好工作了。可以像这样在maven pom.xml中使用这个starter。</p><pre class="je jf jg jh fd le jo lf lg aw lh bi"><span id="d692" class="ke kf hi jo b fi li lj l lk ll">&lt;dependency&gt;<br/>        &lt;groupId&gt;com.lance.demo&lt;/groupId&gt;<br/>        &lt;artifactId&gt;my-spring-boot-starter&lt;/artifactId&gt;<br/>        &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;<br/>   &lt;/dependency&gt;</span></pre><p id="8b73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是运行这个应用程序的输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lp"><img src="../Images/5818ae646bd07c2bb46fc6498fbb4562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pga5ULe7EcLcQhclEdP3zw.png"/></div></div></figure><p id="a396" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在试着用spring boot打包你的类库。感谢阅读。</p><div class="lu lv ez fb lw lx"><a rel="noopener follow" target="_blank" href="/javarevisited/13-topics-you-should-prepare-for-your-next-spring-boot-interview-5f2993a04ff5"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">你应该为2022年的下一次Spring Boot面试准备的13个话题</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">你应该为下一次Java和Spring Boot面试准备的13个基本主题的列表和学习资源…</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">medium.com</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml jj lx"/></div></div></a></div><div class="lu lv ez fb lw lx"><a rel="noopener follow" target="_blank" href="/javarevisited/21-spring-mvc-rest-interview-questions-answers-for-beginners-and-experienced-developers-21ad3d4c9b82"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">10大春季MVC + REST面试问题解答适合初学者和有经验的开发者</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">大家好。如果你正在准备Java和Spring面试或Spring认证，并经常寻找一些…</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">medium.com</p></div></div><div class="mg l"><div class="mm l mi mj mk mg ml jj lx"/></div></div></a></div><div class="lu lv ez fb lw lx"><a rel="noopener follow" target="_blank" href="/javarevisited/top-22-skills-professional-java-programmers-can-learn-in-2022-to-upgrade-themselves-bc3da73d7491"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">2022年Java程序员和架构师可以学习的25项基本技能</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">Java开发人员可以在2022年学习的22项基本技术技能，以进一步改善他们的形象，并成为…</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">medium.com</p></div></div><div class="mg l"><div class="mn l mi mj mk mg ml jj lx"/></div></div></a></div></div></div>    
</body>
</html>