<html>
<head>
<title>Light up your Christmas lights with Java and Raspberry Pi — JVM Advent</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Java和Raspberry Pi点亮你的圣诞之灯——JVM降临节</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/light-up-your-christmas-lights-with-java-and-raspberry-pi-jvm-advent-4148f99f29e5?source=collection_archive---------1-----------------------#2020-12-19">https://medium.com/javarevisited/light-up-your-christmas-lights-with-java-and-raspberry-pi-jvm-advent-4148f99f29e5?source=collection_archive---------1-----------------------#2020-12-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="630d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你是一个认真的Java开发者，正在寻找一个有趣的项目吗？或者想学习一些全新的东西，用你的Java知识来控制电子元件？在这里，我们通过这个小项目向您介绍电子编程的世界！</p><p id="c11b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们要打造“Hello World”——相当于一个电子项目:一个闪烁的LED。更具挑战性的是，不只是闪烁一个LED，而是一棵“完整的”圣诞树，嗯…至少有7个闪烁的圣诞彩灯。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><p id="960b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们开始吧！</p><h1 id="605b" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">树莓派</h1><p id="587b" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">Raspberry Pi是一款小型主板上的全PC。有不同的类型，但是在本文中我们将使用一个Raspberry Pi 4模型B。该主板提供3种不同的内存大小(2、4或8Gb ),起价35美元。您可以在<a class="ae kn" href="https://www.raspberrypi.org/products/raspberry-pi-4-model-b" rel="noopener ugc nofollow" target="_blank">产品页面</a>上找到当地或在线经销商。</p><h1 id="1078" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">操作系统</h1><p id="c539" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">如果你买了一个新的树莓派，确保你还有一个最小16Gb的迷你SD卡。用<a class="ae kn" href="https://www.raspberrypi.org/software/" rel="noopener ugc nofollow" target="_blank">成像仪工具</a>，可以把“树莓Pi OS (Full)”刻录到这张卡上。这是一个完整的操作系统，基于Debian 32bit，包含了很多工具，最重要的是OpenJDK 11！</p><div class="jd je jf jg fd ab cb"><figure class="ko jh kp kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/df49931bda09783b9aa2fe9b40abb833.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*8tRVLLLpm59fF8WfzpJ83A.png"/></div></figure><figure class="ko jh la kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/6d838a933c2d23963e8d0ffe93db4a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*-qgIU5oMFamvfSlnexWasQ.png"/></div></figure><figure class="ko jh lb kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/5c10ff6aeec4d81649d143ea52232948.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*lphMdoIEkVW4oBa5WTdlhw.png"/></div></figure></div><p id="bae3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您第一次启动您的主板时，您需要配置Wifi和一些附加设置。完成后，打开一个终端并运行<code class="du lc ld le lf b">java -version</code>以确保您使用了正确的操作系统。</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="a93d" class="lk jl hi lf b fi ll lm l ln lo">$ java -version <br/>openjdk version "11.0.9" 2020-10-20 <br/>OpenJDK Runtime Environment (build 11.0.9+11-post-Raspbian-1deb10u1) <br/>OpenJDK Server VM (build 11.0.9+11-post-Raspbian-1deb10u1, mixed mode)</span></pre><h1 id="3721" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">新产品2020</h1><p id="cb6c" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">需要提一下2020年(后期)发布的两款重要新品！</p><h2 id="a41a" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">计算模块4</h2><p id="3500" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">计算模块是Raspberry Pi的特殊版本。它根本没有外围设备的连接，而是需要与一个“基板”相结合，你可以购买，也可以自己设计。该产品的目标是以合适的外形构建您自己的设备，并提供您需要的连接。</p><p id="e3df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，它的目标不是简单的DIY，而是作为一台基础计算机集成到专业项目中。</p><p id="1a6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个新版本4基于Raspberry Pi 4，有32种版本可用<a class="ae kn" href="https://www.raspberrypi.org/products/compute-module-4" rel="noopener ugc nofollow" target="_blank">，有一系列RAM和eMMC闪存选项，有或没有无线连接。</a></p><div class="jd je jf jg fd ab cb"><figure class="ko jh mc kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/7ab48300fdaba70ec40a5b707ccf0cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*r4k49J_L_UFO1mQjIVTGpg.jpeg"/></div></figure><figure class="ko jh md kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/ff8ee3595c3f974efd4afe0ce79cddcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*VegelbJo--No5IUalyLX5w.jpeg"/></div></figure><figure class="ko jh me kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/a8166ad92dd94bf5500dbe02434a9255.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*zo1IT-ogKgN3cIm0tbV8Kw.jpeg"/></div></figure></div><h2 id="b687" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">树莓派400</h2><p id="7aec" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">这个产品让我想起了35年前我的第一台电脑，Commodore 64…这是一个集成了键盘的电脑！拥有4Gb内存的Raspberry Pi 4经过了重新设计，以适应官方已经存在的Raspberry Pi键盘。你只需要一个SD卡，电源，显示器和鼠标。对于75€来说，这确实是一台神奇的机器，以低廉的预算为每个人带来了强大的计算能力。</p><div class="jd je jf jg fd ab cb"><figure class="ko jh mf kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/3eb32d5f70ef236f5cca0f288b26f876.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*F5c5Z-KDmW-HEYHDVY8cVw.jpeg"/></div></figure><figure class="ko jh mf kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/ecc66ade08a0fa41fabc68f411f0a944.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*GTVvbRYHKZ3QP7me4Rsd7Q.jpeg"/></div></figure><figure class="ko jh mg kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/db0420c4bbe137fe37541776d6b8970a.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*LVqujelFF5NA3TEp3whfSA.png"/></div></figure></div><h1 id="281f" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">安装附加工具</h1><p id="ecd5" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">好了，我们有一个树莓派，下一个是什么？让我们给它添加一些开发人员的东西…</p><h2 id="3e1b" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">IDE</h2><p id="0641" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在大多数情况下，我在PC上为Raspberry Pi开发我的应用程序，因为我更喜欢使用IntelliJ IDEA T1，不幸的是，它不适用于Pi。但是如果您想在Pi本身上工作，您可以安装带有Java扩展的Visual Studio代码，这是完全可能的！欲了解更多信息，请参阅这篇文章“<a class="ae kn" href="https://webtechie.be/post/2020-10-15-visual-studio-code-on-raspberry-pi/" rel="noopener ugc nofollow" target="_blank">树莓Pi上的Visual Studio代码(32和64位操作系统)</a>”。</p><h2 id="a47e" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">专家</h2><p id="b7a8" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">我们将使用<a class="ae kn" rel="noopener" href="/javarevisited/6-best-maven-courses-for-beginners-in-2020-23ea3cba89"> Maven </a>在我们的Pi上构建应用程序，所以让我们用一个命令安装它，之后我们可以通过请求版本来立即检查安装:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="cb69" class="lk jl hi lf b fi ll lm l ln lo">$ sudo apt install maven <br/>$ mvn -v <br/>Apache Maven 3.6.0 <br/>Maven home: /usr/share/maven</span></pre><h2 id="66a7" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">Pi4J</h2><p id="e04f" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">为了控制LED灯，我们将使用Pi4J库，它是Java代码和Raspberry Pi上的GPIO引脚之间的桥梁。这些通用输入/输出引脚允许我们连接和控制电子元件。树莓皮上有40个这样的针，可以用于不同的目的。在这篇文章中，我们只使用它们作为输出引脚来控制led，但还有无数其他的可能性。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mh"><img src="../Images/917d59056652c31dbc3d902a3a13da1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/0*SkFORqNeDfjTUOzl"/></div></figure><p id="a69e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了完全支持Pi4J库，我们需要在板上安装一些额外的软件。同样，我们只需要一个命令就可以做到这一点:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="9eb8" class="lk jl hi lf b fi ll lm l ln lo">$ curl -sSL <a class="ae kn" href="https://pi4j.com/install" rel="noopener ugc nofollow" target="_blank">https://pi4j.com/install</a> | sudo bash</span></pre><h2 id="ac61" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">WiringPi的更新</h2><p id="11ec" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">做好充分准备的最后一步…如果你使用的是Raspberry Pi 4，你需要更新WiringPi。Pi4J使用它作为本地库来控制GPIOs，因为在版本4上片上系统的架构已经改变，所以WiringPi的新版本(<a class="ae kn" href="http://wiringpi.com/wiringpi-deprecated/" rel="noopener ugc nofollow" target="_blank">但最终版本</a>)2.52已经发布:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="84fd" class="lk jl hi lf b fi ll lm l ln lo">$ wget <a class="ae kn" href="https://project-downloads.drogon.net/wiringpi-latest.deb" rel="noopener ugc nofollow" target="_blank">https://project-downloads.drogon.net/wiringpi-latest.deb</a> <br/>$ sudo dpkg -i wiringpi-latest.deb <br/>$ gpio -v <br/>gpio version: 2.52</span></pre><h1 id="cc7d" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">布线</h1><p id="889e" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">这是一个电子项目，所以我们需要将一些组件连接到我们的Raspberry Pi。我使用了一些基本的，你会在任何<a class="ae kn" href="https://www.ebay.com/sch/i.html?_from=R40&amp;_trksid=p2380057.m570.l1313&amp;_nkw=electronics+starter+kit&amp;_sacat=0" rel="noopener ugc nofollow" target="_blank">电子初学者工具包</a>中找到的:发光二极管和330ω电阻。结合试验板和一些电线，你可以很容易地建立一个这样的项目。</p><p id="a45f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个LED都连接到正极的GPIO，并通过一个电阻连接到LED负极的共享地。我们之所以使用电阻，是因为GPIOs在假/关/低状态下以0V工作，在真/开/高状态下以3.3V工作，但大多数led设计用于更低的电压。</p><p id="ce23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以计算每种LED类型的确切电阻值，但我们对所有LED使用相同的电阻值。也许它们不会完全发光，但至少我们不会烧掉它们:-)。</p><p id="0ba6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">顺便说一下，谷歌和苹果应用商店中甚至有一个JavaFX移动应用程序用于这种计算，请参见“<a class="ae kn" href="https://webtechie.be/post/2020-11-24-javafx-gluon-mobile-github-actions/" rel="noopener ugc nofollow" target="_blank">使用Gluon Mobile和GitHub操作从单个JavaFX项目中为所有PC和移动平台构建原生应用程序</a>”。</p><div class="jd je jf jg fd ab cb"><figure class="ko jh mi kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/93c306024ba688390f280cda21b0ed75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*XFqFQpn9uYEuqQg3kQLY0w.jpeg"/></div></figure><figure class="ko jh mi kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/ef299aa4ccfe390224c6f096bfc0f83b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*fHeHO8bUuQcfRc3SuuFv9w.jpeg"/></div></figure></div><div class="ab cb"><figure class="ko jh mj kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/731ac3aa47cf134b90771cf22200d841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*BUAbwH_RRYVdKh-T1ica6w.jpeg"/></div></figure><figure class="ko jh mk kq kr ks kt paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/7e419d836db983c1a1614a4ce60db7e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*mWemgekd-nzm5ft9Vcoqbg.png"/></div></figure></div><h1 id="0445" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">应用程序</h1><p id="93a3" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">TL；DR；运行这些命令直接在您的Raspberry Pi上构建并启动应用程序:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="459e" class="lk jl hi lf b fi ll lm l ln lo">$ git clone <a class="ae kn" href="https://github.com/FDelporte/JvmAdvent2020.git" rel="noopener ugc nofollow" target="_blank">https://github.com/FDelporte/JvmAdvent2020.git</a> <br/>$ cd JvmAdvent2020 <br/>$ mvn package <br/>$ sudo java -jar target/jvm-advent-2020-1.0-SNAPSHOT-jar-with-dependencies.jar</span></pre><h1 id="0707" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">Maven依赖性</h1><p id="aed0" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">这是一个Maven项目，Pi4J-library是作为pom.xml中的一个依赖项添加的:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="4f52" class="lk jl hi lf b fi ll lm l ln lo">&lt;dependency&gt;<br/>   &lt;groupId&gt;com.pi4j&lt;/groupId&gt;<br/>   &lt;artifactId&gt;pi4j-core&lt;/artifactId&gt;<br/>   &lt;version&gt;1.2&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><h1 id="b105" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">脉宽调制（pulse-width modulating的缩写）</h1><p id="7e78" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">LED最简单的用法是打开或关闭，但我们将通过PWM(脉宽调制)信号来使用它们。这样，我们也可以让它们从零到全亮度渐入渐出。PWM在低电平和高电平之间快速切换。根据低电平和/或高电平状态的持续时间，可以通过创建平均值来实现“半模拟输出”。这种情况下使用的值是:</p><ul class=""><li id="26f7" class="ml mm hi ih b ii ij im in iq mn iu mo iy mp jc mq mr ms mt bi translated">导通时间:输出为高电平的持续时间</li><li id="6878" class="ml mm hi ih b ii mu im mv iq mw iu mx iy my jc mq mr ms mt bi translated">关断时间:输出为低的持续时间</li><li id="bf2f" class="ml mm hi ih b ii mu im mv iq mw iu mx iy my jc mq mr ms mt bi translated">周期:工作时间+非工作时间</li><li id="78f5" class="ml mm hi ih b ii mu im mv iq mw iu mx iy my jc mq mr ms mt bi translated">占空比:输出为高的时间百分比</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mz"><img src="../Images/c9077ffb88d40c500ad7bf96558761e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/0*lNnXlBHCUg7gzKdn"/></div></figure><p id="7f7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Raspberry Pi有几个GPIOs提供硬件控制的PWM，您需要使用它来获得精确的信号。但在我们的例子中，我们将使用软件控制的PWM，因为我们希望使用更多的led。</p><p id="6087" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要知道需要使用哪些GPIO号，您可以查看上面的引脚布局图并使用接线号。</p><h2 id="93c7" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">led的初始化</h2><p id="9372" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在我们的代码中，我们使用了一个GpioPinPwmOutput列表，并添加了我们正在使用的所有引脚。引脚32仅支持硬件PWM，因此需要初始化如下:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="9797" class="lk jl hi lf b fi ll lm l ln lo">List&lt;GpioPinPwmOutput&gt; leds = new ArrayList&lt;&gt;(); <br/>leds.add(gpio.provisionSoftPwmOutputPin(<br/>   RaspiPin.GPIO_04, "LeftGreen")); // Pin 16 <br/>leds.add(gpio.provisionSoftPwmOutputPin(<br/>   RaspiPin.GPIO_05, "LeftBlue")); // Pin 18 <br/>leds.add(gpio.provisionSoftPwmOutputPin(<br/>   RaspiPin.GPIO_06, "LeftRed")); // Pin 22 <br/>leds.add(gpio.provisionSoftPwmOutputPin(<br/>   RaspiPin.GPIO_10, "Top")); // Pin 24 leds.add(gpio.provisionSoftPwmOutputPin(<br/>   RaspiPin.GPIO_11, "LedRightGreen")); // Pin 26 <br/>leds.add(gpio.provisionSoftPwmOutputPin(<br/>   RaspiPin.GPIO_31, "RightYellow")); // Pin 28 <br/>leds.add(gpio.provisionPwmOutputPin(<br/>   RaspiPin.GPIO_26, "RightRed")); // Pin 32</span></pre><p id="c0a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们使用软件PWM，我们还需要做一些配置:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="4dce" class="lk jl hi lf b fi ll lm l ln lo">int PWM_MAX = 100; <br/>Gpio.pwmSetMode(Gpio.PWM_MODE_MS); <br/>Gpio.pwmSetRange(PWM_MAX); <br/>Gpio.pwmSetClock(500);</span></pre><h2 id="b13d" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">全部打开或关闭</h2><p id="3b1b" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">使用列表的forEach功能，打开或关闭所有led变得非常简单:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="a798" class="lk jl hi lf b fi ll lm l ln lo">private static void allOff() { <br/>   leds.forEach(l -&gt; l.setPwm(0)); <br/>} <br/>private static void allOn() { <br/>   leds.forEach(l -&gt; l.setPwm(PWM_MAX)); <br/>}</span></pre><h2 id="d1bf" class="lk jl hi bd jm lp lq lr jq ls lt lu ju iq lv lw jy iu lx ly kc iy lz ma kg mb bi translated">衰退</h2><p id="9462" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">通过增加或减少PWM值，我们可以使led变暗，例如，从0到最大值一个接一个地变暗:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="f07d" class="lk jl hi lf b fi ll lm l ln lo">for (GpioPinPwmOutput led : leds) { <br/>   for (int fade = 0; fade &lt;= PWM_MAX; fade += fadeSteps) { <br/>      led.setPwm(fade); <br/>      Thread.sleep(speed); <br/>   } <br/>}</span></pre><h1 id="e47d" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">构建和运行</h1><p id="0a67" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">完整的代码包含了更多的LED方法，所以看一看它，找出已经存在的内容。从<a class="ae kn" rel="noopener" href="/javarevisited/7-best-courses-to-master-git-and-github-for-programmers-d671859a68b2"> GitHub </a>获取完整的Maven项目，打包并直接在Raspberry Pi上运行，命令如下:</p><pre class="jd je jf jg fd lg lf lh li aw lj bi"><span id="d405" class="lk jl hi lf b fi ll lm l ln lo">$ git clone <a class="ae kn" href="https://github.com/FDelporte/JvmAdvent2020.git" rel="noopener ugc nofollow" target="_blank">https://github.com/FDelporte/JvmAdvent2020.git</a><br/>$ cd JvmAdvent2020<br/>$ mvn package<br/>$ sudo java -jar target/jvm-advent-2020-1.0-SNAPSHOT-jar-with-dependencies.jar<br/>...<br/>Warming up...<br/>LEDs initialized<br/>All flash 5 times at speed 250<br/>All off<br/>All on<br/>...<br/>One by one on and then off 5 times at speed 100<br/>All off<br/>All random flash 20 times at speed 500<br/>All off<br/>All fade at speed 50 with steps of 2<br/>Fading all up<br/>Fading all down<br/>All off<br/>Fade one by one at speed 25 with steps of 2<br/>Fading up GPIO 4<br/>Fading up GPIO 5<br/>...<br/>Fading down GPIO 31<br/>Fading down GPIO 26<br/>All off<br/>Done</span></pre><p id="5667" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是应用程序的日志，正如你在本文开头的电影中看到的那样，它控制着发光二极管。</p><h1 id="9f0b" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">下一步是什么？</h1><p id="2370" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">你不得不同意，这是一个完美的，有趣的，圣诞假期的小项目，不是吗？！</p><h1 id="b0e4" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">实验！</h1><p id="5ae0" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">这只是演示GPIOs的一个单一用途的起点。我们仅使用引脚作为输出来控制一些LED，但您也可以使用按钮作为输入来选择LED效果。或者附加更多的led，或者用<a class="ae kn" href="https://webtechie.be/post/2019-12-18-controlling-a-led-number-display-with-javafx-and-python-on-raspberry-pi/" rel="noopener ugc nofollow" target="_blank">一个芯片用更少的gpio</a>控制更多的led……真的，可能性是无穷无尽的，只受限于你的想象力。</p><p id="b0f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你创造了什么，请分享。在Twitter上使用标签<a class="ae kn" href="https://twitter.com/hashtag/JavaOnRaspberryPi" rel="noopener ugc nofollow" target="_blank"># JavaOnRaspberryPi</a>向世界展示Java + Raspberry Pi的魔力。</p><h1 id="45ab" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">想了解更多？</h1><p id="c7be" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">今年，我出版了我的书《<a class="ae kn" href="https://webtechie.be/books/" rel="noopener ugc nofollow" target="_blank">在树莓派</a>上开始使用Java》，以激励更多的Java开发人员开始尝试电子元件。当你把你的软件知识和硬件结合起来时，这是学习新东西的一个很棒很有趣的方法！Leanpub上的电子书<a class="ae kn" href="https://leanpub.com/gettingstartedwithjavaontheraspberrypi/" rel="noopener ugc nofollow" target="_blank">和Elektor </a>上的纸质书<a class="ae kn" href="https://www.elektor.com/getting-started-with-java-on-the-raspberry-pi" rel="noopener ugc nofollow" target="_blank">均有售。一份完美的圣诞礼物…😉</a></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es na"><img src="../Images/294f2a7248e89d2660e0a4aa64847254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*oYbu378RKQL95O3Y"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nb"><img src="../Images/03821a10e4e064dce9405cb62edf47e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:160/0*9Usz0yP1ql6KLmvw"/></div></figure></div><div class="ab cl nc nd gp ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="hb hc hd he hf"><p id="2611" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="nj">原载于2020年12月19日https://www.javaadvent.com</em><a class="ae kn" href="https://www.javaadvent.com/2020/12/light-up-your-christmas-lights-with-java-and-raspberry-pi.html" rel="noopener ugc nofollow" target="_blank"><em class="nj"/></a><em class="nj">。</em></p></div></div>    
</body>
</html>