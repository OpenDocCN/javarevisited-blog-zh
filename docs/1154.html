<html>
<head>
<title>Run Groovy Within Uber JAR Using Maven</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Maven在优步JAR中运行Groovy</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/run-groovy-within-uber-jar-using-maven-646e9864b0a4?source=collection_archive---------3-----------------------#2021-04-16">https://medium.com/javarevisited/run-groovy-within-uber-jar-using-maven-646e9864b0a4?source=collection_archive---------3-----------------------#2021-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="5975" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">创建一个混合了Groovy和Java代码的可执行JAR</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/a5e775f8d266cee0eb3ee31e01a2efc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uXCu0yhUqUO_j6mu"/></div></div><p class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae jn" href="https://unsplash.com/@vidarnm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">维达尔·诺德里-马西森</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="eea0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">从命令行运行Groovy脚本相对简单:惟一的先决条件是安装了Groovy二进制文件，然后可以使用运行任何Groovy脚本。甚至依赖项管理也很容易——只需用@Grape和<a class="ae jn" href="http://docs.groovy-lang.org/latest/html/documentation/grape.html" rel="noopener ugc nofollow" target="_blank"> Groovy的Grape </a>机制为您完成完整的依赖项检索过程。</p><p id="4724" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">但是，有时事情会更复杂，您可能会混合使用Java和Groovy代码、一些外部依赖项，甚至可能是资源文件。在这种情况下，上述方法将不起作用，您可能需要求助于使用所谓的“uber JAR ”,通过构建一个可执行文件，在一个包中包含您需要的所有内容，从而使您的部署更加容易。</p><h1 id="7ebf" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">优步罐子</h1><p id="41a2" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">超级JAR是一个普通术语，指稍微升级的JAR，它不仅包含您的代码，还包含您的代码所依赖的所有依赖项，所有这些都打包在一个JAR文件中。这是打包应用程序的一种非常方便的方式，只需使用几个命令就可以轻松部署和运行。</p><p id="0b2b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，一旦您将您的uber JAR文件复制到目标位置，运行您的应用程序就变得非常容易:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="9dab" class="lm kl hi li b fi ln lo l lp lq">java -jar uber.jar</span></pre><p id="8bd4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这很简单，不是吗？</p><p id="43cf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">一些框架，如<a class="ae jn" rel="noopener" href="/javarevisited/top-10-courses-to-learn-spring-boot-in-2020-best-of-lot-6ffce88a1b6e"> Spring Boot </a>不费吹灰之力就能给你超级罐子。然而，如果您有一个普通的旧Java应用程序，事情就不再那么简单了。</p><p id="030b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">本指南将向您展示当您拥有一个包含多个依赖项的项目时，如何创建uber JARs。为了使事情稍微复杂一点，让我们假设一个Groovy文件而不是Java文件包含您的main方法。</p><h1 id="107e" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">编译Groovy代码</h1><p id="35cd" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">默认情况下，Maven将只编译存储在<code class="du lr ls lt li b">src/main/java</code>下的Java代码。不过，通常情况下，那里不会有任何Groovy代码。您将把您的<a class="ae jn" href="https://javarevisited.blogspot.com/2017/08/top-5-books-to-learn-groovy-for-java.html" rel="noopener ugc nofollow" target="_blank"> Groovy </a>存储在<code class="du lr ls lt li b">src/main/groovy</code>中。</p><p id="8eba" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">要编译Groovy代码，第一步是添加Groovy依赖项，然后指示<a class="ae jn" rel="noopener" href="/javarevisited/6-best-maven-courses-for-beginners-in-2020-23ea3cba89"> Maven </a>在哪里找到Groovy类，以便它可以编译它们。您还需要包含Groovy编译器插件:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lu lv l"/></div><p class="jj jk et er es jl jm bd b be z dx translated">启动POM文件来编译Groovy代码</p></figure><p id="3f90" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，让我们用main方法创建一个Groovy文件。为简单起见，我们将它直接存储在根包中:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lu lv l"/></div><p class="jj jk et er es jl jm bd b be z dx translated">带有main方法的Groovy脚本示例</p></figure><h1 id="cfa3" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">组装JAR文件</h1><p id="c783" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">为了创建实际的JAR文件，我们将使用<a class="ae jn" href="http://maven.apache.org/plugins/maven-assembly-plugin/" rel="noopener ugc nofollow" target="_blank"> Maven汇编插件</a>。只需几个配置设置，这个插件就允许您创建uber JARs，其中不仅包括您的Java/Groovy代码，还包括您的代码所依赖的所有依赖项(以及它们的依赖项——完整的树)。</p><p id="e18c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">添加Maven汇编插件后，POM文件将如下所示:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lu lv l"/></div><p class="jj jk et er es jl jm bd b be z dx translated">完整的POM文件，带有Maven汇编插件</p></figure><p id="bb94" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里有两点需要注意。首先，在<code class="du lr ls lt li b">mainClass</code>元素中引用了主类:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="96b1" class="lm kl hi li b fi ln lo l lp lq">&lt;mainClass&gt;Main&lt;/mainClass&gt;</span></pre><p id="34ab" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果<code class="du lr ls lt li b">Main</code>类属于一个包，那么您需要在它前面加上包名。比如:<code class="du lr ls lt li b">a.b.c.Main</code></p><p id="8d99" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第二个有趣的元素是<code class="du lr ls lt li b">finalName</code>元素。该元素指定组装的JAR的名称。在我们的例子中，这个<a class="ae jn" href="https://javarevisited.blogspot.com/2017/06/how-to-get-jar-files-of-jackson-libary-for-JSON.html" rel="noopener ugc nofollow" target="_blank">罐子</a>将被命名为<code class="du lr ls lt li b">uber.jar</code>。</p><h1 id="5a62" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">包装和运行</h1><p id="6d56" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">就是这样。现在，在运行JAR之前，您需要通过运行<code class="du lr ls lt li b">mvn package</code>来创建它，JAR将在Maven包阶段创建。一旦有了JAR，就可以将它部署到目标环境中，并使用Java二进制文件及其<code class="du lr ls lt li b">-jar</code>标志来运行它:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="c3fd" class="lm kl hi li b fi ln lo l lp lq">java -jar uber.jar</span></pre></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="998f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢阅读！我希望你觉得这个指南有用。Maven Assembly Plugin只是允许您创建可执行jar的插件之一。另一个流行的插件是Maven Shade插件。两个插件都很好，尽管它们的配置有很大不同。由你决定哪一个更适合你的用例。</p></div></div>    
</body>
</html>