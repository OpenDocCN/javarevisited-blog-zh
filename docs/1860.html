<html>
<head>
<title>How to shuffle a deck of cards</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何洗牌</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/how-to-shuffle-a-deck-of-cards-d6e60ed234ac?source=collection_archive---------0-----------------------#2022-01-02">https://medium.com/javarevisited/how-to-shuffle-a-deck-of-cards-d6e60ed234ac?source=collection_archive---------0-----------------------#2022-01-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="504a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">洗牌对任何玩过纸牌游戏的人来说听起来都很平常。这可能是人们坐下来打牌时做的第一件事。我们为什么要洗牌？—这样，在我们开始玩之前，牌组中的任何现有图案都应该消失！这听起来可能微不足道，但对于像赌场这样人们玩游戏并涉及金钱的地方，随机洗牌<strong class="ih hj"><em class="jd"/></strong>是极其重要的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/280539133a1b61ac3476274740e009fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GstTtYH9MThV23Yl"/></div></div><p class="jq jr et er es js jt bd b be z dx translated">照片由<a class="ae ju" href="https://unsplash.com/@amoltyagi2?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿莫尔·泰亚吉</a>在<a class="ae ju" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="3b01" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">什么是随机洗牌？</h1><p id="510d" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">简单来说，随机洗牌就是<strong class="ih hj"> <em class="jd">所有可能的排序都是同等可能性</em> </strong>的洗牌。如果不是，人们可以利用一些组合比其他组合更可能出现的事实。这可能导致<strong class="ih hj">在游戏中作弊，有足够经验的人知道某些排序或排列可以给他们更好的获胜机会</strong>！你可以阅读<a class="ae ju" href="https://www.developer.com/guides/how-we-learned-to-cheat-at-online-poker-a-study-in-software-security/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="jd">在线扑克</em> </strong> </a>的一个例子，他们描述了洗牌算法如何不产生随机结果！</p><h1 id="acc8" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">洗牌的正确方法</h1><p id="c09a" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">让我们假设我们有一个包含整数的大小为N的数组A，而不是一副卡片。对于一副牌，N应该是52，但是让我们考虑一个一般的情况。</p><h1 id="1f74" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><strong class="ak">克努特洗牌</strong></h1><p id="4bd7" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">使用的技术被称为“Knuth洗牌”。它包括<a class="ae ju" href="https://www.java67.com/2018/12/how-to-remove-objects-or-elements-while-iterating-Arraylist-java.html" rel="noopener ugc nofollow" target="_blank">迭代数组</a>,同时执行以下操作—</p><ol class=""><li id="2415" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">对于数组中可以从0到N-1变化的任何索引I(因为N是数组中元素的数量)，<strong class="ih hj">我们在I和N-1之间挑选一个随机索引，即来自数组的不可见部分的随机索引。</strong></li><li id="5044" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">交换一个[randomIndexFromUnseenPart]和一个[i]。</li></ol><p id="4305" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">这种算法用在不同的口味，也叫</strong><a class="ae ju" href="https://en.wikipedia.org/wiki/Fisher–Yates_shuffle" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">‘费雪-耶茨洗牌’</strong></a>。</p><h2 id="465a" class="lm jw hi bd jx ln lo lp kb lq lr ls kf iq lt lu kj iu lv lw kn iy lx ly kr lz bi translated">履行</h2><p id="7b18" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">正如我一直做的那样，我将坚持用<a class="ae ju" rel="noopener" href="/javarevisited/10-best-places-to-learn-java-online-for-free-ce5e713ab5b2"> Java </a>展示实现。</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="4e1d" class="lm jw hi mb b fi mf mg l mh mi">public void shuffleRandom(int[] deck) {</span><span id="1499" class="lm jw hi mb b fi mj mg l mh mi">   for(int i=0; i&lt;N; i++) {</span><span id="5d2c" class="lm jw hi mb b fi mj mg l mh mi">     /*<br/>        Generate random number between i and N(exclusive).<br/>        You can also use <strong class="mb hj"><em class="jd">nextInt()</em></strong> method of <a class="ae ju" href="https://docs.oracle.com/javase/8/docs/api/java/util/Random.html" rel="noopener ugc nofollow" target="_blank">Random</a> class<br/>        in java, instead of Math.random()<br/>     */<br/>     int randomIndexFromUnseenPart = i + (int)((N-i)*Math.random());<br/>     <br/>     // Swap with deck[i]<br/>     int temp = deck[i];<br/>     deck[i] = deck[randomIndexFromUnseenPart];<br/>     deck[randomIndexFromUnseenPart] = temp;<br/>   }<br/>}</span></pre><h2 id="9185" class="lm jw hi bd jx ln lo lp kb lq lr ls kf iq lt lu kj iu lv lw kn iy lx ly kr lz bi translated">从看不见的部分计算随机指数</h2><p id="ad2a" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">让我们看看上面的代码片段，其中有这样一行—</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="94d6" class="lm jw hi mb b fi mf mg l mh mi">int randomIndexFromUnseenPart = i + (int)((N-i)*Math.random());</span></pre><p id="f7f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何保证这不会导致数组索引问题？它会超过N(索引越界)吗？！让我们来看一个快速证明—</p><p id="0fb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Math.random()生成一个介于0(含)和1(不含)之间的数字</p><p id="24f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之—</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="3b93" class="lm jw hi mb b fi mf mg l mh mi"> 0 &lt;= Math.random() &lt; 1</span></pre><p id="4cd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">为简单起见，我们将Math.random()的结果称为k。</strong></p><p id="e39d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="1f5a" class="lm jw hi mb b fi mf mg l mh mi">0 &lt;= k &lt; 1</span></pre><p id="1e65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们<strong class="ih hj">将上述不等式的所有方面乘以(N-i) </strong>，这给出—</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="e3fc" class="lm jw hi mb b fi mf mg l mh mi">0 &lt;= (N-i)*k &lt; N-i</span></pre><p id="ec1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，让我们把I加到所有边上</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="77ed" class="lm jw hi mb b fi mf mg l mh mi"> i &lt;= i + (N-i)*k &lt; N</span></pre><p id="591b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">看不等式的中项！！—不是和</strong>一样吗</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="85f4" class="lm jw hi mb b fi mf mg l mh mi">int randomIndexFromUnseenPart = i + (int)((N-i)*Math.random());</span></pre><p id="32b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此我们可以有把握地说</p><pre class="jf jg jh ji fd ma mb mc md aw me bi"><span id="1b50" class="lm jw hi mb b fi mf mg l mh mi">i &lt;=  randomIndexFromUnseenPart &lt; N</span></pre><p id="13ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">好啦！所以没有数组索引问题！</strong></p><p id="e53f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于一副普通的纸牌，N=52。下一次有人让你高效地洗牌时，你知道如何在线性时间内完成— <strong class="ih hj"> <em class="jd">即O(N)！！</em>T15】</strong></p></div></div>    
</body>
</html>