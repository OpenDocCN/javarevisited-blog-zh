<html>
<head>
<title>JVM Garbage Collection Logs— Basics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JVM垃圾收集日志—基础知识</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/jvm-garbage-collection-logs-basics-2dc2bc364c41?source=collection_archive---------1-----------------------#2021-01-05">https://medium.com/javarevisited/jvm-garbage-collection-logs-basics-2dc2bc364c41?source=collection_archive---------1-----------------------#2021-01-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/393de34c0f2af0a776b49e01b4ac3bca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*9zk3h0KrYfisyUeZG1_tfg.jpeg"/></div><p class="im in et er es io ip bd b be z dx translated"><a class="ae iq" href="https://unsplash.com/@ningshi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">宁石</a>在<a class="ae iq" href="https://unsplash.com/s/photos/collection?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="c21c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">JVM垃圾收集期间发生了很多事情。GC日志是最接近的目击者😄并在事件发生时记录下来。通过查看这些日志，我们将能够了解我们的应用对于给定场景、配置和/或负载的表现如何。</p><p id="767c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">会得到回答的典型问题有</p><ul class=""><li id="3de2" class="jp jq hi it b iu iv iy iz jc jr jg js jk jt jo ju jv jw jx bi translated">全GC太多了吗？</li><li id="da69" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated">有停顿时间长的GC吗？</li><li id="1710" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated">GCs发生的太频繁了吗？</li></ul><blockquote class="kd ke kf"><p id="1906" class="ir is kg it b iu iv iw ix iy iz ja jb kh jd je jf ki jh ji jj kj jl jm jn jo hb bi translated"><a class="ae iq" href="https://www.slideshare.net/PoonamBajaj5/lets-learn-to-talk-to-gc-logs-in-java-9" rel="noopener ugc nofollow" target="_blank">让我们学习在Java 9 </a>中与GC日志对话</p></blockquote><p id="76ac" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们将使用一个简单的Java程序探索GC日志，该程序涵盖了三种不同的用例</p><ol class=""><li id="476b" class="jp jq hi it b iu iv iy iz jc jr jg js jk jt jo kk jv jw jx bi translated"><strong class="it hj">分配和删除对象</strong>——尽可能使用局部变量</li><li id="3c9c" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo kk jv jw jx bi translated"><strong class="it hj">分配和保留对象</strong> —常规用例</li><li id="c55c" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo kk jv jw jx bi translated"><strong class="it hj">分配并释放对象</strong> —释放未使用的对象<em class="kg">(如果需要)</em>将是有益的</li></ol><p id="49f8" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这个博客旨在展示这种技术和可能性。</p><blockquote class="kd ke kf"><p id="0081" class="ir is kg it b iu iv iw ix iy iz ja jb kh jd je jf ki jh ji jj kj jl jm jn jo hb bi translated">不包括弱引用、软引用和幻像引用。改天再写博客</p></blockquote><figure class="km kn ko kp fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2019/04/top-5-courses-to-learn-jvm-internals.html"><div class="er es kl"><img src="../Images/8cf72e34be3a6b903b24d0f45ab32178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sQ1OZmPzvk14Z3S5Vz8jdA.png"/></div></a><p class="im in et er es io ip bd b be z dx translated">GC演示应用</p></figure></div><div class="ab cl kq kr gp ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hb hc hd he hf"><p id="c21a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">统一JVM日志</strong>在<a class="ae iq" href="https://openjdk.java.net/jeps/158" rel="noopener ugc nofollow" target="_blank"> Java SE 9 </a>中引入，目的是通过允许<strong class="it hj">细粒度且易于配置的日志选项</strong>来简化根本原因分析。运行以下命令来理解统一的<a class="ae iq" href="https://www.java67.com/2016/08/10-jvm-options-for-java-production-application.html" rel="noopener ugc nofollow" target="_blank"> JVM日志</a>支持的语法和选项</p><pre class="km kn ko kp fd kx ky kz la aw lb bi"><span id="41cf" class="lc ld hi ky b fi le lf l lg lh"><strong class="ky hj">java -Xlog:help</strong></span><span id="d682" class="lc ld hi ky b fi li lf l lg lh">-Xlog Usage: -Xlog[:[selections][:[output][:[decorators][:output-options]]]]<br/>         where 'selections' are combinations of tags and levels of the form tag1[+tag2...][*][=level][,...]<br/>         NOTE: Unless wildcard (*) is specified, only log messages tagged with exactly the tags specified will be matched.</span><span id="097e" class="lc ld hi ky b fi li lf l lg lh">Available log levels:<br/> off, trace, debug, info, warning, error</span><span id="7fd6" class="lc ld hi ky b fi li lf l lg lh">more...</span></pre><p id="46db" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我将在所有的测试运行中使用以下日志配置</p><pre class="km kn ko kp fd kx ky kz la aw lb bi"><span id="7782" class="lc ld hi ky b fi le lf l lg lh">java -XX:+UseSerialGC -Xms22m <strong class="ky hj">-Xmx22m</strong> -Xlog:<strong class="ky hj">gc*=info,heap*=debug,safepoint=info</strong>:file=/home/prasad/logs/gc.log::filecount=3,filesize=1m GarbageCollectorApp</span><span id="a204" class="lc ld hi ky b fi li lf l lg lh">- We will be using Serial GC for simplicity sake<br/>- We can switch between <strong class="ky hj">info, debug and off</strong> log levels as required<br/>- Maximum of 22 MB heap size is allocated (2 MB extra is provided for miscellaneous purpose)</span></pre></div><div class="ab cl kq kr gp ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hb hc hd he hf"><p id="b5d4" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">分配并删除用例</strong></p><figure class="km kn ko kp fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/04/top-10-advanced-core-java-courses-for-experienced-developers.html"><div class="er es lj"><img src="../Images/049aa01464bc27988559462239178ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8yWRcL60WQLFLBMVpcgPA.png"/></div></a><p class="im in et er es io ip bd b be z dx translated">分配并删除测试运行</p></figure><p id="dd41" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">基于GC日志的高级摘要是</strong></p><ul class=""><li id="6508" class="jp jq hi it b iu iv iy iz jc jr jg js jk jt jo ju jv jw jx bi translated">有6个年轻一代GC周期</li><li id="a771" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated">没有老一代GC循环</li><li id="47c5" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated">没有一个对象升级到旧版本</li></ul><blockquote class="kd ke kf"><p id="5df2" class="ir is kg it b iu iv iw ix iy iz ja jb kh jd je jf ki jh ji jj kj jl jm jn jo hb bi translated">将迭代次数从200更改为2000。程序将完成而不会抛出错误—<a class="ae iq" href="http://javarevisited.blogspot.sg/2011/09/javalangoutofmemoryerror-permgen-space.html#axzz5DmwFLA1K" rel="noopener ugc nofollow" target="_blank">Java . lang . out of memory error:Java堆空间</a></p></blockquote><pre class="km kn ko kp fd kx ky kz la aw lb bi"><span id="133c" class="lc ld hi ky b fi le lf l lg lh">[0.004s]<em class="kg">[debug]</em>[gc,heap] Minimum heap 23068672  Initial heap 23068672  Maximum heap 23068672</span><span id="7e72" class="lc ld hi ky b fi li lf l lg lh">[0.004s][info ][gc     ] <strong class="ky hj">Using Serial</strong></span><span id="2689" class="lc ld hi ky b fi li lf l lg lh">Skipped multiple lines...</span><span id="78ec" class="lc ld hi ky b fi li lf l lg lh">[0.050s][info ]<strong class="ky hj">[gc,start     ] GC(5) Pause Young (Allocation Failure)</strong></span><span id="9d88" class="lc ld hi ky b fi li lf l lg lh">[0.050s][info ][gc,heap      ] GC(5) DefNew: 5919K-&gt;0K(6784K)</span><span id="86c4" class="lc ld hi ky b fi li lf l lg lh">[0.050s][info ][gc,heap      ] GC(5) Tenured: 494K-&gt;494K(15040K)</span><span id="ee0f" class="lc ld hi ky b fi li lf l lg lh">[0.050s][info ][gc,metaspace ] GC(5) Metaspace: 178K-&gt;178K(1056768K)</span><span id="a7f9" class="lc ld hi ky b fi li lf l lg lh">[0.050s][info ]<strong class="ky hj">[gc           ] GC(5) Pause Young (Allocation Failure) 6M-&gt;0M(21M) 0.128ms</strong></span><span id="77bd" class="lc ld hi ky b fi li lf l lg lh">Skipped multiple lines...</span><span id="c4c5" class="lc ld hi ky b fi li lf l lg lh">[0.050s][info ][safepoint    ] <strong class="ky hj">Total time for which application threads were stopped: 0.0003480 seconds, Stopping threads took: 0.0000088 seconds</strong></span><span id="137d" class="lc ld hi ky b fi li lf l lg lh">Skipped multiple lines...</span><span id="631b" class="lc ld hi ky b fi li lf l lg lh">[0.051s]<em class="kg">[debug]</em>[gc,heap,exit ] <strong class="ky hj">Accumulated young generation GC time 0.0026503 secs, 6 GC's, avg GC time 0.0004417</strong></span><span id="3972" class="lc ld hi ky b fi li lf l lg lh">[0.051s]<em class="kg">[debug]</em>[gc,heap,exit ] <strong class="ky hj">Accumulated old generation GC time 0.0000000 secs, 0 GC's, avg GC time 0.0000000</strong></span><span id="5976" class="lc ld hi ky b fi li lf l lg lh">[0.051s][info ][safepoint    ] Application time: 0.0014018 seconds</span></pre><p id="23a6" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">除了所有这些见解之外，您还可以通过专门的工具免费获得详细的分析报告，如<a class="ae iq" href="https://gceasy.io/" rel="noopener ugc nofollow" target="_blank"> gceasy </a></p><figure class="km kn ko kp fd ij er es paragraph-image"><a href="https://www.java67.com/2020/04/top-5-advanced-courses-to-learn-java-perofrmance-concurrency-memory-management.html"><div class="er es lk"><img src="../Images/b15636dbfc06d4b6f40710950dbeba2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yoXWVmvxvnSCpCjiGlYi8g.png"/></div></a><p class="im in et er es io ip bd b be z dx translated">gceasy报告的快照示例</p></figure></div><div class="ab cl kq kr gp ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hb hc hd he hf"><p id="4a01" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">分配并保留用例</strong></p><figure class="km kn ko kp fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2018/07/top-5-java-performance-tuning-books-for.html#axzz6ieZZarMY"><div class="er es ll"><img src="../Images/d7d669f85fc395a4dd2474091fc62217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTARtHqVUwBR0nF1KFFaeQ.png"/></div></a><p class="im in et er es io ip bd b be z dx translated">分配和保留测试运行</p></figure><p id="581d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">基于GC日志的高级摘要是</strong></p><ul class=""><li id="aee1" class="jp jq hi it b iu iv iy iz jc jr jg js jk jt jo ju jv jw jx bi translated">有3个年轻一代GC周期</li><li id="44f0" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated">有1个老一代GC循环</li><li id="b99d" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated">“所有”对象都被提升到老一代(除了保留在伊甸园中的最后一次运行)</li></ul><blockquote class="kd ke kf"><p id="37c9" class="ir is kg it b iu iv iw ix iy iz ja jb kh jd je jf ki jh ji jj kj jl jm jn jo hb bi translated">将迭代次数从104更改为105。程序将抛出错误—<a class="ae iq" href="https://javarevisited.blogspot.com/2016/10/how-to-increase-heap-size-of-eclipse-OutOfMemoryError.html" rel="noopener ugc nofollow" target="_blank">Java . lang . out of memory error:Java堆空间</a></p></blockquote><pre class="km kn ko kp fd kx ky kz la aw lb bi"><span id="187d" class="lc ld hi ky b fi le lf l lg lh">Skipped multiple lines....</span><span id="7ef3" class="lc ld hi ky b fi li lf l lg lh">[0.224s]<em class="kg">[debug]</em>[gc,heap,exit   ] <strong class="ky hj">Accumulated young generation GC time 0.0081142 secs, 3 GC's, avg GC time 0.0027047</strong></span><span id="284d" class="lc ld hi ky b fi li lf l lg lh">[0.224s]<em class="kg">[debug]</em>[gc,heap,exit   ] <strong class="ky hj">Accumulated old generation GC time 0.0038210 secs, 1 GC's, avg GC time 0.0038210</strong></span><span id="ad84" class="lc ld hi ky b fi li lf l lg lh">[0.225s][info ][safepoint      ] Application time: 0.0011887 seconds</span></pre><figure class="km kn ko kp fd ij er es paragraph-image"><a href="http://javarevisited.blogspot.sg/2011/11/hotspot-jvm-options-java-examples.html#axzz54oJiRW8k"><div class="er es lm"><img src="../Images/bc94b2d00a81cda4fdfa38c7db3de81a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MXEDk0IkmiOlj5dBQyyQ-Q.png"/></div></a><p class="im in et er es io ip bd b be z dx translated">gceasy报告的快照示例</p></figure></div><div class="ab cl kq kr gp ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hb hc hd he hf"><p id="5f8f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">分配和发布用例</strong></p><figure class="km kn ko kp fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2011/04/garbage-collection-in-java.html#axzz4zt6jlTWS"><div class="er es ln"><img src="../Images/04457f422e9e12222e9eb4ab5969f093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9ICati745al5WXrFHEVUg.png"/></div></a><p class="im in et er es io ip bd b be z dx translated">分配和释放50%的对象</p></figure><p id="830e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">基于GC日志的高级摘要有</strong></p><ul class=""><li id="0467" class="jp jq hi it b iu iv iy iz jc jr jg js jk jt jo ju jv jw jx bi translated">有6个年轻一代GC周期</li><li id="5d98" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated">有5个老一代GC循环</li><li id="bbe6" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated">通过释放50%的已分配对象，我们成功地迭代了更多——从104到205</li></ul><pre class="km kn ko kp fd kx ky kz la aw lb bi"><span id="7cb1" class="lc ld hi ky b fi le lf l lg lh">Skipped multiple lines....</span><span id="9aba" class="lc ld hi ky b fi li lf l lg lh">[0.080s]<em class="kg">[debug]</em>[gc,heap,exit   ] <strong class="ky hj">Accumulated young generation GC time 0.0121265 secs, 6 GC's, avg GC time 0.0020211</strong></span><span id="af36" class="lc ld hi ky b fi li lf l lg lh">[0.080s]<em class="kg">[debug]</em>[gc,heap,exit   ] <strong class="ky hj">Accumulated old generation GC time 0.0119243 secs, 5 GC's, avg GC time 0.0023849</strong></span><span id="a2fb" class="lc ld hi ky b fi li lf l lg lh">[0.080s][info ][safepoint      ] Application time: 0.0010042 seconds</span></pre><figure class="km kn ko kp fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/04/top-5-courses-to-become-full-stack-java-developer-with-Angular-and-Reactjs.html#axzz6Nq9yk7Sc"><div class="er es lo"><img src="../Images/fe93ba3fe204784b6f0bf82dfb3f1a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wv1gw8dQPINlqrME5iTjGA.png"/></div></a><p class="im in et er es io ip bd b be z dx translated">gceasy报告的快照示例</p></figure></div><div class="ab cl kq kr gp ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hb hc hd he hf"><p id="75d2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果你需要复习一下<a class="ae iq" rel="noopener" href="/javarevisited/7-best-courses-to-learn-jvm-garbage-collection-and-performance-tuning-for-experienced-java-331705180686">垃圾收集</a>，请参考我以前的博客</p><div class="lp lq ez fb lr ls"><a rel="noopener follow" target="_blank" href="/javarevisited/jvm-garbage-collection-basics-edce6791ae98"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hj fi z dy lx ea eb ly ed ef hh bi translated">JVM垃圾收集基础知识</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">了解JVM垃圾收集和每种收集器算法背后的机制与…</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">medium.com</p></div></div><div class="mb l"><div class="mc l md me mf mb mg ik ls"/></div></div></a></div></div><div class="ab cl kq kr gp ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hb hc hd he hf"><figure class="km kn ko kp fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure></div></div>    
</body>
</html>