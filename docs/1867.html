<html>
<head>
<title>Ways to create objects in Java with Builder and Factory</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Builder和Factory在Java中创建对象的方法</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/ways-to-create-objects-em-java-679e4f3c2160?source=collection_archive---------1-----------------------#2022-01-08">https://medium.com/javarevisited/ways-to-create-objects-em-java-679e4f3c2160?source=collection_archive---------1-----------------------#2022-01-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/effb333bda3a215222f4e730243414e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rsJ_9HSmoILgsnzb2nxtDg.jpeg"/></div></div></figure><p id="823f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">几乎每次我开始写程序的时候，我都试图把定义领域作为要做的第一步。举例来说，这对我理解api的含义很有帮助。她是做什么的？她在说什么？为什么会存在？</p><p id="f551" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后我尝试定义如何创建对象。我也注意到了“如何”这个词，思考了这样一些问题:</p><ul class=""><li id="d56e" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">任何人都可以随时给一个新的对象吗？</li><li id="e1f3" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">任何人都可以随时设置属性吗？</li><li id="986e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">任何人都可以用空属性随心所欲地创建吗？</li></ul><p id="625e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在某堂课上，我听到了一个关于汽车的类比，直到今天我还带着它，它是这样的:我制造了一辆汽车，我要交付它，我希望收到它的人伸出手，打开发动机，而不知道他们在做什么，改变什么或做任何其他事情，除了开那辆车？</p><p id="59c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">也就是说，我将向您展示创建对象的三种方法及其摆脱实例化和属性集的优势。</p><p id="e8ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将假设我正在为一个宠物商店系统编程，所以我将考虑在那里处理的小动物。</p><p id="94a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通常我们在这里会有这个:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="2921" class="kl km hi kh b fi kn ko l kp kq">package com.example.demo.domain;</span><span id="58b6" class="kl km hi kh b fi kr ko l kp kq">public class Dog {<br/>    public String name;<br/>    public Integer age;<br/>    public String race;<br/>    public String sex;<br/>    public Double weight;<br/>}</span></pre><p id="d695" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该对象将按如下方式使用:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="9095" class="kl km hi kh b fi kn ko l kp kq">public class Tests {      <br/>    public static void main(String[] args) {         <br/>        Dog dog = new Dog();         <br/>        dog.raca = "pitbull";<br/>        dog.age = 5;         <br/>        dog.weight = 10.0;         <br/>        dog.sex = "M";     <br/>    }  <br/>}</span></pre><p id="8f2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不要使用这种方式，它有许多漏洞和差距。</p><p id="ef3a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我不会评论这种形式的使用，我会谈论其他方式以及为什么他们会更有趣。</p><h2 id="b13d" class="kl km hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">最常见的方式:</h2><p id="b412" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">首先，我通常不公开任何东西，我喜欢定义一个构造函数，所以它看起来像这样:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="807d" class="kl km hi kh b fi kn ko l kp kq">package com.example.demo.english.domain;</span><span id="5ad5" class="kl km hi kh b fi kr ko l kp kq">import java.time.LocalDate;<br/>import java.time.Period;</span><span id="5ef3" class="kl km hi kh b fi kr ko l kp kq">public class Dog {<br/>    private String name;<br/>    private LocalDate birthDate;<br/>    private String breed;<br/>    private String sex;<br/>    private Double weight;</span><span id="ff8d" class="kl km hi kh b fi kr ko l kp kq">    public Dog(String name, LocalDate birthDate, String breed, String sex, Double weight){<br/>        this.name = name;<br/>        this.birthDate = birthDate;<br/>        this.breed = breed;<br/>        this.sex = sex;<br/>        this.weight = weight;<br/>    }</span><span id="cb12" class="kl km hi kh b fi kr ko l kp kq">    public String getName() {<br/>        return name;<br/>    }</span><span id="87f6" class="kl km hi kh b fi kr ko l kp kq">    public Integer getAge() {<br/>        return Period.<em class="lq">between</em>(this.birthDate, LocalDate.<em class="lq">now</em>()).getYears();<br/>    }</span><span id="58a7" class="kl km hi kh b fi kr ko l kp kq">    public String getBreed() {<br/>        return breed;<br/>    }</span><span id="134d" class="kl km hi kh b fi kr ko l kp kq">    public String getSex() {<br/>        return sex;<br/>    }</span><span id="ece2" class="kl km hi kh b fi kr ko l kp kq">    public Double getWeight() {<br/>        return weight;<br/>    }</span><span id="9a5c" class="kl km hi kh b fi kr ko l kp kq">    public void setWeight(Double weight) {<br/>        this.weight = weight;<br/>    }<br/>}</span></pre><p id="5dab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，属性的使用是通过getters和setters方法完成的，对象的创建是通过其构造函数传递参数来完成的，如下所示:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="be2f" class="kl km hi kh b fi kn ko l kp kq">public static void main(String[] args) {<br/>    Dog dog = new Dog("Rex", LocalDate.<em class="lq">of</em>(2015, 10, 10), "pitbull", "M", 10.0);<br/>    dog.getName();<br/>}</span></pre><h2 id="78b3" class="kl km hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">使用工厂</h2><p id="3f4f" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">这相对简单，我们需要一个类，它的唯一功能是提供对象的创建:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="d2b8" class="kl km hi kh b fi kn ko l kp kq">import java.time.LocalDate;</span><span id="971d" class="kl km hi kh b fi kr ko l kp kq">public class DogFactory {</span><span id="b5fe" class="kl km hi kh b fi kr ko l kp kq">    public Dog create(String name, LocalDate birthDate, String breed, String sex, Double weight){<br/>        return new Dog(name, birthDate, breed, sex, weight);<br/>    }</span><span id="03f4" class="kl km hi kh b fi kr ko l kp kq">}</span></pre><p id="d118" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后关闭Dog类，不允许实例化:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="7d74" class="kl km hi kh b fi kn ko l kp kq">import java.time.LocalDate;<br/>import java.time.Period;</span><span id="ceba" class="kl km hi kh b fi kr ko l kp kq">public class Dog {<br/>    private String name;<br/>    private LocalDate birthDate;<br/>    private String breed;<br/>    private String sex;<br/>    private Double weight;</span><span id="7a7c" class="kl km hi kh b fi kr ko l kp kq">    public Dog(String name, LocalDate birthDate, String breed, String sex, Double weight){<br/>        this.name = name;<br/>        this.birthDate = birthDate;<br/>        this.breed = breed;<br/>        this.sex = sex;<br/>        this.weight = weight;<br/>    }</span><span id="8627" class="kl km hi kh b fi kr ko l kp kq">    public String getName() {<br/>        return name;<br/>    }</span><span id="4099" class="kl km hi kh b fi kr ko l kp kq">    public Integer getAge() {<br/>        return Period.<em class="lq">between</em>(this.birthDate, LocalDate.<em class="lq">now</em>()).getYears();<br/>    }</span><span id="c54f" class="kl km hi kh b fi kr ko l kp kq">    public String getBreed() {<br/>        return breed;<br/>    }</span><span id="bb65" class="kl km hi kh b fi kr ko l kp kq">    public String getSex() {<br/>        return sex;<br/>    }</span><span id="0e13" class="kl km hi kh b fi kr ko l kp kq">    public Double getWeight() {<br/>        return weight;<br/>    }</span><span id="fd77" class="kl km hi kh b fi kr ko l kp kq">    public void setWeight(Double weight) {<br/>        this.weight = weight;<br/>    }<br/>}</span></pre><p id="2586" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用法是这样的:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="ef91" class="kl km hi kh b fi kn ko l kp kq">import com.example.demo.english.factory.Dog;<br/>import com.example.demo.english.factory.DogFactory;</span><span id="a7b4" class="kl km hi kh b fi kr ko l kp kq">import java.time.LocalDate;</span><span id="23d3" class="kl km hi kh b fi kr ko l kp kq">public class FactoryTests {</span><span id="6608" class="kl km hi kh b fi kr ko l kp kq">    public static void main(String[] args) {</span><span id="0a94" class="kl km hi kh b fi kr ko l kp kq">        DogFactory dogFactory = new DogFactory();<br/>        Dog dog = dogFactory.create("Rex", LocalDate.<em class="lq">of</em>(2015, 10, 10), "pitbull", "M", 10.0);<br/>    }</span><span id="508d" class="kl km hi kh b fi kr ko l kp kq">}</span></pre><p id="9359" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就这样，我们使用工厂模式。如果有人试图在其他包中实例化，他们不会成功。现在让我们来看看构建器。</p><h2 id="e321" class="kl km hi bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk bi translated">使用构建器</h2><p id="e5ca" class="pw-post-body-paragraph iq ir hi is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hb bi translated">在这里，事情变得有点复杂，但是对于有很多属性的对象来说，这是值得的。这是因为通过构造函数传递太多参数会让我们在创建对象时感到困惑。</p><p id="570b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我首先创建了DogBuilder类:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="26d6" class="kl km hi kh b fi kn ko l kp kq">import java.time.LocalDate;</span><span id="115b" class="kl km hi kh b fi kr ko l kp kq">public class DogBuilder {</span><span id="e2b6" class="kl km hi kh b fi kr ko l kp kq">    private Dog dog;</span><span id="d566" class="kl km hi kh b fi kr ko l kp kq">    public DogBuilder() {<br/>        this.dog = new Dog();<br/>    }</span><span id="d849" class="kl km hi kh b fi kr ko l kp kq">    public static DogBuilder builder() {<br/>        return new DogBuilder();<br/>    }</span><span id="abda" class="kl km hi kh b fi kr ko l kp kq">    public DogBuilder addName(String nome) {<br/>        this.dog.setName(nome);<br/>        return this;<br/>    }</span><span id="402d" class="kl km hi kh b fi kr ko l kp kq">    public DogBuilder addBirthDate(LocalDate birthDate) {<br/>        this.dog.setBirthDate(birthDate);<br/>        return this;<br/>    }</span><span id="510f" class="kl km hi kh b fi kr ko l kp kq">    public DogBuilder addBreed(String raca) {<br/>        this.dog.setRaca(raca);<br/>        return this;<br/>    }</span><span id="392f" class="kl km hi kh b fi kr ko l kp kq">    public DogBuilder addWeight(Double peso) {<br/>        this.dog.setWeight(peso);<br/>        return this;<br/>    }</span><span id="4801" class="kl km hi kh b fi kr ko l kp kq">    public DogBuilder addSex(String sexo) {<br/>        this.dog.setSex(sexo);<br/>        return this;<br/>    }</span><span id="61bd" class="kl km hi kh b fi kr ko l kp kq">    public Dog get() {<br/>        return this.dog;<br/>    }</span><span id="1766" class="kl km hi kh b fi kr ko l kp kq">}</span></pre><p id="8dbb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，我保护了dog类的方法，这样它们就不会被误用:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="848c" class="kl km hi kh b fi kn ko l kp kq">import java.time.LocalDate;<br/>import java.time.Period;</span><span id="caf9" class="kl km hi kh b fi kr ko l kp kq">public class Dog {<br/>    private String name;<br/>    private LocalDate birthDate;<br/>    private String breed;<br/>    private String sex;<br/>    private Double weight;</span><span id="3c9c" class="kl km hi kh b fi kr ko l kp kq">    protected Dog(){</span><span id="704b" class="kl km hi kh b fi kr ko l kp kq">    }</span><span id="cc4c" class="kl km hi kh b fi kr ko l kp kq">    protected void setName(String name) {<br/>        this.name = name;<br/>    }</span><span id="54db" class="kl km hi kh b fi kr ko l kp kq">    public void setBirthDate(LocalDate birthDate) {<br/>        this.birthDate = birthDate;<br/>    }</span><span id="f2ef" class="kl km hi kh b fi kr ko l kp kq">    protected void setRaca(String raca) {<br/>        this.breed = raca;<br/>    }</span><span id="d4c4" class="kl km hi kh b fi kr ko l kp kq">    protected void setSex(String sex) {<br/>        this.sex = sex;<br/>    }</span><span id="22f3" class="kl km hi kh b fi kr ko l kp kq">    public String getName() {<br/>        return name;<br/>    }</span><span id="e2a4" class="kl km hi kh b fi kr ko l kp kq">    public Integer getAge() {<br/>        return Period.<em class="lq">between</em>(this.birthDate, LocalDate.<em class="lq">now</em>()).getYears();<br/>    }</span><span id="c8e0" class="kl km hi kh b fi kr ko l kp kq">    public String getBreed() {<br/>        return breed;<br/>    }</span><span id="0c4c" class="kl km hi kh b fi kr ko l kp kq">    public String getSex() {<br/>        return sex;<br/>    }</span><span id="4de9" class="kl km hi kh b fi kr ko l kp kq">    public Double getWeight() {<br/>        return weight;<br/>    }</span><span id="e0b6" class="kl km hi kh b fi kr ko l kp kq">    public void setWeight(Double weight) {<br/>        this.weight = weight;<br/>    }</span><span id="9b4a" class="kl km hi kh b fi kr ko l kp kq">}</span></pre><p id="6ce8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，只有setWeight(…)是公共的。其余的都是受保护的，那是因为这是唯一可以随时间更新的东西。<br/>使用构建器是这样的:</p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="fb4c" class="kl km hi kh b fi kn ko l kp kq">import com.example.demo.english.builder.DogBuilder;<br/>import com.example.demo.english.builder.Dog;</span><span id="ef68" class="kl km hi kh b fi kr ko l kp kq">import java.time.LocalDate;</span><span id="d74e" class="kl km hi kh b fi kr ko l kp kq">public class BuilderTests {</span><span id="1750" class="kl km hi kh b fi kr ko l kp kq">    public static void main(String[] args) {<br/>        Dog dog = DogBuilder.<em class="lq">builder</em>()<br/>                .addName("Rex")<br/>                .addBirthDate(LocalDate.<em class="lq">of</em>(2015, 10, 10))<br/>                .addWeight(10.0)<br/>                .addSex("M")<br/>                .addBreed("Pitbull")<br/>                .get();</span><span id="9fbe" class="kl km hi kh b fi kr ko l kp kq">        dog.getName();<br/>    }</span><span id="5624" class="kl km hi kh b fi kr ko l kp kq">}</span></pre><p id="1821" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">很酷吧？</p><figure class="kc kd ke kf fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/2b833c37d58a6f78790df90e46f3a482.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*Aut7xVje2hBR8fRO.gif"/></div></figure><p id="ec04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，只需选择使代码可读性更好的形式，并努力去做。</p><p id="ad95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这段代码在这里:<a class="ae ls" href="https://github.com/mmarcosab/tres-formas-criar-objetos" rel="noopener ugc nofollow" target="_blank">https://github.com/mmarcosab/tres-formas-criar-objetos</a></p><p id="78b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们在巴西所说的:我们在一起。</p></div></div>    
</body>
</html>