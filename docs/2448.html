<html>
<head>
<title>Code Smell 167 — Hashing Comparison</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">代码气味167 —哈希比较</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/code-smell-167-hashing-comparison-dcc321453af1?source=collection_archive---------0-----------------------#2022-10-09">https://medium.com/javarevisited/code-smell-167-hashing-comparison-dcc321453af1?source=collection_archive---------0-----------------------#2022-10-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="7146" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">散列保证两个对象是不同的。不是说他们是一样的</h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/94a550daac9ca52fc062ad032a7f757e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPtDDKJXDNWUTJYtu7Gpyg.png"/></div></div></figure><blockquote class="jk jl jm"><p id="2897" class="jn jo jp jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="hi">TL；DR:如果你检查散列，你也应该检查相等性</em></p></blockquote><h1 id="6290" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">问题</h1><ul class=""><li id="36e1" class="lc ld hi jq b jr le ju lf lg lh li lj lk ll kj lm ln lo lp bi translated"><a class="ae lq" href="https://codeburst.io/the-one-and-only-software-design-principle-5328420712af" rel="noopener" target="_blank">双射故障</a></li></ul><h1 id="8301" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">解决方法</h1><ol class=""><li id="b1b9" class="lc ld hi jq b jr le ju lf lg lh li lj lk ll kj lr ln lo lp bi translated">检查哈希(快速)，然后检查相等性(慢速)</li></ol><h1 id="06d2" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">语境</h1><p id="8abd" class="pw-post-body-paragraph jn jo hi jq b jr le ij jt ju lf im jw lg ls jz ka li lt kd ke lk lu kh ki kj hb bi translated">2022年10月7日，一个更大的<a class="ae lq" rel="noopener" href="/javarevisited/the-blockchain-developer-architect-roadmap-d212d3bbbb00">区块链</a>必须停止。</p><p id="39ca" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated">这条新闻令人震惊，因为大多数区块链从定义上来说是分散的。</p><p id="df87" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated">你可以在这里阅读全文:</p><div class="lv lw ez fb lx ly"><a href="https://mcsee.medium.com/how-a-hacker-stole-566m-usd-exploiting-a-code-smell-40409d80adfc" rel="noopener follow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hj fi z dy md ea eb me ed ef hh bi translated">黑客如何利用代码气味窃取了5.66亿美元</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">我不是安全专家。但是我喜欢干净的代码和代码的味道</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">mcsee.medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ji ly"/></div></div></a></div><h1 id="8dca" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">示例代码</h1><h2 id="0bfc" class="mn kl hi bd km mo mp mq kq mr ms mt ku lg mu mv kw li mw mx ky lk my mz la na bi translated">错误的</h2><pre class="iz ja jb jc fd nb nc nd ne aw nf bi"><span id="f45b" class="mn kl hi nc b fi ng nh l ni nj">public class Person {</span><span id="b6e3" class="mn kl hi nc b fi nk nh l ni nj">public String name;<br/>// Public attributes are another smell  </span><span id="4f3d" class="mn kl hi nc b fi nk nh l ni nj"> @Override<br/> public boolean equals(Person anotherPerson) {<br/>   return name.equals(anotherPerson.name); <br/> }</span><span id="b115" class="mn kl hi nc b fi nk nh l ni nj">@Override<br/> public int hashCode() {<br/>   return (int)(Math.random()*256); <br/> }<br/> // This is just an example of non-correlation  </span><span id="33a0" class="mn kl hi nc b fi nk nh l ni nj"> // When using HashMaps we can make a mistake <br/> // and guess the object is not present in the collection</span><span id="e0a7" class="mn kl hi nc b fi nk nh l ni nj">}</span></pre><h2 id="d337" class="mn kl hi bd km mo mp mq kq mr ms mt ku lg mu mv kw li mw mx ky lk my mz la na bi translated">对吧</h2><pre class="iz ja jb jc fd nb nc nd ne aw nf bi"><span id="c667" class="mn kl hi nc b fi ng nh l ni nj">public class Person {</span><span id="9e7a" class="mn kl hi nc b fi nk nh l ni nj">public String name;<br/>// Public attributes are another smell  </span><span id="99a3" class="mn kl hi nc b fi nk nh l ni nj"> @Override<br/> public boolean equals(Person anotherPerson) {<br/>   return name.equals(anotherPerson.name); <br/> }</span><span id="81f6" class="mn kl hi nc b fi nk nh l ni nj">@Override<br/> public int hashCode() {<br/>   return name.hashCode(); <br/> }<br/> // This is just an example of non-correlation  </span><span id="912a" class="mn kl hi nc b fi nk nh l ni nj">}</span></pre><h1 id="4cd1" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">侦查</h1><p id="5765" class="pw-post-body-paragraph jn jo hi jq b jr le ij jt ju lf im jw lg ls jz ka li lt kd ke lk lu kh ki kj hb bi translated">[X]半自动</p><p id="b40c" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated">许多linters都有散列和相等重定义的规则。</p><p id="0b29" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated">通过突变测试，我们可以用相同的散列来播种不同的对象，并检查我们的测试。</p><ul class=""><li id="340a" class="lc ld hi jq b jr js ju jv lg nl li nm lk nn kj lm ln lo lp bi translated">身份</li><li id="42cd" class="lc ld hi jq b jr no ju np lg nq li nr lk ns kj lm ln lo lp bi translated">安全性</li></ul><h1 id="40c5" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">结论</h1><p id="ca36" class="pw-post-body-paragraph jn jo hi jq b jr le ij jt ju lf im jw lg ls jz ka li lt kd ke lk lu kh ki kj hb bi translated">每一种性能改进都有其缺点。</p><p id="9098" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated">缓存和复制是显著的例子。</p><p id="78ec" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated">我们可以(必须)小心使用它们。</p><h1 id="f2c0" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">关系</h1><div class="lv lw ez fb lx ly"><a href="https://blog.devgenius.io/code-smell-49-caches-d2e64373b838" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hj fi z dy md ea eb me ed ef hh bi translated">代码气味49 —缓存</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">储藏处很性感。他们是一夜情。我们需要在长期关系中避开它们。</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">blog.devgenius.io</p></div></div><div class="mh l"><div class="nt l mj mk ml mh mm ji ly"/></div></div></a></div><div class="lv lw ez fb lx ly"><a href="https://levelup.gitconnected.com/code-smell-150-equal-comparison-4a3d1eed823d" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hj fi z dy md ea eb me ed ef hh bi translated">代码气味150 —同等比较</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">每个开发人员都平等地比较属性。他们错了。</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">levelup.gitconnected.com</p></div></div><div class="mh l"><div class="nu l mj mk ml mh mm ji ly"/></div></div></a></div><h1 id="b184" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">更多信息</h1><p id="6158" class="pw-post-body-paragraph jn jo hi jq b jr le ij jt ju lf im jw lg ls jz ka li lt kd ke lk lu kh ki kj hb bi translated"><a class="ae lq" href="http://forum.world.st/Is-it-always-needed-to-redefine-hash-message-when-you-redefine-message-td4828721.html" rel="noopener ugc nofollow" target="_blank">相等和散列</a></p><p id="64cf" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated"><a class="ae lq" href="https://stackoverflow.com/questions/3563847/what-is-the-use-of-hashcode-in-java" rel="noopener ugc nofollow" target="_blank">Java中的Hashcode</a></p><p id="90ff" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated"><a class="ae lq" href="https://www.digitalocean.com/community/tutorials/java-equals-hashcode" rel="noopener ugc nofollow" target="_blank">哈希码vs等于</a></p><h1 id="935f" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">放弃</h1><p id="7f86" class="pw-post-body-paragraph jn jo hi jq b jr le ij jt ju lf im jw lg ls jz ka li lt kd ke lk lu kh ki kj hb bi translated">代码气味只是我的<a class="ae lq" href="https://mcsee.medium.com/i-wrote-more-than-90-articles-on-2021-here-is-what-i-learned-76c238f9936f" rel="noopener">观点</a>。</p></div><div class="ab cl nv nw gp nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="hb hc hd he hf"><blockquote class="jk jl jm"><p id="8293" class="jn jo jp jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这可能会让你的一些读者感到惊讶，但是我的主要兴趣不是计算机安全。我主要对编写能按预期工作的软件感兴趣。</p></blockquote><p id="e6bd" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated"><em class="jp"> Wietse Venema </em></p><div class="lv lw ez fb lx ly"><a href="https://blog.devgenius.io/software-engineering-great-quotes-3af63cea6782" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hj fi z dy md ea eb me ed ef hh bi translated">软件工程名言</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">有时一个简短的想法可以带来惊人的想法。</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">blog.devgenius.io</p></div></div><div class="mh l"><div class="oc l mj mk ml mh mm ji ly"/></div></div></a></div></div><div class="ab cl nv nw gp nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="hb hc hd he hf"><p id="487f" class="pw-post-body-paragraph jn jo hi jq b jr js ij jt ju jv im jw lg jy jz ka li kc kd ke lk kg kh ki kj hb bi translated">本文是CodeSmell系列的一部分。</p><div class="lv lw ez fb lx ly"><a href="https://blog.devgenius.io/how-to-find-the-stinky-parts-of-your-code-fa8df47fc39c" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hj fi z dy md ea eb me ed ef hh bi translated">如何找到你的代码中有问题的部分</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">代码很难闻。让我们看看如何改变香味。</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">blog.devgenius.io</p></div></div><div class="mh l"><div class="od l mj mk ml mh mm ji ly"/></div></div></a></div></div></div>    
</body>
</html>