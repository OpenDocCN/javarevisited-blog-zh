<html>
<head>
<title>Test-Driven Development(TDD) for Java Programmers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向Java程序员的测试驱动开发(TDD)</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/test-driven-development-tdd-for-java-programmers-cb73878afdde?source=collection_archive---------0-----------------------#2022-06-19">https://medium.com/javarevisited/test-driven-development-tdd-for-java-programmers-cb73878afdde?source=collection_archive---------0-----------------------#2022-06-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c9bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">甚至大多数专业人员都做的最常见但被低估的实践之一是编写代码而不实现测试。尽管很明显，如果您理解了业务逻辑，您就可以直接深入实现，但这并不意味着您遵循了编程专家久经考验的最佳实践。实现你的程序的最好方法之一是遵循TDD或<a class="ae jd" href="https://javarevisited.blogspot.com/2019/04/top-5-junit-and-unit-testing-courses-java-programmers.html" rel="noopener ugc nofollow" target="_blank">测试驱动开发</a>。在本文中，我们将看看什么是TDD，以及如何使用TDD进行更好的编程。</p><h2 id="f27a" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">什么是TDD？</h2><p id="ddaa" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">TDD仅仅意味着我们使用测试来驱动代码的实现。但实际上，重构是一个从红到绿的工作流程。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://javarevisited.blogspot.com/2019/04/top-5-junit-and-unit-testing-courses-java-programmers.html#axzz6iYmMFnsA"><div class="er es ke"><img src="../Images/249916b0e3040c8352b52f4a5db21d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*8mLL_fFlnDatg3LKsengRw.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">TDD流程</p></figure><p id="caa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初，新的测试将从红色状态开始，这意味着它将失败。在初始状态失败后，我们将更正测试和逻辑以通过或到达绿色状态。一旦我们的测试通过，我们就可以<a class="ae jd" rel="noopener" href="/javarevisited/7-best-courses-to-learn-refactoring-and-clean-coding-in-java-47bea3c67006">重构</a>测试和业务逻辑的实现，使它们更加高效。如果<a class="ae jd" href="https://javarevisited.blogspot.com/2020/12/top-5-course-to-improve-coding-skills.html" rel="noopener ugc nofollow" target="_blank">重构</a>导致测试回到红色状态，我们将修复测试进入绿色状态，然后再次重构，从而创建一个循环。</p><h2 id="e14b" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">ISBN验证</h2><p id="2733" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">为了更详细地理解TDD，我们将看看如何在项目中使用TDD。在这个项目中，我们将看看如何验证一本书的ISBN号。ISBN代表国际标准书号，这些是你在任何一本书的条形码上都能找到的数字。ISBN号的有效性基于以下简单的逻辑。</p><p id="0ffb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果ISBN号包含10个数字，并且它们都是数字，那么ISBN数字与10到1的乘积之和除以11应该得到一个整数值。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://javarevisited.blogspot.com/2013/04/JUnit-tutorial-example-test-exception-thrown-by-java-method.html"><div class="er es kr"><img src="../Images/667d3f49c6fb3eb276cd03edefd09c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8zbINr6BCwolPFhrS-1CmQ.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">国际标准书号10位数</p></figure><p id="8738" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的例子中，总和是132，当它除以11时，我们得到12，一个整数值。因此这是一个有效的ISBN号。</p><p id="3a1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果ISBN号的最后一位数字是9位字母“X ”,那么将“X”视为10，ISBN号数字与10到1的乘积之和除以11应该得到一个整数值。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kr"><img src="../Images/2d0a2f7c060277b28979b26cd7a37f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L-YQw3_CDmhfVhNxSbtbQQ.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">带X的ISBN 9位数</p></figure><p id="32ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，乘积之和是209，除以11得到19，这是一个整数值。</p><p id="542c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，如果ISBN号包含13个数字，那么这些数字应该交替乘以1和3。之后，总和除以10应该给出一个整数值。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kw"><img src="../Images/1d7b4b4667c5ed93006742c232f82e7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gem7DIJkTj_mT2AuBw_NTw.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">ISBN 13位数字</p></figure><p id="8324" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，乘积之和是100，除以10得到10，这是一个整数值。</p><h2 id="e736" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">在IntelliJ上设置项目</h2><p id="c79d" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">为此，我们将创建一个新的maven项目。为此，我们将使用<a class="ae jd" rel="noopener" href="/javarevisited/7-best-courses-to-learn-intellij-idea-for-beginners-and-experienced-java-programmers-2e9aa9bb0c05"> IntelliJ IDEA终极版</a>。要创建新的maven项目，请转到文件→新建→项目，然后选择maven。然后给<code class="du kx ky kz la b">com.book</code>作为组id，给<code class="du kx ky kz la b">tdd</code>作为工件id。生成项目后，转到<code class="du kx ky kz la b">pom.xml</code>文件，添加以下内容，将JUnit添加为依赖项。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="d504" class="je jf hi la b fi lf lg l lh li">&lt;dependency&gt;<br/>    &lt;groupId&gt;junit&lt;/groupId&gt;<br/>    &lt;artifactId&gt;junit&lt;/artifactId&gt;<br/>    &lt;version&gt;4.13.2&lt;/version&gt;<br/>    &lt;scope&gt;test&lt;/scope&gt;<br/>&lt;/dependency&gt;</span></pre><p id="2f1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，转到<code class="du kx ky kz la b">src</code> → <code class="du kx ky kz la b">main</code> → <code class="du kx ky kz la b">java</code>，创建一个新的包<code class="du kx ky kz la b">com.book.tdd</code>，并添加一个名为<code class="du kx ky kz la b">ValidateISBN.java</code>的新类。然后，转到<code class="du kx ky kz la b">src</code> → <code class="du kx ky kz la b">test</code> → <code class="du kx ky kz la b">java</code>并创建一个新包<code class="du kx ky kz la b">com.book.tdd</code>并向其中添加一个名为<code class="du kx ky kz la b">ValidateISBNTests.class</code>的新类。添加上述配置后，您的项目应该如下所示。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://javarevisited.blogspot.com/2018/09/top-5-courses-to-learn-intellij-idea-java-and-android-development.html"><div class="er es lj"><img src="../Images/2a29d3c1b45aac30599604ea62a9cdb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQ79NHpE0KyhYgqleEC_tg.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">初始项目配置</p></figure><p id="21cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们正在使用<a class="ae jd" href="https://javarevisited.blogspot.com/2021/04/junit-interview-questions-with-answers.html" rel="noopener ugc nofollow" target="_blank"> TDD </a>，首先我们将转到<code class="du kx ky kz la b">ValidateISBNTest.java</code>文件并创建我们的第一个测试。这是因为，在TDD中，代码实现是由测试驱动的。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="2f29" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkValidateISBN(){</span><span id="5e06" class="je jf hi la b fi lk lg l lh li">    <em class="kq">fail</em>("Not implemented");<br/>}</span></pre><p id="7495" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们前面提到的，我们正在从红色走向绿色。因此，最初我们将无法通过测试，并获得红色状态。为了运行这个测试，我们将通过使用<code class="du kx ky kz la b">import org.junit.Test;</code>和<code class="du kx ky kz la b">import org.junit.Assert.*;</code>来导入<code class="du kx ky kz la b">Test</code>这里，我们使用了静态方法导入，因为我们不想在代码中使用断言作为<code class="du kx ky kz la b">Assert.assertTrue()</code>。当您使用<em class="kq">水槽运行图标</em>运行该测试时，您将获得以下输出。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://www.java67.com/2018/02/5-free-eclipse-and-junit-online-courses-java-developers.html"><div class="er es lj"><img src="../Images/dc6a3b424489379ea3cd7c19037f5e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t8iVR9OwS_FPCd7IP31q2g.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">初始故障状态</p></figure><p id="e007" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要进入绿色状态，为此我们可以删除第10行，<code class="du kx ky kz la b">fail("Not Implemented");</code>并添加我们期望的方法来检查有效性。为此，我们可以这样调整我们的测试。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="968b" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkValidateISBN(){</span><span id="8050" class="je jf hi la b fi lk lg l lh li">    ValidateISBN validateISBN = new ValidateISBN();<br/>    boolean result = validateISBN.checkISBN(0140441926);<br/>}</span></pre><p id="7e7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你所注意到的，<code class="du kx ky kz la b">checkISBN(int isbn)</code>方法还没有实现，我们也没有说参数类型应该是一个<a class="ae jd" href="https://javarevisited.blogspot.com/2012/12/how-to-convert-string-to-long-in-java-4-examples.html#axzz5N6yBqnlo" rel="noopener ugc nofollow" target="_blank">字符串</a>或者其他什么。我们假设它为int，因为它是一个数。如果数量不是这种类型，我们可以在以后用测试结果来验证它。</p><p id="3c7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们运行这个时，我们得到下面的错误，说整数<a class="ae jd" href="https://www.java67.com/2015/10/java-how-to-convert-from-integer-to-String-in-Java.html" rel="noopener ugc nofollow" target="_blank">太大了。</a></p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://javarevisited.blogspot.com/2015/01/top-20-string-coding-interview-question-programming-interview.html"><div class="er es lj"><img src="../Images/93d098837750b9b982cfe18b78ec8a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1IMGLpXgw9qKVgyraeMTRA.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">运行checkISBN()方法</p></figure><p id="4ad8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于这个原因，我把变量变成了一个字符串<a class="ae jd" rel="noopener" href="/javarevisited/top-21-string-programming-interview-questions-for-beginners-and-experienced-developers-56037048de45?source=collection_home---4------0-----------------------">并再次检查。现在我得到了下面的错误。</a></p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://www.java67.com/2018/06/top-35-java-string-interview-questions.html"><div class="er es ll"><img src="../Images/db726316be9061a1cdb933cc0040720f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rOZUPtKn1GSQjAwLNtK4ew.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">运行checkISBN()方法</p></figure><p id="2fb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我知道这是因为我没有实现这个方法。因此，我单击变红的方法，并在Windows中按下<code class="du kx ky kz la b">alt + enter</code>或在Mac中按下<code class="du kx ky kz la b">option+enter</code>来选择我必须修复这个问题的选项，从我选择的下拉列表中，<code class="du kx ky kz la b">Create method 'checkISBN' in 'ValidateISBN'</code>在我们的<code class="du kx ky kz la b">ValidateISBN.java</code>文件中创建新方法。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://www.java67.com/2019/11/how-to-remove-duplicate-characters-from-string-in-java.html"><div class="er es lj"><img src="../Images/824f998964c8601233cafadad92d8e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8r9KWjrO6GJzq_6mXkUjw.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">运行checkISBN()方法</p></figure><p id="9ad4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<code class="du kx ky kz la b">ValidateISBN.java</code>文件中创建了<code class="du kx ky kz la b">checkISBN()</code>方法，并返回<code class="du kx ky kz la b">false</code>作为默认值后，我们可以再次运行测试。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://javarevisited.blogspot.com/2015/02/simple-junit-example-unit-tests-for-linked-list-java.html"><div class="er es lm"><img src="../Images/e3711b8675ff8adb5a76a1f09c0169bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*huVnb5Egws97ooWswLzypQ.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">运行checkISBN()方法</p></figure><p id="e352" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们得到了一个<code class="du kx ky kz la b">AssertonError</code>，因为我们为一个假值声明了true。如果我们将第12行改为<code class="du kx ky kz la b">assertFalse(result);</code>，测试将通过，因为我们断言为假。</p><p id="7d8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们转到<code class="du kx ky kz la b">ValidateISBN.java</code>文件并编写我们的实现。这里，要记住的最重要的事情之一是编写只需要通过测试的代码。这里，为了通过我们的测试，我们可以将<code class="du kx ky kz la b">return false;</code>改为<code class="du kx ky kz la b">return true;</code>，现在我们的代码处于绿色状态。</p><p id="764c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在假设我想验证一个无效的ISBN号。然后我可以在<code class="du kx ky kz la b">ValidateISBNTests.java</code>文件中编写下面的测试。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="08c7" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkInvalidISBN(){</span><span id="b3ea" class="je jf hi la b fi lk lg l lh li">    ValidateISBN validateISBN = new ValidateISBN();<br/>    boolean result = validateISBN.checkISBN("0140441927");<br/>    <em class="kq">assertFalse</em>(result);<br/>}</span></pre><p id="f57c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我们运行它时，它失败了，因为我们总是从<code class="du kx ky kz la b">checkISBN()</code>方法返回<code class="du kx ky kz la b">true</code>。现在，由于我们处于红色状态，我们需要编写一些代码来进入绿色状态。我们将首先编写我们前面讨论过的ISBN号验证所需的第一个检查；如果位数等于10并且都是数字。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="152d" class="je jf hi la b fi lf lg l lh li">public boolean checkISBN(String isbn) {<br/><br/>    int total = 0;<br/>    for (int i = 0; i &lt; 10; i++) {<br/>        total += isbn.charAt(i) * (10 - i);<br/>    }<br/>    if (total % 11 == 0) {<br/>        return true;<br/>    } else {<br/>        return false;<br/>    }<br/>}</span></pre><p id="5e18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们运行我们编写的测试，我们可以看到<code class="du kx ky kz la b">checkInvalidISBN()</code>没有错误，但是<code class="du kx ky kz la b">checkValidateISBN()</code>有错误，这是因为我们检查的ISBN号无效。我们可以用之前讨论ISBN号背后的逻辑0140449116来代替。</p><p id="f94b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了给<code class="du kx ky kz la b">checkValidateISBN()</code>起一个更有意义的名字，我们可以将它的名字重构为<code class="du kx ky kz la b">checkValidISBN()</code>，现在我们可以再次运行测试了。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://www.java67.com/2018/05/top-75-programming-interview-questions-answers.html"><div class="er es lj"><img src="../Images/fa505d9bb83f5576265a0dcc1094b9b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHRSMkiacoW_Tqei2r3xsQ.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">checkValidateISBN()和checkInvalidISBN()的测试通过</p></figure><p id="2dc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要添加另一个测试来验证ISBN号的长度。我们知道ISBN号的长度只能是10或13。因此，我们将运行一个测试，测试ISBN的长度不能超过10或13。为此，我们将首先编写一个失败状态的测试。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="7d50" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkISBNLengthTenOrThirteen(){</span><span id="4fef" class="je jf hi la b fi lk lg l lh li">    <em class="kq">fail</em>();<br/>}</span></pre><p id="ec50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们将它调整到下面并运行测试，我们将得到一个<code class="du kx ky kz la b"><a class="ae jd" href="https://javarevisited.blogspot.com/2016/03/how-to-remove-first-and-last-character-from-String-in-java-example.html" rel="noopener ugc nofollow" target="_blank">StringIndexOutOfBoundsException</a></code> <a class="ae jd" href="https://javarevisited.blogspot.com/2016/03/how-to-remove-first-and-last-character-from-String-in-java-example.html" rel="noopener ugc nofollow" target="_blank">，因为</a>只包含9个数字。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="73b8" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkISBNLengthTenOrThirteen(){</span><span id="21f0" class="je jf hi la b fi lk lg l lh li">    ValidateISBN validateISBN  = new ValidateISBN();<br/>    boolean result = validateISBN.checkISBN("012345678");<br/>}</span></pre><p id="eecf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然我们可以创建一个新的异常来处理这个问题，但是我们可以使用Java的<code class="du kx ky kz la b"><a class="ae jd" href="http://javarevisited.blogspot.com/2016/08/javalangnumberformatexception-for-input-string-null-java.html" rel="noopener ugc nofollow" target="_blank">NumberFormatException</a></code> <a class="ae jd" href="http://javarevisited.blogspot.com/2016/08/javalangnumberformatexception-for-input-string-null-java.html" rel="noopener ugc nofollow" target="_blank"> </a>来处理这个问题。因为我们知道这是错误的，并且我们预期会有一个错误，我们可以将测试注释更改为我们预期的错误。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="7fdc" class="je jf hi la b fi lf lg l lh li">@Test(expected = NumberFormatException.class)<br/>public void checkISBNLengthTenOrThirteen(){</span><span id="3afe" class="je jf hi la b fi lk lg l lh li">    ValidateISBN validateISBN  = new ValidateISBN();<br/>    boolean result = validateISBN.checkISBN("012345678");<br/>}</span></pre><figure class="kf kg kh ki fd kj er es paragraph-image"><a href="https://javarevisited.blogspot.com/2016/02/solving-javalangarrayindexoutofboundsexception-0-1-2-in-java.html"><div class="er es lj"><img src="../Images/9e001d31d39724984ff7ca090ffe394d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RbnCPBO0J1Nbgns_0kDRGQ.png"/></div></a><p class="km kn et er es ko kp bd b be z dx translated">意外异常？</p></figure><p id="60fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是测试表明它得到了一个意外的异常，因为它提前得到了<code class="du kx ky kz la b">StringOutOfBoundsException</code>。那么我们该如何解决这个问题呢？为了解决这个问题，我们需要更新我们的<code class="du kx ky kz la b">checkISBN()</code>方法。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="b8f2" class="je jf hi la b fi lf lg l lh li">public boolean checkISBN(String isbn) {<br/><br/>    if (isbn.length() == 10 || isbn.length() == 13) {<br/>        int total = 0;<br/>        for (int i = 0; i &lt; 10; i++) {<br/>            total += isbn.charAt(i) * (10 - i);<br/>        }<br/>        if (total % 11 == 0) {<br/>            return true;<br/>        } else {<br/>            return false;<br/>        }<br/>    } else {<br/>        throw new NumberFormatException("ISBN number should have length of 10 or 13");<br/>    }<br/>}</span></pre><p id="935e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，现在当我们运行测试时，我们得到了预期的结果。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/8514e272735fa9c8e3e3518df8f77388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_fdmycskkNRNfQD1WgglDA.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">正在运行checkISBNLengthTenOrThirteen()方法</p></figure><p id="f332" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为变量<code class="du kx ky kz la b">result</code>是灰色的，这意味着<code class="du kx ky kz la b">result</code>变量是不必要的。所以我们可以将这个方法重构如下。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="d73f" class="je jf hi la b fi lf lg l lh li">@Test(expected = NumberFormatException.class)<br/>public void checkISBNLengthTenOrThirteen(){</span><span id="1748" class="je jf hi la b fi lk lg l lh li">    ValidateISBN validateISBN  = new ValidateISBN();<br/>    validateISBN.checkISBN("012345678");<br/>}</span></pre><p id="1551" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要测试我们传递给<code class="du kx ky kz la b">checkISBN()</code>的ISBN是否是数值(尽管我们讨论了ISBN数字中的字母X)。为了检查它，我们将实现下面的测试。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="d49f" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkISBNNumeric(){</span><span id="f889" class="je jf hi la b fi lk lg l lh li">    <em class="kq">fail</em>();<br/>}</span></pre><p id="39a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我们可以将其调整为以下代码。因为我们正在传递一个字符串，我们可以期待一个<code class="du kx ky kz la b">NumberFormatException</code></p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="1766" class="je jf hi la b fi lf lg l lh li">@Test(expected = NumberFormatException.class)<br/>public void checkISBNNumeric(){</span><span id="0a77" class="je jf hi la b fi lk lg l lh li">    ValidateISBN validateISBN = new ValidateISBN();<br/>    validateISBN.checkISBN("helloworld");<br/>}</span></pre><p id="083f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们运行它，我们会得到一个错误。这是因为我们应该关注数字而不是字母。为了解决这个问题，我们稍微调整了一下我们的<code class="du kx ky kz la b">checkISBN()</code>代码。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="a449" class="je jf hi la b fi lf lg l lh li">public boolean checkISBN(String isbn) {<br/><br/>    if (isbn.length() == 10 || isbn.length() == 13) {<br/>        int total = 0;<br/>        for (int i = 0; i &lt; 10; i++) {<br/>            if (!Character.<em class="kq">isDigit</em>(isbn.charAt(i))){<br/>                throw new NumberFormatException("ISBN numbers can only have digits.");<br/>            }<br/>            total += isbn.charAt(i) * (10 - i);<br/>        }<br/>        if (total % 11 == 0) {<br/>            return true;<br/>        } else {<br/>            return false;<br/>        }<br/>    } else {<br/>        throw new NumberFormatException("ISBN number should have length of 10 or 13");<br/>    }</span></pre><p id="bc02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我们运行测试时，它通过了。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/3a3b34d8335690e5644a46dd0e43482c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LogEFGJGEXKDnDIQyFzU6g.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">运行checkISBNNumeric()方法</p></figure><p id="765b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以检查包含9个数字和字母“X”的ISBN号。检查我们是否可以创建一个新方法，以<code class="du kx ky kz la b">fail();</code>作为初始状态。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="42f7" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkContainsX(){</span><span id="4a4a" class="je jf hi la b fi lk lg l lh li">    <em class="kq">fail</em>();<br/>}</span></pre><p id="1747" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以将以下内容添加到测试中，当我们运行它时，我们会得到一个<code class="du kx ky kz la b">NumberFormatException</code>,这要感谢我们之前所做的测试和代码修正。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="30c1" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkContainsX(){</span><span id="5b85" class="je jf hi la b fi lk lg l lh li">    ValidateISBN validateISBN = new ValidateISBN();<br/>    boolean result = validateISBN.checkISBN("080442957X");<br/>    <em class="kq">assertTrue</em>(result);<br/>}</span></pre><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/c6c7e6452bccd7fd4f59386c643c8dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uiESrQWqKXBETtLjm879_g.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">运行checkContainsX()方法。</p></figure><p id="a88f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，为了解决这个问题，我们可以改变我们的<code class="du kx ky kz la b">checkISBN()</code>方法。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="b0e1" class="je jf hi la b fi lf lg l lh li">public boolean checkISBN(String isbn) {<br/><br/>    if (isbn.length() == 10 || isbn.length() == 13) {<br/>        int total = 0;<br/>        for (int i = 0; i &lt; 10; i++) {<br/>            if (!Character.<em class="kq">isDigit</em>(isbn.charAt(i))) {<br/>                if (i == 9 &amp;&amp; isbn.charAt(i) == 'X') {<br/>                    //do nothing<br/>                } else {<br/>                    throw new NumberFormatException("ISBN numbers can only have digits.");<br/>                }<br/>            }<br/>            total += isbn.charAt(i) * (10 - i);<br/>        }<br/>        if (total % 11 == 0) {<br/>            return true;<br/>        } else {<br/>            return false;<br/>        }<br/>    } else {<br/>        throw new NumberFormatException("ISBN number should have length of 10 or 13");<br/>    }<br/>}</span></pre><p id="304d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以看到<code class="du kx ky kz la b">if(i==9 &amp;&amp; isbn.charAt(i)=='X')</code>我们什么都不做，否则我们抛出一个异常。如果我们运行这个，我们会得到一个错误，说我们的断言是错误的。这是因为我们需要将10乘以1加到总数上。因此，我们可以通过在添加注释<code class="du kx ky kz la b">//do nothing</code>的地方添加<code class="du kx ky kz la b">total+=10;</code>来修复它，并在<code class="du kx ky kz la b">total += isbn.charAt(i) * (10 — i);</code>处添加一个<code class="du kx ky kz la b">else</code>块来修复我们的正常流程。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="b57a" class="je jf hi la b fi lf lg l lh li">public boolean checkISBN(String isbn) {<br/><br/>    if (isbn.length() == 10 || isbn.length() == 13) {<br/>        int total = 0;<br/>        for (int i = 0; i &lt; 10; i++) {<br/>            if (!Character.<em class="kq">isDigit</em>(isbn.charAt(i))) {<br/>                if (i == 9 &amp;&amp; isbn.charAt(i) == 'X') {<br/>                    total += 10;<br/>                } else {<br/>                    throw new NumberFormatException("ISBN numbers can only have digits.");<br/>                }<br/>            } else {<br/>                total += isbn.charAt(i) * (10 - i);<br/>            }<br/>        }<br/>        if (total % 11 == 0) {<br/>            return true;<br/>        } else {<br/>            return false;<br/>        }<br/>    } else {<br/>        throw new NumberFormatException("ISBN number should have length of 10 or 13");<br/>    }<br/>}</span></pre><p id="abe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我们运行这个测试时，仍然会得到一个错误。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/36bffbd09ef52033f141e81611b116dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5xc68MCyvaEKJT60Pg72hA.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">运行checkContainsX()方法</p></figure><p id="dc78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了理解这一点，我们将调试指针添加到<code class="du kx ky kz la b">checkISBN()</code>方法的第21行和第23行，并调试测试。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/ee98a9ff085a6fdc11d0acd4314fcf2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ejl5zfIULMlVc4kUj_ZqsA.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">调试checkISBN()方法和checkContainsX()方法</p></figure><p id="8d88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们调试它时，我们得到的<code class="du kx ky kz la b">total</code>是2801，这是不可能的，因为我们知道<code class="du kx ky kz la b">total</code>是209(我们之前讨论过的例子)。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/dd491039392e183c71101b2ee592ac44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UIxbNT7MFW5vDPML_FosOA.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">调试checkISBN()方法和checkContainsX()方法</p></figure><p id="d7de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，为什么会出现这种情况呢？这是因为第11行中的<code class="du kx ky kz la b">isbn.charAt()</code>方法返回ASCII值，并且该值正在被相乘。我们可以使用<code class="du kx ky kz la b">Characters.getNumericValue()</code>方法解决这个问题。之后的<code class="du kx ky kz la b">checkISBN()</code>方法是这样的。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="c057" class="je jf hi la b fi lf lg l lh li">public boolean checkISBN(String isbn) {<br/><br/>    if (isbn.length() == 10 || isbn.length() == 13) {<br/>        int total = 0;<br/>        for (int i = 0; i &lt; 10; i++) {<br/>            if (!Character.<em class="kq">isDigit</em>(isbn.charAt(i))) {<br/>                if (i == 9 &amp;&amp; isbn.charAt(i) == 'X') {<br/>                    total += 10;<br/>                } else {<br/>                    throw new NumberFormatException("ISBN numbers can only have digits.");<br/>                }<br/>            } else {<br/>                total += Character.<em class="kq">getNumericValue</em>(isbn.charAt(i)) * (10 - i);<br/>            }<br/>        }<br/>        if (total % 11 == 0) {<br/>            return true;<br/>        } else {<br/>            return false;<br/>        }<br/>    } else {<br/>        throw new NumberFormatException("ISBN number should have length of 10 or 13");<br/>    }<br/>}</span></pre><p id="e56f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我们运行<code class="du kx ky kz la b">checkContainsX()</code>测试时，它通过了。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/c3176a2eb50c463a5e6eaca90238a023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvV73CP37_5c6xFTpJjzGQ.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">运行checkContainsX()方法</p></figure><p id="5bc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经实现了10位数的ISBN号和9位数的ISBN号以及' X '的代码。所以现在我们需要完成的唯一部分是13位的ISBN号。为了实现这一点，我们将首先创建一个测试。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="a138" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkValidThirteenDigitISBN(){</span><span id="fa12" class="je jf hi la b fi lk lg l lh li">    <em class="kq">fail</em>();<br/>}</span></pre><p id="2905" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以调整我们的测试用例来检查13位数字。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="381a" class="je jf hi la b fi lf lg l lh li">@Test<br/>public void checkValidThirteenDigitISBN(){</span><span id="d80a" class="je jf hi la b fi lk lg l lh li">    ValidateISBN validateISBN = new ValidateISBN();<br/>    boolean result = validateISBN.checkISBN("9780306406157");<br/>    <em class="kq">assertTrue</em>(result);<br/>}</span></pre><p id="6e81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们知道这是一个ISBN号，因为这是我们用来讨论业务逻辑的。但是当我们运行这个时，我们得到一个错误。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/b6b841f9efcdc18edacde30f1f32e56f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zFA8t9FYOydcOC9Qm-xbHA.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">正在运行checkValidThirteenDigitISBN()方法</p></figure><p id="b306" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是因为我们还没有为此实现业务逻辑。为此，我们可以将<code class="du kx ky kz la b">checkISBN()</code>方法改为下面的代码片段。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="c8ee" class="je jf hi la b fi lf lg l lh li">public boolean checkISBN(String isbn) {<br/><br/>    if (isbn.length() == 10 || isbn.length() == 13) {<br/>        if (isbn.length() == 13) {<br/>            int total = 0;<br/>            for (int i = 0; i &lt; 13; i++) {<br/>                if (Character.<em class="kq">isDigit</em>(isbn.charAt(i))) {<br/>                    if (i % 2 == 0) {<br/>                        total += Character.<em class="kq">getNumericValue</em>(isbn.charAt(i)) * 1;<br/>                    } else {<br/>                        total += Character.<em class="kq">getNumericValue</em>(isbn.charAt(i)) * 3;<br/>                    }<br/>                } else {<br/>                    throw new NumberFormatException("ISBN numbers can only have digits.");<br/>                }<br/>            }<br/>            if (total % 10 == 0) {<br/>                return true;<br/>            } else {<br/>                return false;<br/>            }<br/>        } else {<br/>            int total = 0;<br/>            for (int i = 0; i &lt; 10; i++) {<br/>                if (!Character.<em class="kq">isDigit</em>(isbn.charAt(i))) {<br/>                    if (i == 9 &amp;&amp; isbn.charAt(i) == 'X') {<br/>                        total += 10;<br/>                    } else {<br/>                        throw new NumberFormatException("ISBN numbers can only have digits.");<br/>                    }<br/>                } else {<br/>                    total += Character.<em class="kq">getNumericValue</em>(isbn.charAt(i)) * (10 - i);<br/>                }<br/>            }<br/>            if (total % 11 == 0) {<br/>                return true;<br/>            } else {<br/>                return false;<br/>            }<br/>        }<br/>    } else {<br/>        throw new NumberFormatException("ISBN number should have length of 10 or 13");<br/>    }<br/>}</span></pre><p id="dc18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在改变了<code class="du kx ky kz la b">checkISBN()</code>方法并运行测试之后，它就通过了。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/bcd86208559cbf020732f0ec041c882a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kNwQpg5KjEyJmIf2gVejMw.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">正在运行checkValidThirteenDigitISBN()方法</p></figure><p id="d862" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然，我们的代码，<code class="du kx ky kz la b">checkISBN()</code>运行良好，但看起来很乱。为了清理它，我们进行了重构。这是通过创建常量和方法来完成的。重构代码后，看起来是这样的。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="32f7" class="je jf hi la b fi lf lg l lh li">package com.book.tdd;<br/><br/>public class ValidateISBN {<br/><br/>    public static final int <em class="kq">ISBN_SHORT </em>= 10;<br/>    public static final int <em class="kq">ISBN_LONG </em>= 13;<br/>    public static final int <em class="kq">ISBN_SHORT_VALIDATOR </em>= 11;<br/>    public static final int <em class="kq">ISBN_LONG_VALIDATOR </em>= 10;<br/><br/>    public boolean checkISBN(String isbn) {<br/><br/>        if (isbn.length() == <em class="kq">ISBN_SHORT </em>|| isbn.length() == <em class="kq">ISBN_LONG</em>) {<br/>            if (isbn.length() == <em class="kq">ISBN_LONG</em>) {<br/>                return checkISBNThirteenDigits(isbn);<br/>            } else {<br/>                return checkISBNTenDigits(isbn);<br/>            }<br/>        } else {<br/>            throw new NumberFormatException("ISBN number should have length of 10 or 13");<br/>        }<br/>    }<br/><br/>    private boolean checkISBNTenDigits(String isbn) {<br/><br/>        int total = 0;<br/>        for (int i = 0; i &lt; <em class="kq">ISBN_SHORT</em>; i++) {<br/>            if (!Character.<em class="kq">isDigit</em>(isbn.charAt(i))) {<br/>                if (i == 9 &amp;&amp; isbn.charAt(i) == 'X') {<br/>                    total += 10;<br/>                } else {<br/>                    throw new NumberFormatException("ISBN numbers can only have digits.");<br/>                }<br/>            } else {<br/>                total += Character.<em class="kq">getNumericValue</em>(isbn.charAt(i)) * (<em class="kq">ISBN_SHORT </em>- i);<br/>            }<br/>        }<br/>        if (total % <em class="kq">ISBN_SHORT_VALIDATOR </em>== 0) {<br/>            return true;<br/>        }<br/>        return false;<br/>    }<br/><br/>    private boolean checkISBNThirteenDigits(String isbn) {<br/><br/>        int total = 0;<br/>        for (int i = 0; i &lt; <em class="kq">ISBN_LONG</em>; i++) {<br/>            if (Character.<em class="kq">isDigit</em>(isbn.charAt(i))) {<br/>                if (i % 2 == 0) {<br/>                    total += Character.<em class="kq">getNumericValue</em>(isbn.charAt(i)) * 1;<br/>                } else {<br/>                    total += Character.<em class="kq">getNumericValue</em>(isbn.charAt(i)) * 3;<br/>                }<br/>            } else {<br/>                throw new NumberFormatException("ISBN numbers can only have digits.");<br/>            }<br/>        }<br/>        if (total % <em class="kq">ISBN_LONG_VALIDATOR </em>== 0) {<br/>            return true;<br/>        }<br/>        return false;<br/>    }<br/>}</span></pre><p id="ee6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们运行测试套件，我们会得到以下结果。</p><figure class="kf kg kh ki fd kj er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/9d809d1154ce8408d5480c903f7d27cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*noJUWbB07kpOw4nU_JYUUw.png"/></div></div><p class="km kn et er es ko kp bd b be z dx translated">所有测试都通过了</p></figure><p id="56fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是查看我们的测试文件，我们可以看到我们在一遍又一遍地使用变量<code class="du kx ky kz la b">validateISBN</code>。为了避免这种情况，我们可以使用<code class="du kx ky kz la b">@Before</code>注释。在一个方法中使用注释之后，我们得到了下面的最终测试套件。</p><pre class="kf kg kh ki fd lb la lc ld aw le bi"><span id="47c0" class="je jf hi la b fi lf lg l lh li">package com.book.tdd;<br/><br/>import org.junit.Before;<br/>import org.junit.Test;<br/><br/>import static org.junit.Assert.*;<br/><br/>public class ValidateISBNTests {<br/><br/>    ValidateISBN validateISBN;<br/><br/>    @Before<br/>    public void setup() {<br/><br/>        validateISBN = new ValidateISBN();<br/>    }<br/><br/>    @Test<br/>    public void checkValidISBN() {<br/><br/>        boolean result = validateISBN.checkISBN("0140449116");<br/>        <em class="kq">assertTrue</em>(result);<br/>    }<br/><br/>    @Test<br/>    public void checkInvalidISBN() {<br/><br/>        boolean result = validateISBN.checkISBN("0140441927");<br/>        <em class="kq">assertFalse</em>(result);<br/>    }<br/><br/>    @Test(expected = NumberFormatException.class)<br/>    public void checkISBNLengthTenOrThirteen() {<br/><br/>        validateISBN.checkISBN("012345678");<br/>    }<br/><br/>    @Test(expected = NumberFormatException.class)<br/>    public void checkISBNNumeric() {<br/><br/>        validateISBN.checkISBN("helloworld");<br/>    }<br/><br/>    @Test<br/>    public void checkContainsX() {<br/><br/>        boolean result = validateISBN.checkISBN("080442957X");<br/>        <em class="kq">assertTrue</em>(result);<br/>    }<br/><br/>    @Test<br/>    public void checkValidThirteenDigitISBN() {<br/><br/>        boolean result = validateISBN.checkISBN("9780306406157");<br/>        <em class="kq">assertTrue</em>(result);<br/>    }<br/>}</span></pre><h2 id="9812" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">最终注释</h2><p id="bdd1" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">你可以看到，通过使用TDD，我们可以构建无错误、高效的代码。这是大多数公司将TDD作为最佳实践的主要原因。</p><p id="19d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然我们在这里只使用了JUnit，但是在进行TDD时，完全依赖于<a class="ae jd" rel="noopener" href="/javarevisited/5-courses-to-learn-junit-and-mockito-in-2019-best-of-lot-f217d8b93688"> JUnit </a>几乎是不可能的。根据我们的实现，我们必须使用多个测试库来测试我们的代码。但是所有这些都是为了在我们的实现过程中使用TDD。我希望你们已经学会了如何使用TDD进行高效的实现。ISBN验证项目代码库的链接可以在<a class="ae jd" href="https://github.com/nipunaupeksha/tdd-isbn-validation" rel="noopener ugc nofollow" target="_blank">这里</a>找到。干杯！</p></div></div>    
</body>
</html>