<html>
<head>
<title>Spring Boot Drools Rule Engine Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Boot Drools规则引擎示例</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/spring-boot-drools-rule-engine-example-965eea437ee9?source=collection_archive---------0-----------------------#2021-10-22">https://medium.com/javarevisited/spring-boot-drools-rule-engine-example-965eea437ee9?source=collection_archive---------0-----------------------#2021-10-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2018/02/top-5-spring-microservices-courses-with-spring-boot-and-spring-cloud.html"><div class="er es if"><img src="../Images/a9387fd2c09f04fb3a7031aef64074d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*3uEd9tdztQ1vKdRIMktdKg.png"/></div></a></figure><p id="cf9c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">规则引擎</strong>可以用来实现复杂的业务规则。Drools是一个开源的业务规则管理系统，可以很容易地与spring boot应用程序集成。</p><p id="b357" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">KIE项目支持drools与spring boot框架等其他技术的集成。</p><p id="2a0c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在本文中，我们将学习如何集成Drools规则引擎，并使用spring boot实现一个简单的规则引擎服务。我们将使用DRL规则来创建。spring boot应用程序中的drl文件。</p><p id="1b92" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">文章中使用的<em class="jk">技术:</em>文章中使用的</strong></p><ul class=""><li id="a3ab" class="jl jm hi io b ip iq it iu ix jn jb jo jf jp jj jq jr js jt bi translated">春季开机版本:2.5.5</li><li id="2acd" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jq jr js jt bi translated">流口水</li><li id="bc00" class="jl jm hi io b ip ju it jv ix jw jb jx jf jy jj jq jr js jt bi translated">Java版本1.8</li></ul></div><div class="ab cl jz ka gp kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hb hc hd he hf"><h1 id="8a57" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">创建一个弹簧引导应用程序</h1><p id="ad86" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj hb bi translated">使用所需的依赖项创建一个spring boot应用程序。添加spring boot starter web依赖项。此外，将drools依赖项包含到spring boot应用程序的pom XML配置文件中。</p><p id="1fe6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下面是pom.xml文件的完整内容。</p><p id="5407" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="jk"> pom.xml </em> </strong></p><pre class="lj lk ll lm fd ln lo lp lq aw lr bi"><span id="111e" class="ls kh hi lo b fi lt lu l lv lw"><br/>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;project ae lx" href="http://maven.apache.org/POM/4.0.0" rel="noopener ugc nofollow" target="_blank"&gt;http://maven.apache.org/POM/4.0.0" xmlns:xsi="<a class="ae lx" href="http://www.w3.org/2001/XMLSchema-instance" rel="noopener ugc nofollow" target="_blank">http://www.w3.org/2001/XMLSchema-instance</a>"<br/>    xsi:schemaLocation="<a class="ae lx" href="http://maven.apache.org/POM/4.0.0" rel="noopener ugc nofollow" target="_blank">http://maven.apache.org/POM/4.0.0</a> <a class="ae lx" href="https://maven.apache.org/xsd/maven-4.0.0.xsd" rel="noopener ugc nofollow" target="_blank">https://maven.apache.org/xsd/maven-4.0.0.xsd</a>"&gt;<br/>    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br/>    &lt;parent&gt;<br/>        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;<br/>        &lt;version&gt;2.5.5&lt;/version&gt;<br/>        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;<br/>    &lt;/parent&gt;<br/>    &lt;groupId&gt;com.demo.example&lt;/groupId&gt;<br/>    &lt;artifactId&gt;spring-boot-drools-example&lt;/artifactId&gt;<br/>    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;<br/>    &lt;name&gt;spring-boot-drools-example&lt;/name&gt;<br/>    &lt;description&gt;spring-boot-drools-example&lt;/description&gt;<br/>    &lt;properties&gt;<br/>        &lt;java.version&gt;1.8&lt;/java.version&gt;<br/>        &lt;maven-jar-plugin.version&gt;3.1.1&lt;/maven-jar-plugin.version&gt;<br/>        &lt;drools.version&gt;7.59.0.Final&lt;/drools.version&gt;<br/>    &lt;/properties&gt;<br/>    &lt;dependencies&gt;<br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;<br/>        &lt;/dependency&gt;<br/> <br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;<br/>            &lt;artifactId&gt;lombok&lt;/artifactId&gt;<br/>            &lt;optional&gt;true&lt;/optional&gt;<br/>        &lt;/dependency&gt;<br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;<br/>            &lt;scope&gt;test&lt;/scope&gt;<br/>        &lt;/dependency&gt;<br/>         <br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.drools&lt;/groupId&gt;<br/>            &lt;artifactId&gt;drools-core&lt;/artifactId&gt;<br/>            &lt;version&gt;${drools.version}&lt;/version&gt;<br/>        &lt;/dependency&gt;<br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.drools&lt;/groupId&gt;<br/>            &lt;artifactId&gt;drools-compiler&lt;/artifactId&gt;<br/>            &lt;version&gt;${drools.version}&lt;/version&gt;<br/>        &lt;/dependency&gt;<br/>        &lt;dependency&gt;<br/>            &lt;groupId&gt;org.drools&lt;/groupId&gt;<br/>            &lt;artifactId&gt;drools-decisiontables&lt;/artifactId&gt;<br/>            &lt;version&gt;${drools.version}&lt;/version&gt;<br/>        &lt;/dependency&gt;<br/>    &lt;/dependencies&gt;<br/>    &lt;build&gt;<br/>        &lt;plugins&gt;<br/>            &lt;plugin&gt;<br/>                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;<br/>                &lt;configuration&gt;<br/>                    &lt;excludes&gt;<br/>                        &lt;exclude&gt;<br/>                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;<br/>                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;<br/>                        &lt;/exclude&gt;<br/>                    &lt;/excludes&gt;<br/>                &lt;/configuration&gt;<br/>            &lt;/plugin&gt;<br/>        &lt;/plugins&gt;<br/>    &lt;/build&gt;<br/>&lt;/project&gt;</span></pre></div><div class="ab cl jz ka gp kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hb hc hd he hf"><h1 id="9ba0" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">配置drools应用程序</h1><p id="9b2e" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj hb bi translated">创建一个名为<strong class="io hj"> DroolsConfig </strong>的配置java类。</p><p id="e950" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">将以下配置添加到java类中。</p><p id="639e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"><em class="jk">DroolsConfig.java</em></strong></p><pre class="lj lk ll lm fd ln lo lp lq aw lr bi"><span id="6a4e" class="ls kh hi lo b fi lt lu l lv lw">package com.demo.example.config;<br/> <br/>import org.kie.api.KieServices;<br/>import org.kie.api.builder.KieBuilder;<br/>import org.kie.api.builder.KieFileSystem;<br/>import org.kie.api.builder.KieModule;<br/>import org.kie.api.runtime.KieContainer;<br/>import org.kie.internal.io.ResourceFactory;<br/>import org.springframework.context.annotation.Bean;<br/>import org.springframework.context.annotation.Configuration;<br/> <br/><a class="ae lx" href="http://twitter.com/Configuration" rel="noopener ugc nofollow" target="_blank">@Configuration</a><br/>public class DroolsConfig {<br/> <br/>    private static final String RULES_CUSTOMER_RULES_DRL = "rules/customer-discount.drl";<br/>    private static final KieServices kieServices = KieServices.Factory.get();<br/> <br/>    <a class="ae lx" href="http://twitter.com/Bean" rel="noopener ugc nofollow" target="_blank">@Bean</a><br/>    public KieContainer kieContainer() {<br/>        KieFileSystem kieFileSystem = kieServices.newKieFileSystem();<br/>        kieFileSystem.write(ResourceFactory.newClassPathResource(RULES_CUSTOMER_RULES_DRL));<br/>        KieBuilder kb = kieServices.newKieBuilder(kieFileSystem);<br/>        kb.buildAll();<br/>        KieModule kieModule = kb.getKieModule();<br/>        KieContainer kieContainer = kieServices.newKieContainer(kieModule.getReleaseId());<br/>        return kieContainer;<br/>    }<br/>}</span></pre><p id="683c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">配置类定义了一个spring bean<strong class="io hj">kie container</strong>。KieContainer用于通过加载应用程序的<strong class="io hj"> /resources </strong>文件夹下的规则文件来构建规则引擎。</p><p id="a50f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们创建了<strong class="io hj"> KieFileSystem </strong>实例，配置了规则引擎，并从应用程序的资源目录中加载了DRL文件。</p><p id="c83e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">此外，我们可以使用<strong class="io hj"> KieBuilder </strong>实例来构建drools模块。我们可以使用<strong class="io hj"> KieSerive </strong> singleton实例来创建KieBuilder实例。</p><p id="18ef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，我们使用KieService创建一个KieContainer，并将其配置为一个spring bean。</p></div><div class="ab cl jz ka gp kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hb hc hd he hf"><h1 id="258b" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">添加模型类</h1><p id="da9f" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj hb bi translated">创建一个名为<strong class="io hj"> OrderRequest </strong>的Pojo类，并定义以下字段。</p><p id="343c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们接收这个类作为规则引擎的请求对象，我们还将这些字段作为输入发送给定义的规则，以计算给定客户订单的折扣金额。</p><p id="c5ed" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"><em class="jk">OrderRequest.java</em></strong></p><pre class="lj lk ll lm fd ln lo lp lq aw lr bi"><span id="2a62" class="ls kh hi lo b fi lt lu l lv lw">package com.demo.example.model;<br/> <br/>import lombok.Getter;<br/>import lombok.Setter;<br/> <br/><a class="ae lx" href="http://twitter.com/Getter" rel="noopener ugc nofollow" target="_blank">@Getter</a><br/><a class="ae lx" href="http://twitter.com/Setter" rel="noopener ugc nofollow" target="_blank">@Setter</a><br/>public class OrderRequest {<br/> <br/>    private String customerNumber;<br/>    private Integer age;<br/>    private Integer amount;<br/>    private CustomerType customerType;<br/>}</span></pre><p id="482b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">另外，定义一个名为<strong class="io hj"> CustomerType </strong>的java枚举，如下所示。枚举保存客户类型，规则引擎根据该值计算客户订单折扣百分比。</p><p id="3e88" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"><em class="jk">CustomerType.java</em></strong></p><pre class="lj lk ll lm fd ln lo lp lq aw lr bi"><span id="aa8c" class="ls kh hi lo b fi lt lu l lv lw">package com.demo.example.model;<br/> <br/>public enum CustomerType {<br/>    LOYAL, NEW, DISSATISFIED;<br/> <br/>    public String getValue() {<br/>        return this.toString();<br/>    }<br/>}</span></pre><p id="fdc2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，创建一个名为OrderDiscount的响应POJO类，如下所示。</p><p id="de08" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"><em class="jk">OrderDiscount.java</em></strong></p><pre class="lj lk ll lm fd ln lo lp lq aw lr bi"><span id="85f7" class="ls kh hi lo b fi lt lu l lv lw">package com.demo.example.model;<br/> <br/>import lombok.Getter;<br/>import lombok.Setter;<br/> <br/><a class="ae lx" href="http://twitter.com/Getter" rel="noopener ugc nofollow" target="_blank">@Getter</a><br/><a class="ae lx" href="http://twitter.com/Setter" rel="noopener ugc nofollow" target="_blank">@Setter</a><br/>public class OrderDiscount {<br/> <br/>    private Integer discount = 0;<br/>}</span></pre><p id="8ccf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将使用上述响应对象返回计算出的折扣。</p></div><div class="ab cl jz ka gp kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hb hc hd he hf"><h1 id="6974" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">定义drools规则</h1><p id="c2f9" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj hb bi translated">在名为<strong class="io hj"> customer-discount.drl </strong>的文件中创建drools规则。将文件添加到目录<strong class="io hj">/src/main/resources/rules</strong>下。</p><pre class="lj lk ll lm fd ln lo lp lq aw lr bi"><span id="91e4" class="ls kh hi lo b fi lt lu l lv lw">import com.demo.example.model.OrderRequest;<br/>import com.demo.example.model.CustomerType;<br/>global com.demo.example.model.OrderDiscount orderDiscount;<br/> <br/>dialect "mvel"<br/> <br/>rule "Age based discount"<br/>    when<br/>        OrderRequest(age &lt; 20 || age &gt; 50)<br/>    then<br/>        System.out.println("==========Adding 10% discount for Kids/ senior customer=============");<br/>        orderDiscount.setDiscount(orderDiscount.getDiscount() + 10);<br/>end<br/> <br/>rule "Customer type based discount - Loyal customer"<br/>    when<br/>        OrderRequest(customerType.getValue == "LOYAL")<br/>    then<br/>        System.out.println("==========Adding 5% discount for LOYAL customer=============");<br/>        orderDiscount.setDiscount(orderDiscount.getDiscount() + 5);<br/>end<br/>     <br/>rule "Customer type based discount - others"<br/>    when<br/>        OrderRequest(customerType.getValue != "LOYAL")<br/>    then<br/>        System.out.println("==========Adding 3% discount for NEW or DISSATISFIED customer=============");<br/>        orderDiscount.setDiscount(orderDiscount.getDiscount() + 3);<br/>end<br/> <br/>rule "Amount based discount"<br/>    when<br/>        OrderRequest(amount &gt; 1000L)<br/>    then<br/>        System.out.println("==========Adding 5% discount for amount more than 1000$=============");<br/>        orderDiscount.setDiscount(orderDiscount.getDiscount() + 5);<br/>end</span></pre><p id="7b00" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们需要导入DRL文件中使用的模型。</p><p id="113a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们还使用了一个名为<strong class="io hj"> orderDiscount </strong>的全局参数。全局参数可以在多个规则之间共享。</p><p id="e344" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">DRL文件可以包含一个或多个规则。我们可以使用<a class="ae lx" href="http://mvel.documentnode.com/" rel="noopener ugc nofollow" target="_blank"> mvel </a>语法来指定规则。同样，每个规则都可以用使用<strong class="io hj">规则</strong>关键字的描述来描述。</p><p id="5973" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以使用<strong class="io hj"> when-then </strong>语法来定义规则的条件。</p><p id="580f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">基于订单请求的输入值，我们将折扣添加到结果中。如果规则表达式匹配，每个规则都会向全局结果变量添加额外的折扣。</p></div><div class="ab cl jz ka gp kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hb hc hd he hf"><h1 id="eae1" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">添加服务层</h1><p id="5c2c" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj hb bi translated">创建一个名为<strong class="io hj"> OrderDiscountService </strong>的服务java类，并添加以下内容。</p><pre class="lj lk ll lm fd ln lo lp lq aw lr bi"><span id="fd0d" class="ls kh hi lo b fi lt lu l lv lw">package com.demo.example.service;<br/> <br/>import org.kie.api.runtime.KieContainer;<br/>import org.kie.api.runtime.KieSession;<br/>import org.springframework.beans.factory.annotation.Autowired;<br/>import org.springframework.stereotype.Service;<br/> <br/>import com.demo.example.model.OrderDiscount;<br/>import com.demo.example.model.OrderRequest;<br/> <br/><a class="ae lx" href="http://twitter.com/Service" rel="noopener ugc nofollow" target="_blank">@Service</a><br/>public class OrderDiscountService {<br/> <br/>    <a class="ae lx" href="http://twitter.com/Autowired" rel="noopener ugc nofollow" target="_blank">@Autowired</a><br/>    private KieContainer kieContainer;<br/> <br/>    public OrderDiscount getDiscount(OrderRequest orderRequest) {<br/>        OrderDiscount orderDiscount = new OrderDiscount();<br/>        KieSession kieSession = kieContainer.newKieSession();<br/>        kieSession.setGlobal("orderDiscount", orderDiscount);<br/>        kieSession.insert(orderRequest);<br/>        kieSession.fireAllRules();<br/>        kieSession.dispose();<br/>        return orderDiscount;<br/>    }<br/>}</span></pre><p id="2432" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们正在注入<strong class="io hj"> KieContainer </strong>实例并创建一个<strong class="io hj"> KieSession </strong>实例。</p><p id="e431" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们还设置了一个类型为<strong class="io hj"> OrderDiscount </strong>的全局参数，它将保存规则的执行结果。</p><p id="1be4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要将请求对象传递给DRL文件，我们可以使用<strong class="io hj"> insert() </strong>方法。</p><p id="aa4c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们通过调用<strong class="io hj"> fireAllRules() </strong>方法来触发所有的规则。最后通过调用KieSession的<strong class="io hj"> dispose() </strong>方法终止会话。</p></div><div class="ab cl jz ka gp kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hb hc hd he hf"><h1 id="e04a" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">添加REST API</h1><p id="96dc" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj hb bi translated">创建一个名为<strong class="io hj">order discountcontroller</strong>的REST API类，并添加以下内容。</p><p id="6110" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">控制器使用端点<strong class="io hj"> /get-discount </strong>公开一个POST API。端点需要一个OrderRequest对象，并返回计算的OrderDiscount响应。</p><pre class="lj lk ll lm fd ln lo lp lq aw lr bi"><span id="f5ec" class="ls kh hi lo b fi lt lu l lv lw">package com.demo.example.controller;<br/> <br/>import org.springframework.beans.factory.annotation.Autowired;<br/>import org.springframework.http.HttpStatus;<br/>import org.springframework.http.ResponseEntity;<br/>import org.springframework.web.bind.annotation.PostMapping;<br/>import org.springframework.web.bind.annotation.RequestBody;<br/>import org.springframework.web.bind.annotation.RestController;<br/> <br/>import com.demo.example.model.OrderDiscount;<br/>import com.demo.example.model.OrderRequest;<br/>import com.demo.example.service.OrderDiscountService;<br/> <br/><a class="ae lx" href="http://twitter.com/RestController" rel="noopener ugc nofollow" target="_blank">@RestController</a><br/>public class OrderDiscountController {<br/> <br/>    <a class="ae lx" href="http://twitter.com/Autowired" rel="noopener ugc nofollow" target="_blank">@Autowired</a><br/>    private OrderDiscountService orderDiscountService;<br/> <br/>    <a class="ae lx" href="http://twitter.com/PostMapping" rel="noopener ugc nofollow" target="_blank">@PostMapping</a>("/get-discount")<br/>    public ResponseEntity&lt;OrderDiscount&gt; getDiscount(<a class="ae lx" href="http://twitter.com/RequestBody" rel="noopener ugc nofollow" target="_blank">@RequestBody</a> OrderRequest orderRequest) {<br/>        OrderDiscount discount = orderDiscountService.getDiscount(orderRequest);<br/>        return new ResponseEntity&lt;&gt;(discount, HttpStatus.OK);<br/>    }<br/>}</span></pre></div><div class="ab cl jz ka gp kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hb hc hd he hf"><h1 id="5cff" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">测试应用程序</h1><p id="43d0" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj hb bi translated">运行spring boot应用程序，并通过发送客户订单请求JSON来访问REST API端点。</p><p id="d83e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于年龄&lt; 20 and amount &gt; 1000的忠诚客户类型，根据我们定义的规则，我们应该获得20%的折扣。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2018/05/top-5-courses-to-learn-spring-boot-in.html"><div class="er es ly"><img src="../Images/67d9403aee1cb1c563806c3873a429a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*A4n9ZK1YAoipBc-OmM3Q8w.jpeg"/></div></a></figure><p id="3a76" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们还可以观察输入请求的应用折扣。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/05/top-20-spring-boot-interview-questions-answers.html"><div class="er es lz"><img src="../Images/cf9e5370b0f7b363e4ec8b32e86368fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*PCvivbrvquE5dQtDw0JahQ.jpeg"/></div></a></figure><p id="65df" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，尝试不同的值，如下所示。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2018/02/top-5-restful-web-services-with-spring-courses-for-experienced-java-programmers.html"><div class="er es ma"><img src="../Images/0c42850bab48e0628f9bd565635e96f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*0sRcGOohtUvo7V3N3X-P2w.jpeg"/></div></a></figure><p id="634d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们可以观察到这次只应用了2个规则。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><a href="https://www.java67.com/2021/02/spring-boot-actuator-interview-questions-answers-java.html"><div class="er es mb"><img src="../Images/ee6fdc7e362cceb0b96ddee9f42f7c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*QlGpCl5JElxUHs_MwQrGKQ.jpeg"/></div></a></figure></div><div class="ab cl jz ka gp kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hb hc hd he hf"><h1 id="d529" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论</h1><p id="98b1" class="pw-post-body-paragraph im in hi io b ip le ir is it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj hb bi translated">在本文中，我们学习了如何使用spring boot框架创建drools规则引擎。</p><p id="0136" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们还学习了如何使用DRL文件来定义业务规则。</p><p id="69ee" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">快乐编码..</p></div></div>    
</body>
</html>