<html>
<head>
<title>Experiencing Spring Batch.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">体验春批。</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/experiencing-spring-batch-204bc1d27a60?source=collection_archive---------1-----------------------#2021-04-18">https://medium.com/javarevisited/experiencing-spring-batch-204bc1d27a60?source=collection_archive---------1-----------------------#2021-04-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ih ii ij ik er es paragraph-image"><div role="button" tabindex="0" class="il im di in bf io"><div class="er es ig"><img src="../Images/2671faa02cef4a772ff9777615da2285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPf_l3R-87yQDDjAn-E0og.jpeg"/></div></div><p class="ir is et er es it iu bd b be z dx translated">#图片来自JavainUse</p></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="6e95" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Spring batch是为批量数据处理开发和使用的轻量级框架。与基于shell和db的批处理相比，它更加高效和灵活。</p><p id="e8b1" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Spring batch是基于Spring框架的原理设计的，这使得开发工作更加灵活，并允许增强它以提高服务水平。</p><p id="c2a4" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Spring batch内部不提供任何调度功能，因此我们可以使用第三方调度程序，如Tivoli、Control-M等，或者我们可以使用executor框架通过自定义线程实现来调度它，以进行多任务并行处理或有序处理。</p><p id="848a" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在这篇文章中，我将解释spring batch在开发活动中实现的两种方法，并且我将分享自定义的调度程序。</p><h2 id="2bc1" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated">Spring Batch的基本架构:</h2><figure class="kw kx ky kz fd ik er es paragraph-image"><a href="https://www.java67.com/2017/11/top-5-free-core-spring-mvc-courses-learn-online.html"><div class="er es kv"><img src="../Images/5c6378d39498a16d0aab1d678c6cc3e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*-MkIEtzrx1AnRXv1eW9log.jpeg"/></div></a></figure><p id="42dd" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">批处理架构包含三个主要组件，即<strong class="je hj">应用程序、批处理核心</strong>和<strong class="je hj">批处理基础设施</strong>。</p><p id="1feb" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj">应用程序</strong>包含了所有的作业及其基于spring batch框架构建的代码。<strong class="je hj">批处理核心</strong>包含启动批处理作业所需的所有API。<strong class="je hj"> Batch Infra </strong>是另一个重要的组件，包含应用程序和核心组件使用的所有读取器、写入器和处理器。</p><figure class="kw kx ky kz fd ik er es paragraph-image"><a href="https://javarevisited.blogspot.com/2018/06/top-6-spring-framework-online-courses-Java-programmers.html"><div class="er es la"><img src="../Images/7d7c51e5e6a586196271c8c14bccb572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*27olFBMayd4NI4A1CCIWNg.jpeg"/></div></a></figure><p id="5cad" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">上图显示了spring批处理的核心，即单个批处理中可以有多个作业，并且单个作业可以有多个步骤。每个作业将由作业启动器触发，我将在以后文章中解释多种类型的作业启动器。</p><h2 id="ba3d" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated">使用Spring批处理</h2><p id="0a98" class="pw-post-body-paragraph jc jd hi je b jf lb jh ji jj lc jl jm jn ld jp jq jr le jt ju jv lf jx jy jz hb bi translated">Spring batch可以使用一个<a class="ae lg" href="https://javarevisited.blogspot.com/2013/06/spring-helloworld-example-in-java-using-3.0-dependency-injection.html#axzz5yW1NnuQ4" rel="noopener ugc nofollow" target="_blank"> XML文件</a>或<a class="ae lg" href="https://www.java67.com/2019/10/spring-helloworld-example-in-Java-eclipse.html" rel="noopener ugc nofollow" target="_blank"> Java类</a>来配置，在本文中我将使用XML文件来解释spring batch。在spring batch的实现过程中，我创建了两个xml文件:</p><p id="0d62" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj"> 1。definition context . XML</strong>(非常类似于bean和其他配置声明的spring上下文)</p><p id="6d0b" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hj"> 2。BatchJobConfig.xml </strong>(所有的作业和步骤以及其他task-let操作都在其中声明)</p><p id="f796" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">由于代码共享的限制，我将共享两个xml的示例以供参考，并解释相同的内容以使您更好地理解。</p><h2 id="6e71" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated"><strong class="ak"><em class="if">definition context . XML:</em></strong></h2><blockquote class="lh li lj"><p id="b1e6" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><em class="hi">&lt;beans xmlns = " http://www . spring framework . org/schema/beans " http://www . spring framework . org/schema/beans/spring-beans . xsd&gt;</em>&lt;上下文:component-scan base-package = " package "/&gt;</p><p id="1676" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><bean class="”org.springframework.batch.core.scope.StepScope”"/></p><p id="2f44" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><bean id="”config”" class="”org.springframework.beans.factory.config.PropertiesFactoryBean”"> <property name="”location”"> <value>类路径:*。属性</value> </property> </bean></p><p id="ccaa" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><bean id="”jdbcTemplate”" class="”org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate”"> <constructor-arg ref="”dataSource&quot;"/> </bean></p><p id="3fed" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><property name="”dataSource”" ref="”dataSource&quot;"/></p><p id="3d3c" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><bean id="”jobLauncher”" class="”org.springframework.batch.core.launch.support.SimpleJobLauncher”" scope="”singleton”"> <property name="”jobRepository”" ref="”jobRepository”"/> <property name="”taskExecutor”"> <bean class="”org.springframework.core.task.SimpleAsyncTaskExecutor”"/> </property> </bean></p><p id="2026" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><bean id="”throttledTaskExecutor”" class="”org.springframework.batch.admin.util.ThrottledTaskExecutor”" scope="”singleton”">T17<property name="”throttleLimit”" value="”1&quot;"/>T19】</bean></p><p id="1f9c" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><executor id="”poolTaskExecutor”" pool-size="”500&quot;"/></p><p id="0e56" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><bean id="”dataSource&quot;" class="”org.springframework.jdbc.datasource.DriverManagerDataSource”"> <property name="”driverClassName”" value="”${dataSourceName}”"/> <property name="”url”" value="”${dataSourceUrl}”"/> <property name="”username”" value="”${userName}”"/> <property name="”password”" value="”${password}”"/></bean></p><p id="7d28" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"/><p id="1d52" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"/></blockquote><p id="9fac" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在上下文xml中，我们已经声明了所有的<a class="ae lg" href="https://javarevisited.blogspot.com/2011/09/spring-interview-questions-answers-j2ee.html" rel="noopener ugc nofollow" target="_blank"> spring bean </a>、<a class="ae lg" href="https://javarevisited.blogspot.com/2016/12/difference-between-thread-and-executor.html#axzz6ehrUZiIN" rel="noopener ugc nofollow" target="_blank">线程执行器</a>、任务执行器和数据源。它主要包含在整个应用中使用的通用配置，即批处理核心部分。</p><h2 id="40df" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated"><strong class="ak"> BatchJobConfig.xml </strong></h2><blockquote class="lh li lj"><p id="d6cd" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><em class="hi">&lt;beans xmlns = " http://www . spring framework . org/schema/beans "</em><a class="ae lg" href="http://www.springframework.org/schema/beans/spring-beans.xsd" rel="noopener ugc nofollow" target="_blank"><em class="hi">http://www . spring framework . org/schema/beans/spring-beans . xsd</em></a><em class="hi">&gt;</em>&lt;上下文:component-scan base-package = " package "/&gt;</p><p id="7b42" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><bean import:=""/></p><p id="d3e8" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><job id="“helloWorldJob”"><br/>&lt;step id = " step 1 " next = " step 2 "&gt;<br/>&lt;tasklet&gt;<br/>&lt;chunk reader = " MySQL reader " writer = " fileWriter "<br/>processor = " custom item processor "&gt;&lt;/chunk&gt;<br/>&lt;/tasklet&gt;<br/>&lt;/step&gt;</job></p><p id="e9cb" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><step id="“step2”"> <br/> &lt;小任务&gt;<br/>&lt;bean id:" tasklet 1 "&gt;<br/>&lt;/小任务&gt;<br/>&lt;/步骤&gt; <br/> &lt; /作业&gt;</step></p><p id="ddc0" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"/></blockquote><p id="84c8" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">而在作业配置XML中，从体系结构的角度来看，它包含应用程序和批处理基础部分。读取器和写入器可以是任何与数据库相关的操作，也可以是编程方式的基本数据处理。</p><h2 id="9c2d" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated">简要描述:</h2><p id="99d5" class="pw-post-body-paragraph jc jd hi je b jf lb jh ji jj lc jl jm jn ld jp jq jr le jt ju jv lf jx jy jz hb bi translated">一个<strong class="je hj">项阅读器</strong>从特定的源将数据读入Spring批处理应用程序，而一个<strong class="je hj">项写入器</strong>将数据从Spring批处理应用程序写入特定的目的地。一个<strong class="je hj">项目处理器</strong>是一个包含处理代码的类，它处理读入spring批处理的数据。</p><p id="c341" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果应用程序读取了<strong class="je hj"> "n" </strong>条记录，那么处理器中的代码将在每条记录上执行。当没有给出读取器和写入器时，一个<strong class="je hj">小任务</strong>充当SpringBatch的处理器。它只处理一个任务。</p><p id="134d" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">例如，如果我们正在编写一个作业，其中包含一个简单的步骤，我们从<a class="ae lg" rel="noopener" href="/javarevisited/top-5-courses-to-learn-mysql-in-2020-4ffada70656f"> MySQL数据库</a>中读取数据，对其进行处理并将其写入一个文件(平面文件),那么我们的步骤使用</p><ul class=""><li id="2b2b" class="lo lp hi je b jf jg jj jk jn lq jr lr jv ls jz lt lu lv lw bi translated">一个从MySQL数据库中读取数据的<strong class="je hj">阅读器</strong>。</li><li id="05db" class="lo lp hi je b jf lx jj ly jn lz jr ma jv mb jz lt lu lv lw bi translated">写入平面文件的<strong class="je hj">写入器</strong>。</li><li id="d64b" class="lo lp hi je b jf lx jj ly jn lz jr ma jv mb jz lt lu lv lw bi translated">一个<strong class="je hj">定制处理器</strong>，按照我们的意愿处理数据。</li></ul><blockquote class="lh li lj"><p id="21e4" class="jc jd lk je b jf jg jh ji jj jk jl jm ll jo jp jq lm js jt ju ln jw jx jy jz hb bi translated"><bean id="”jobLauncher”" class="”org.springframework.batch.core.launch.support.SimpleJobLauncher”" scope="”singleton”"> <property name="”jobRepository”" ref="”jobRepository”"/> <property name="”taskExecutor”"> <bean class="”org.springframework.core.task.SimpleAsyncTaskExecutor”"/> </property></bean></p></blockquote><p id="4964" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">作业启动器是触发批处理作业的点。它用给定的一组参数启动批处理作业。上面的规范表示示例启动器代码。</p></div></div>    
</body>
</html>