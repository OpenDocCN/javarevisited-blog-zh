<html>
<head>
<title>The mystery of the negative byte value in Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Java中负字节值的奥秘</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/the-mystery-of-the-negative-byte-value-in-java-8c9923d9239d?source=collection_archive---------1-----------------------#2020-04-15">https://medium.com/javarevisited/the-mystery-of-the-negative-byte-value-in-java-8c9923d9239d?source=collection_archive---------1-----------------------#2020-04-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a9e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您将Java与底层数据结合使用时，例如网络数据包、串行通信、Raspberry Pi的GPIO十六进制值的数值可能会有些混乱。前一段时间在Pi4J论坛上有一个问题，是关于一个被当作字节处理的数值被记录为负数-86，而不是预期值170。所以这是我试图解释这个谜团的尝试…</p><h1 id="2383" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">基础知识</h1><p id="88fc" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">非常短:</p><ul class=""><li id="0c01" class="kh ki hi ih b ii ij im in iq kj iu kk iy kl jc km kn ko kp bi translated">计算机大脑中的所有逻辑都是一个位，可以是0或1(开或关)。</li><li id="5d90" class="kh ki hi ih b ii kq im kr iq ks iu kt iy ku jc km kn ko kp bi translated">当你组合8位时，你得到一个字节。</li></ul><h1 id="33de" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">将位转换为数字和十六进制值</h1><p id="90d5" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">使用2的幂将多个位的组合转换为一个数字。</p><p id="892e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在日常生活中，我们习惯于十进制数值，我们把所有东西按10，20，30分组。在编程中，十六进制值用得更多，它们的范围是0到15，完美匹配四位的最大值(“1111”)。一个十六进制值被写成x0到xF。</p><p id="3d75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下表显示了范围从“0000”到“1111”的4位的所有可能组合:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/c4e4ee78f9bc23da2b67276d7fc167f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*biBeSSWzcFzB6HxU.png"/></div></div></figure><h1 id="2f85" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">计算一个字节值</h1><p id="0a77" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">一个字节由8位组成，范围为0x00 (= 0)至0xFF (= 255)。因此，我们需要扩展上表，使其具有8位。让我们举几个例子:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/2f4218a8c067fe5424641458d5695f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_3nb6bDBt3AjhvxV.png"/></div></div></figure><h1 id="42f4" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">Java中的值</h1><p id="01d3" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">让我们用下面的代码检查一下Java中的值是如何表示的:</p><pre class="kw kx ky kz fd lh li lj lk aw ll bi"><span id="f905" class="lm jf hi li b fi ln lo l lp lq">class PrintLimits {<br/>    public static void main(String[] args) {<br/>        System.out.println("Byte");<br/>        System.out.println("    Min: " + Byte.MIN_VALUE);<br/>        System.out.println("    Max: " + Byte.MAX_VALUE);</span><span id="193c" class="lm jf hi li b fi lr lo l lp lq">        System.out.println("Short");<br/>        System.out.println("    Min: " + Short.MIN_VALUE);<br/>        System.out.println("    Max: " + Short.MAX_VALUE);</span><span id="385e" class="lm jf hi li b fi lr lo l lp lq">        System.out.println("Integer");<br/>        System.out.println("    Min: " + Integer.MIN_VALUE);<br/>        System.out.println("    Max: " + Integer.MAX_VALUE);</span><span id="f0a5" class="lm jf hi li b fi lr lo l lp lq">        System.out.println("Long");<br/>        System.out.println("    Min: " + Long.MIN_VALUE);<br/>        System.out.println("    Max: " + Long.MAX_VALUE);<br/>    }<br/>}</span></pre><p id="b423" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果我们得到了这些值:</p><pre class="kw kx ky kz fd lh li lj lk aw ll bi"><span id="b07b" class="lm jf hi li b fi ln lo l lp lq">Byte<br/>    Min: -128<br/>    Max: 127<br/>Short<br/>    Min: -32768<br/>    Max: 32767<br/>Integer<br/>    Min: -2147483648<br/>    Max: 2147483647<br/>Long<br/>    Min: -9223372036854775808<br/>    Max: 9223372036854775807</span></pre><p id="5e36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">嗯，这真是意想不到！一个字节的范围是-128到127，而不是0到255？！</strong>为了理解这一点，我们需要知道有符号值和无符号值的区别。</p><h1 id="29c4" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">有符号与无符号</h1><p id="ba58" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">当您将字节值计算为有符号数值时，主位(最左边的一位)被视为负数(1)或正数(0)的指示符，例如8位“1000 1111”:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es ls"><img src="../Images/54f52c85aee04d5efec8fef841b650ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/0*KhW6OOoT7k2DaUUY.png"/></div></div></figure><p id="ec5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“1000 1111”既是-15又是143，这取决于您是将其作为有符号的还是无符号的来处理。</p><p id="25fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由两个字节(= 16位)组成的短码也是如此，例如“1000 0000 0000 1111”:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lt"><img src="../Images/d9c8a83b44b0f792d7768d55eb314e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*9lUu0VVtphHMjn3B.png"/></div></div></figure><p id="7300" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“1000 0000 0000 1111”既是-15又是32.783，这取决于您是将其作为有符号还是无符号来处理。</p><h1 id="a475" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">结论</h1><p id="d8d7" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">您需要确定在读取数值时如何处理它们，以免混淆有符号值和无符号值！</p><p id="36dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是，我们有Byte.toUnsignedInt(b)函数，以确保我们在记录值时读出正确的值。下面是一个170英镑的快速演示，来自Pi4J论坛的原始问题:</p><pre class="kw kx ky kz fd lh li lj lk aw ll bi"><span id="9214" class="lm jf hi li b fi ln lo l lp lq">class HexIntegerToString {<br/>    public static void main(String[] args) {<br/>        convertByte((byte) 170);<br/>    }</span><span id="2047" class="lm jf hi li b fi lr lo l lp lq">    private static void convertByte(byte value) {        <br/>        System.out.println("Byte Unsigned: "<br/>           + Byte.toUnsignedInt(value) + "\tSigned: " + value);<br/>        System.out.println("    Hex value:  0x" <br/>           + Integer.toHexString(value &amp; 0xFF));<br/>        System.out.println("    Binair:     " <br/>           + Integer.toBinaryString(value &amp; 0xFF));<br/>    }<br/>}</span></pre><p id="3b06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它给出了以下输出:</p><pre class="kw kx ky kz fd lh li lj lk aw ll bi"><span id="1f80" class="lm jf hi li b fi ln lo l lp lq">Byte Unsigned: 170      Signed: -86<br/>    Hex value:  0xaa<br/>    Binair:     10101010</span></pre><p id="4633" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想尝试用JavaFX应用程序将位转换成数值，就像你在上面的截图中看到的那样，在GitHub 上查看<a class="ae jd" href="https://github.com/FDelporte/JavaOnRaspberryPi/tree/master/Chapter_08_BitsAndBytes/javafx-bits-calculator" rel="noopener ugc nofollow" target="_blank">这个项目的源代码。</a></p><p id="fac9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">你可能喜欢的其他文章:</strong></p><div class="lu lv ez fb lw lx"><a rel="noopener follow" target="_blank" href="/javarevisited/top-5-java-online-courses-for-beginners-best-of-lot-1e1e240a758"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">2020年学习Java的10大课程</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">如果你是计算机科学专业的毕业生，或者想学习Java并且正在寻找一些很棒的资源，比如…</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">medium.com</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml lf lx"/></div></div></a></div><div class="lu lv ez fb lw lx"><a rel="noopener follow" target="_blank" href="/free-code-camp/these-are-the-best-free-courses-to-learn-data-structures-and-algorithms-in-depth-4d52f0d6b35a"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">我最喜欢的免费课程&amp;深入学习数据结构和算法的认证</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">为程序员学习数据结构和算法的一些最好的免费在线课程的精选列表。</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">medium.com</p></div></div><div class="mg l"><div class="mm l mi mj mk mg ml lf lx"/></div></div></a></div><div class="lu lv ez fb lw lx"><a href="https://codeburst.io/100-coding-interview-questions-for-programmers-b1cf74885fb7" rel="noopener follow" target="_blank"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">程序员的100+编码面试问题</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">解决这些常见的编码问题，以便在下一次编程工作面试中表现出色。</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">codeburst.io</p></div></div><div class="mg l"><div class="mn l mi mj mk mg ml lf lx"/></div></div></a></div></div></div>    
</body>
</html>