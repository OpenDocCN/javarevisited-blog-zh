<html>
<head>
<title>With Salmos Report in Spring boot generate reports in few lines of code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Spring boot中的Salmos报告，只需几行代码就可以生成报告</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/with-salmos-report-in-spring-boot-generate-reports-in-few-lines-of-code-b5212486b921?source=collection_archive---------1-----------------------#2021-11-05">https://medium.com/javarevisited/with-salmos-report-in-spring-boot-generate-reports-in-few-lines-of-code-b5212486b921?source=collection_archive---------1-----------------------#2021-11-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/8d0d7080d94b199be3a9040fc232c207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Da-TgnOprCiYGoW7UjYPHA.jpeg"/></div></div></figure><div class=""/><p id="e72d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从存储在数据库中的数据生成报告一直是应用程序开发的重要部分之一。以及报告的标题、列标题、内容方向、样式、字体等。大多数情况下，报告中存在数字信息，应该在报告的页眉或页脚部分进行汇总。此外，有时我们需要导出不同结构或格式的数据，如XML、JSON、PDF或其他自定义结构。</p><p id="f63a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">尽管像Jasper这样的现有库已经非常全面和成熟，但是当您需要制作简单的小报告时，使用它基于xml的配置和环境设置可能会令人沮丧和困惑。在我的上一个项目中，我寻找一个包含电池的Spring替代库，它易于设置和使用，不幸的是我没有找到(也许我没有很好地搜索)。我决定启动一个开源项目，在Spring boot中开发一个易于配置和易于使用的库，用几行代码就可以快速生成报告。</p><p id="c131" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在付出了一些努力后，我实现了我心中的想法。现在，它不仅可以使用SQL查询和JDBC数据源直接从数据库中读取数据，还可以通过对象列表(例如Hibernate检索的实体对象列表)来提供数据。到目前为止，它可以产生Html，xml，pdf和自定义格式的报告。</p><p id="d1f7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该插件的当前版本是2.1.0，可以通过maven或grade导入，如:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="085c" class="jx jy ht jt b fi jz ka l kb kc">&lt;dependency&gt;<br/>  &lt;groupId&gt;io.github.birddevelper&lt;/groupId&gt;<br/>  &lt;artifactId&gt;salmos-report-spring-boot-starter&lt;/artifactId&gt;<br/>  &lt;version&gt;2.1.0&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><pre class="js jt ju jv aw jw bi"><span id="5466" class="jx jy ht jt b fi kk kl km kn ko ka l kb kc">implementation 'io.github.birddevelper:salmos-report-spring-boot-starter:2.1.0'</span></pre><p id="df3b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个插件中有3个主要的类来为你创造令人惊奇的东西。</p><ul class=""><li id="2256" class="kp kq ht is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated">HtmlReportMaker :从给定的sql查询或对象列表中检索的记录生成HTML表格的类。您可以指定报告的标题，表格可以用css类进行样式化，并且您可以选择在表格的最后一行汇总哪一列。您可以指定是否希望表包含索引列。此外，您可以定义一个模板并将其用于您的报告:</li></ul><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b5b4" class="jx jy ht jt b fi jz ka l kb kc">import io.github.birddevelper.salmos.HtmlReportMaker;<br/>import io.github.birddevelper.salmos.setting.HtmlReportTemplate;<br/>import io.github.birddevelper.salmos.setting.SummaryType;<br/><br/><br/>@Service<br/>public class ReportService {<br/><br/>    @Autowired<br/>    DataSource dataSource;<br/><br/>    public String generateReport() {<br/><br/>        // Creating instance of HtmlReportMaker<br/>        HtmlReportMaker hrm = new HtmlReportMaker(dataSource);<br/>        // specify columns of data that must be summarized in table footer row<br/>        hrm.addSummaryColumn("Age", SummaryType.AVERAGE);<br/>        hrm.addSummaryColumn("Salary", SummaryType.SUM);<br/>        <br/>        // template specifies the report table appearance<br/>        HtmlReportTemplate myTemplate = new HtmlReportTemplate();<br/>        myTemplate.setTableCssClass("tblReport");<br/>        myTemplate.setEvenRowCssClass("myEvensRow");<br/>        myTemplate.setOddRowCssClass("myOddsRow");<br/>        myTemplate.setHeaderRowCssClass("myheader");<br/>        myTemplate.setRightToLeft(true);<br/>        myTemplate.setRowIndexHeader("#");<br/>        myTemplate.setRowIndexVisible(true);<br/>        <br/>        hrm.setTemplate(myTemplate);<br/>        <br/>        //  summary section numbers decimal point setting<br/>        hrm.setSummaryDecimalPrecision(1);<br/>        <br/>        //  summary section numbers seperated by comma <br/>        hrm.setSummaryCommaSeperatedNumbers(true);<br/>        <br/>        // show  row's index<br/>        hrm.isRowIndexVisible(true);<br/>        <br/>        // set the query retrieving data from database<br/>        hrm.setSqlQuery("select fullname as 'Name', age as 'Age', salary as 'Salary'   from chamber limit 0,10");<br/>        <br/>        return hrm.generate();<br/><br/>      <br/><br/>    }<br/>}</span></pre><ul class=""><li id="7c46" class="kp kq ht is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated"><strong class="is hu"> XmlReportMaker </strong>:从给定的sql查询或对象列表中检索到的记录生成XML文档的类。使用这个类，您可以生成两种类型的xml。在<strong class="is hu">RecordColumnAsElementAttribute</strong>模式中，它将行的每个字段嵌入其元素标签中，如下所示作为其属性:</li></ul><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e0fa" class="jx jy ht jt b fi jz ka l kb kc">&lt;students&gt;</span><span id="57e0" class="jx jy ht jt b fi ky ka l kb kc">&lt;student id=”1" firstname=”Alex” lastname=”Tailor” <br/>birthdate=”1980/09/19" /&gt;</span><span id="d06c" class="jx jy ht jt b fi ky ka l kb kc">&lt;student id=”2" firstname=”Alice” lastname=”James” birthdate=”1988/06/22" /&gt;<br/>.<br/>.<br/>.</span><span id="095e" class="jx jy ht jt b fi ky ka l kb kc">&lt;/students&gt;</span></pre><p id="f142" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在<strong class="is hu">RecordColumnAsElementChild</strong>中，它添加行的每个字段作为其子标签，如下所示:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e2b0" class="jx jy ht jt b fi jz ka l kb kc">&lt;students&gt;</span><span id="1614" class="jx jy ht jt b fi ky ka l kb kc">&lt;student &gt;<br/>    &lt;id&gt;1&lt;/id&gt;<br/>    &lt;firstName&gt;Alex&lt;/firstName&gt;<br/>    &lt;lastName&gt;Tailor&lt;/lastName&gt;<br/>    &lt;birthdate&gt;1980/09/19&lt;/birthdate&gt;<br/>&lt;/student&gt;</span><span id="9c97" class="jx jy ht jt b fi ky ka l kb kc">&lt;student &gt;<br/>    &lt;id&gt;1&lt;/id&gt;<br/>    &lt;firstName&gt;Alice&lt;/firstName&gt;<br/>    &lt;lastName&gt;James&lt;/lastName&gt;<br/>    &lt;birthdate&gt;1988/06/22&lt;/birthdate&gt;<br/>&lt;/student&gt;<br/>.<br/>.<br/>.</span><span id="40be" class="jx jy ht jt b fi ky ka l kb kc">&lt;/students&gt;</span></pre><p id="0de2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">xml生成器的示例代码:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e147" class="jx jy ht jt b fi jz ka l kb kc">import io.github.birddevelper.salmos.XmlReportMaker;<br/>import io.github.birddevelper.salmos.setting.SummaryType;<br/>import io.github.birddevelper.salmos.setting.XmlReportElementType;<br/>@Service<br/>public class ReportService {<br/><br/>    @Autowired<br/>    DataSource dataSource;<br/><br/>    public String generateXMLReport() {<br/>        // Creating instance of XmlReportMaker<br/>        XmlReportMaker xrm = new XmlReportMaker(dataSource);<br/><br/>        // specify columns of data that must be summarized (they will put in root element as attribute) <br/>        xrm.addSummaryColumn("Age", SummaryType.AVERAGE);<br/>        xrm.addSummaryColumn("Salary", SummaryType.SUM);<br/><br/>        // summary section numbers decimal point setting<br/>        xrm.setSummaryDecimalPrecision(0);<br/>        <br/>        xrm.setRootElementName("Persons");<br/>        xrm.setChildElementName("person");<br/>        <br/>        // this line set the generator to put row data in attributes of row element<br/>        xrm.setXmlReportElementType(XmlReportElementType.RecordColumnAsElementAttribute);<br/>        <br/>        // set the query retrieving data from database<br/>        xrm.setSqlQuery("select fullname as 'Name', age as 'Age', salary as 'Salary'   from chamber limit 0,10");<br/>        <br/>        return xrm.generate();<br/>    }<br/>}</span></pre><ul class=""><li id="5956" class="kp kq ht is b it iu ix iy jb kr jf ks jj kt jn ku kv kw kx bi translated">GeneralReportMaker :这个类以任何给定的结构和格式生成输出。这个类中的报表有三个部分:页眉、正文和页脚。您可以为body设置一个模板，它会在查询结果的每一行中重复。在页眉和页脚部分，您可以使用::[您的列名]Summary对指定的列进行汇总。此外，页眉、正文和页脚可以从资源文件、InputStream或pour String加载:</li></ul><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="6cfe" class="jx jy ht jt b fi jz ka l kb kc">import org.log.carvan.utils.GeneralReportMaker;<br/>import io.github.birddevelper.salmos.setting.SummaryType;<br/><br/>@Service<br/>public class ReportService {<br/><br/>    @Autowired<br/>    DataSource dataSource;<br/><br/>    public String generateUniversalReport() {<br/><br/>        GeneralReportMaker grm = new GeneralReportMaker(dataSource);<br/>        // load template from file located in resources <br/>        grm.loadTemplateBodyFromFile("templates/salmosTemplates/template1.html");<br/><br/>        // set the query retrieving data from database<br/>        grm.setSqlQuery("select fullname as 'Name', age as 'Age', salary as 'Salary'   from chamber limit 0,10");<br/><br/>        // specify columns of data that must be summarized <br/>        grm.addSummaryColumn("Age", SummaryType.AVERAGE);<br/>        grm.addSummaryColumn("Salary", SummaryType.SUM);<br/><br/>        // set footer template with String (to have a column summary in footer, you should use ::[column name]Summary in template <br/>        grm.setTemplateFooter("&lt;p &gt;&lt;b&gt; Age Average &gt;&gt; ::AgeSummary ---- Total Salary &gt;&gt; ::SalarySummary &lt;/b&gt; &lt;/p&gt;");<br/><br/>        <br/>        return grm.generate();<br/><br/><br/>    }<br/>}</span></pre><h2 id="1afa" class="jx jy ht bd kz la lb lc ld le lf lg lh jb li lj lk jf ll lm ln jj lo lp lq lr bi translated">从对象列表生成(例如:休眠输出)</h2><p id="e9db" class="pw-post-body-paragraph iq ir ht is b it ls iv iw ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn hb bi translated">从版本2.0.0+开始，您可以根据对象列表生成报告，例如hibernate获取的实体列表。在这种情况下，<strong class="is hu"> HtmlReportMaker </strong>类必须用<strong class="is hu"> ObjectFactory初始化。</strong>在我们启动<strong class="is hu"> HtmlReportMaker </strong>之前，我们应该创建<strong class="is hu"> ObjectFactory </strong>和<strong class="is hu"> </strong>指定我们希望在报表中显示的实体的字段及其HashMap格式的标题，在下面的例子中，<strong class="is hu"> fieldMap.put("age "，" Age") </strong>，指定要在报表中显示的学生实体的<strong class="is hu"> "age" </strong>字段，标题为<strong class="is hu"> "Age" </strong>。然后我们在<strong class="is hu"> Objectfactory中加载对象列表。</strong>最后<strong class="is hu"> </strong>我们用<strong class="is hu"> Objectfactory初始化<strong class="is hu"> HtmlReportMaker </strong>。</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="985a" class="jx jy ht jt b fi jz ka l kb kc">import io.github.birddevelper.salmos.XmlReportMaker;<br/>import io.github.birddevelper.salmos.setting.SummaryType;<br/>import io.github.birddevelper.salmos.setting.XmlReportElementType;<br/>import lombok.Getter;<br/>import lombok.Setter;<br/>@Service<br/>public class ReportService {</span><span id="77c5" class="jx jy ht jt b fi ky ka l kb kc">    @Getter<br/>    @Setter<br/>    public class Student {<br/>        private String name;<br/>        private int age;<br/>        private Date birthDate;<br/>        private List&lt;String&gt; skills;<br/>        <br/>    }<br/>    <br/>    @AutoWired<br/>    StudentRepository studentRepository;</span><span id="be55" class="jx jy ht jt b fi ky ka l kb kc">    public String generateHTMLReport() {</span><span id="ddc5" class="jx jy ht jt b fi ky ka l kb kc">        <br/>        List&lt;Student&gt; studentList = studentRepository.findAll();</span><span id="85bb" class="jx jy ht jt b fi ky ka l kb kc">        <br/>        // Mapping the class fields to report columns (here we want only name and age, the reset of entity fields will be ignored)<br/>        Map&lt;String,String&gt; fieldMap = new HashMap&lt;&gt;();<br/>        fieldMap.put("name", "Full Name");<br/>        fieldMap.put("age", "Age");<br/>        <br/>        // buidling instance of ObjectFactory class<br/>        ObjectFactory objectFactory = new ObjectFactory();<br/>        <br/>        // setting mapping fields<br/>        objectFactory.setReportFields(fieldMap);<br/>        // setting entity lists<br/>        objectFactory.loadObjects(studentList);<br/>        <br/>        // building instance of HtmlReportMaker with ObjectFactory as input parameter<br/>        HtmlReportMaker htmlReportMaker = new HtmlReportMaker(objectFactory);<br/>        <br/>        // generate report<br/>        return htmlReportMaker.generate();<br/>    }<br/>}</span></pre><p id="7f22" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望我能添加更多像excel导出这样的功能，使它更有用。不要犹豫，给一个评论。</p><p id="b00c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">github上的项目资源库:<a class="ae lx" href="https://github.com/birddevelper/salmos-report-spring-boot-starter" rel="noopener ugc nofollow" target="_blank">https://github . com/bird developer/salmos-report-spring-boot-starter</a>。</p></div></div>    
</body>
</html>