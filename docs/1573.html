<html>
<head>
<title>Making Regex your friend in Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让正则表达式成为你的Java朋友</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/making-regex-your-friend-in-java-ddc5bf7f9a66?source=collection_archive---------1-----------------------#2021-09-19">https://medium.com/javarevisited/making-regex-your-friend-in-java-ddc5bf7f9a66?source=collection_archive---------1-----------------------#2021-09-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="946e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你见过这个迷因并有点同意它吗？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/ec967d1262ed9f31c8c566db87553294.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*FPnGZxVx3-_xLGV4uRHK5A.jpeg"/></div><p class="jl jm et er es jn jo bd b be z dx translated">正则表达式迷因</p></figure><p id="df06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，那你就像我一样。我想改变这一点。本文旨在解决这个问题，并使它成为开发人员宝库中的另一个可用工具。我相信它肯定会被过度使用，但是，也有需要它的情况。</p><p id="3214" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们深入研究一下。</p><h1 id="0cf8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">正则表达式构造</h1><p id="0f12" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">首先，我们来谈谈一些有助于构造你的<a class="ae ks" rel="noopener" href="/javarevisited/7-best-regular-expression-courses-for-developers-to-learn-in-2021-9b8cb37bb3a5">正则表达式</a>的构造。请注意，这些都与Java相关，我相信它们会因语言而异。</p><h2 id="ebb9" class="kt jq hi bd jr ku kv kw jv kx ky kz jz iq la lb kd iu lc ld kh iy le lf kl lg bi translated">括号“[]”与括号“()”</h2><p id="e5f0" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">括号称为<strong class="ih hj">字符类</strong>，圆括号称为<strong class="ih hj">捕获组</strong>【1】。</p><p id="1368" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">字符类是一种表示您想要匹配哪些字符的方式。比如说。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="b10e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的输出如下。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="9abd" class="kt jq hi lk b fi lo lp l lq lr">true<br/>true<br/>false<br/>false</span></pre><p id="fc6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">捕获组是完全不同的东西。这是一种方式，让你说你希望你的<a class="ae ks" href="https://javarevisited.blogspot.com/2016/10/how-to-check-if-string-is-numeric-in-Java.html" rel="noopener ugc nofollow" target="_blank">正则表达式</a>保存它找到的东西，以便你以后可以检索它。换句话说，你告诉正则表达式“匹配我的正则表达式，但是为我保存这些子结果”。让我们看一个例子。</p><p id="040d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们尝试匹配一个格式为:DIGIT+DIGIT=DIGIT的字符串。我们想提取数字。</p><p id="3bba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一种模式只使用字符类，“+”(被转义，因为它在regex中有另一种含义)和“=”。第二种模式使用未命名的捕获组。最后一种模式使用命名捕获组。</p><p id="9652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意命名捕获组的语法:(？<name>图案)</name></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="8b6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是它的输出。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="a4e5" class="kt jq hi lk b fi lo lp l lq lr">Number of groups: 0<br/>true<br/>Number of groups: 3<br/>true<br/>3+1=4<br/>3<br/>1<br/>4<br/>Number of groups: 3<br/>true<br/>3+1=4<br/>3<br/>1<br/>4<br/>3<br/>1<br/>4</span></pre><p id="2593" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是讨论<strong class="ih hj">匹配</strong>和<strong class="ih hj">查找</strong>之间差异的好时机。</p><h2 id="a1f7" class="kt jq hi bd jr ku kv kw jv kx ky kz jz iq la lb kd iu lc ld kh iy le lf kl lg bi translated">匹配与查找</h2><p id="0c7a" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">基本上有两种方法可以使用你的正则表达式。一种是<strong class="ih hj">对整串匹配</strong>。另一个用途是<strong class="ih hj">查找</strong>子字符串。</p><p id="05bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们使用前面的例子，尝试从字符串中获取数字。但是在这种情况下，我们只想得到数字，我们并不关心字符串的一般格式。在这种情况下，我们可以再次使用<strong class="ih hj">命名的捕获组</strong>，但是使用<strong class="ih hj">查找</strong>方法来代替。像这样。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="495a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它的输出如下。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="365b" class="kt jq hi lk b fi lo lp l lq lr">Number of groups: 1<br/>3<br/>3<br/>3<br/>1<br/>1<br/>1<br/>4<br/>4<br/>4</span></pre><p id="3da2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以注意到，第一个组号0总是来自原始模式的整个匹配。而且组数基本上是1 +定义的组。</p><p id="4c0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个例子只是在一个字符串中查找数字，基本上没有其他考虑。因此，一个简单的规则是，如果要查找特定的子字符串，使用<strong class="ih hj"> find </strong>，如果要确保字符串的特定格式，使用<strong class="ih hj"> matches </strong>。</p><h2 id="fde4" class="kt jq hi bd jr ku kv kw jv kx ky kz jz iq la lb kd iu lc ld kh iy le lf kl lg bi translated">量词</h2><p id="2010" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">到目前为止，我只展示了匹配单次出现的例子。但是有时能够指定重复发生是有帮助的。量词其实有三种，<strong class="ih hj">贪</strong>、<strong class="ih hj">舍不得</strong>和<strong class="ih hj">所有格</strong>。</p><p id="24bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将只涉及贪婪的T10，但是如果需要的话，可以随意查看其他两个。假设您对寻找数字序列感兴趣。比方说，我们想把前面的“数字+数字=数字”的例子推广到“100+50=150”这样的数字。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="7d18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还使用了一个预定义的字符类“\d”，它仅仅表示一个数字，你可以在这里找到更多预定义的类<a class="ae ks" href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/regex/Pattern.html" rel="noopener ugc nofollow" target="_blank"/>【1】。</p><p id="6efa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“\\d{1，}”的意思是至少应该有一位数字。你可以给它另一个参数，这样你允许最大值为3，例如:" \\d{1，3}。</p><h2 id="2899" class="kt jq hi bd jr ku kv kw jv kx ky kz jz iq la lb kd iu lc ld kh iy le lf kl lg bi translated">“或”运算符</h2><p id="f891" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">如果需要条件匹配，这个操作符会很有帮助。假设我们有类似“评分5”、“分数2”、“分数3”和“分数9”的字符串。在提取数字时，我们需要确保格式正确。为此，我们可以使用<strong class="ih hj">或</strong>操作符。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="8002" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的输出和预期的一样。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="72e3" class="kt jq hi lk b fi lo lp l lq lr">true<br/>Rating 5<br/>5<br/>true<br/>Score 2<br/>2<br/>true<br/>Scores 3<br/>3<br/>true<br/>Point 9<br/>9<br/>false</span></pre><p id="df69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我添加了“s{0，1}”，以表明您可以将OR中的表达式变得任意复杂。</p><h2 id="7226" class="kt jq hi bd jr ku kv kw jv kx ky kz jz iq la lb kd iu lc ld kh iy le lf kl lg bi translated">反向引用</h2><p id="bba4" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">假设你得到如下的字符串。</p><ul class=""><li id="212f" class="ls lt hi ih b ii ij im in iq lu iu lv iy lw jc lx ly lz ma bi translated">苹果:3个苹果</li><li id="4093" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">橘子:4个橘子</li><li id="4737" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">香蕉:1根香蕉</li></ul><p id="3e6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本质上，您希望匹配类似于“单词:数字单词”的内容</p><p id="c873" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，你需要能够引用模式内部的匹配，这是使用<strong class="ih hj">反向引用</strong>来完成的，就像这样<strong class="ih hj">。</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="a1ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以看到，我在模式的末尾使用语法“\\k <name>”引用了命名的捕获组“fruit”。</name></p></div><div class="ab cl mg mh gp mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hb hc hd he hf"><p id="ddf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是本文的最后一项。我希望这些工具能让你在Java 中使用<a class="ae ks" href="https://javarevisited.blogspot.com/2020/04/top-5-courses-to-learn-regular-expression-regex.html" rel="noopener ugc nofollow" target="_blank">正则表达式时更有信心。我想以一篇关于性能的笔记和在野外使用regex的技巧来结束这篇文章。</a></p></div><div class="ab cl mg mh gp mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hb hc hd he hf"><h1 id="081d" class="jp jq hi bd jr js mn ju jv jw mo jy jz ka mp kc kd ke mq kg kh ki mr kk kl km bi translated">编译模式</h1><p id="bae3" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在<a class="ae ks" href="https://javarevisited.blogspot.com/2016/02/2-ways-to-split-string-with-dot-in-java-using-regular-expression.html" rel="noopener ugc nofollow" target="_blank">模式</a>上使用matches函数(参见第一个例子)实际上编译了一个正则表达式并在后台匹配它。其他示例在模式上显式使用了compile方法。这个函数非常昂贵，我可以在下面演示。</p><p id="2bce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以你想在方法调用中重用它，也许把它设置成一个<a class="ae ks" href="http://javarevisited.blogspot.sg/2017/01/how-public-static-final-variable-works.html#axzz51iekrZ00" rel="noopener ugc nofollow" target="_blank">静态最终字段</a>。</p><p id="0766" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将重用最后一个例子的成果，并对方法进行一些<a class="ae ks" rel="noopener" href="/javarevisited/7-best-courses-to-learn-refactoring-and-clean-coding-in-java-47bea3c67006">重构</a>。请参见下面的示例。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="260b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是结果，所以在我的机器上差别很大。您可能会得到类似的结果。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="d157" class="kt jq hi lk b fi lo lp l lq lr">+------------------------------------+-----------------------------+<br/>|           compileAlways            |            787 ms           |<br/>+------------------------------------+-----------------------------+<br/>|            compileOnce             |            105 ms           |<br/>+------------------------------------+-----------------------------+</span></pre><p id="2b75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在用Java做微基准测试时，你需要小心，因为编译器是如何工作的，以及它执行的所有优化。因此，通常建议做一次热身，就像你看到的我在第一个循环中做的那样。</p><p id="99e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在以前的文章中谈到过这一点，比如当我比较<a class="ae ks" href="https://www.java67.com/2012/12/difference-between-arraylist-vs-LinkedList-java.html" rel="noopener ugc nofollow" target="_blank"> LinkedList和ArrayList </a>时，以及我在Java中进行微基准测试时的主要技巧，请参见下面的链接。</p><div class="ms mt ez fb mu mv"><a rel="noopener follow" target="_blank" href="/javarevisited/consider-linkedlist-in-java-2fed1b945b48"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hj fi z dy na ea eb nb ed ef hh bi translated">关于在Java中使用LinkedList的几点思考</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">这将是一篇不同的文章，因为在我的机器上测试了一些之后，我的假设变得有点…</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">medium.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj jj mv"/></div></div></a></div><div class="ms mt ez fb mu mv"><a href="https://ludvigwesterdahl.medium.com/some-tips-for-microbenchmarking-in-java-46d6c9b669d9" rel="noopener follow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hj fi z dy na ea eb nb ed ef hh bi translated">Java微基准测试的一些技巧</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">微基准测试是对产品的一小部分进行性能测试的一种方式。也许你不想比较…</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">ludvigwesterdahl.medium.com</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj jj mv"/></div></div></a></div></div><div class="ab cl mg mh gp mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hb hc hd he hf"><h2 id="6246" class="kt jq hi bd jr ku kv kw jv kx ky kz jz iq la lb kd iu lc ld kh iy le lf kl lg bi translated">参考</h2><p id="ff2a" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">[1]模式(Java SE 13 &amp; JDK 13)<br/><a class="ae ks" href="https://docs.oracle.com/en/java/javase/13/docs/api/java.base/java/util/regex/Pattern.html" rel="noopener ugc nofollow" target="_blank">https://docs . Oracle . com/en/Java/javase/13/docs/API/Java . base/Java/util/regex/Pattern . html</a></p></div></div>    
</body>
</html>