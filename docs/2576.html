<html>
<head>
<title>Micronaut Framework — The basics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Micronaut框架—基础知识</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/micronaut-framework-the-basics-d7c7fff2464?source=collection_archive---------0-----------------------#2022-12-09">https://medium.com/javarevisited/micronaut-framework-the-basics-d7c7fff2464?source=collection_archive---------0-----------------------#2022-12-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cc8a" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">一个基于JVM的现代全栈框架，用于构建模块化、易于测试的微服务。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/cf25497ee95d872829c52d17d4a416da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FmxXu0oZTdMxwME01H6SUw.png"/></div></div><p class="jj jk et er es jl jm bd b be z dx translated">来源:https://micronaut.io/</p></figure><h1 id="6c06" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">什么是Micronaut</h1><p id="317d" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">Micronaut是一个基于JVM的现代框架，用于构建高效、轻量级的微服务应用程序。它提供了一种独特的方法，通过使用提前(AOT)编译来构建微服务，与传统的基于JVM的框架相比，这种方法允许更快的启动时间和更低的内存消耗。</p><p id="ee4e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">Micronaut的AOT编译是通过使用GraalVM实现的，这是一个高性能、多语言的虚拟机，支持多种语言，包括<a class="ae jn" rel="noopener" href="/javarevisited/10-free-courses-to-learn-java-in-2019-22d1f33a3915"> Java </a>、<a class="ae jn" rel="noopener" href="/javarevisited/10-best-online-courses-to-learn-javascript-in-2020-af5ed0801645"> JavaScript </a>和<a class="ae jn" rel="noopener" href="/javarevisited/10-best-ruby-on-rails-courses-for-beginners-dca4d66e9f7b"> Ruby </a>。GraalVM允许Micronaut提前编译应用程序，从而加快启动速度，降低内存消耗。</p><p id="9ee2" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">Micronaut 的一个关键特性是它对反应式编程的支持。反应式编程是一种专注于异步数据流和数据变化传播的编程范式。这可以极大地提高微服务应用程序的性能和可伸缩性，因为它允许它们处理大量并发请求，而不会遇到内存或CPU限制。</p><p id="8b56" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><a class="ae jn" rel="noopener" href="/javarevisited/10-best-free-dropwizard-vert-x-micronaut-and-quarkus-online-courses-for-java-developers-9c2b4161f17"> Micronaut </a>还为云原生环境提供一流的支持，使其成为构建旨在Kubernetes等平台上运行的微服务的绝佳选择。它提供了与流行的云原生工具和服务的集成，例如用于服务发现的网飞Eureka和Consul，以及用于部署和编排的Kubernetes和Docker。</p><p id="7fde" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">Micronaut 的一个突出特性是它能够在云本地环境和传统的基于JVM的环境中运行。这使得开发人员可以轻松构建可以在内部、云中甚至混合环境中运行的微服务。</p><p id="c10d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">总的来说，Micronaut是构建微服务应用程序的强大而高效的框架。它对反应式编程、云原生环境和AOT编译的支持使其成为构建可伸缩、高性能微服务的绝佳选择。</p><h1 id="4421" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">你好世界</h1><p id="f687" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">这个示例创建了一个简单的“hello world”微服务，它侦听指定的端口，并用“hello world”消息响应HTTP请求。</p><p id="885d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">首先，我们需要将Micronaut依赖项添加到我们的<code class="du lh li lj lk b">build.gradle</code>文件中:</p><pre class="iy iz ja jb fd ll lk lm bn ln lo bi"><span id="dee7" class="lp jp hi lk b be lq lr l ls lt">dependencies {<br/>  compile "io.micronaut:micronaut-http-server-netty"<br/>}</span></pre><p id="c20e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">接下来，我们可以通过在我们的主类上使用<code class="du lh li lj lk b">@MicronautApplication</code>注释来创建一个Micronaut应用程序:</p><pre class="iy iz ja jb fd ll lk lm bn ln lo bi"><span id="bb6f" class="lp jp hi lk b be lq lr l lu lt">import io.micronaut.runtime.Micronaut;<br/><br/>@MicronautApplication<br/>public class HelloWorldApplication {<br/><br/>    public static void main(String[] args) {<br/>        Micronaut.run(HelloWorldApplication.class);<br/>    }<br/>}</span></pre><p id="fd15" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">接下来，我们可以创建一个简单的控制器，它侦听HTTP请求并返回“hello world”消息:</p><pre class="iy iz ja jb fd ll lk lm bn ln lo bi"><span id="7958" class="lp jp hi lk b be lq lr l lu lt">import io.micronaut.http.MediaType;<br/>import io.micronaut.http.annotation.Controller;<br/>import io.micronaut.http.annotation.Get;<br/><br/>@Controller("/hello")<br/>public class HelloWorldController {<br/><br/>    @Get(produces = MediaType.TEXT_PLAIN)<br/>    public String index() {<br/>        return "Hello World!";<br/>    }<br/>}</span></pre><p id="482e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">最后，我们可以通过将<code class="du lh li lj lk b">micronaut.server.port</code>属性添加到我们的<code class="du lh li lj lk b">application.yml</code>文件来指定微服务应该监听的端口:</p><pre class="iy iz ja jb fd ll lk lm bn ln lo bi"><span id="356a" class="lp jp hi lk b be lq lr l lu lt">micronaut:<br/>  server:<br/>    port: 8080</span></pre><p id="36c0" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">有了这个配置，我们的微服务将启动并在端口8080上监听HTTP请求。当收到一个请求时，<code class="du lh li lj lk b">HelloWorldController</code>将处理它并返回一个“hello world”消息。</p><h1 id="efd2" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">测试</h1><p id="2ee7" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">Micronaut的一个主要优点是它能够在一个“瘦”JVM中运行测试，这意味着测试可以快速有效地执行。这是通过使用反射和其他性能增强技术来实现的。此外，Micronaut还提供了一系列测试实用程序，使得为您的应用程序编写测试变得非常容易。</p><p id="318c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">例如，Micronaut提供了对<a class="ae jn" href="https://javarevisited.blogspot.com/2021/04/junit-interview-questions-with-answers.html" rel="noopener ugc nofollow" target="_blank">单元测试</a>的支持，这允许您单独测试应用程序的各个组件。这是通过使用<code class="du lh li lj lk b">@MicronautTest</code>注释来实现的，该注释可以应用于一个测试类来启用Micronaut测试基础设施。</p><p id="84a3" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">Micronaut还提供了对集成测试的支持，这允许您测试应用程序中多个组件的集成。这是通过使用<code class="du lh li lj lk b">@MicronautTest</code>注释和<code class="du lh li lj lk b">@MicronautDataTest</code>注释来实现的，后者可用于从各种来源加载测试数据，包括内存数据库和外部文件。</p><p id="cb0a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">除了这些测试功能，Micronaut还支持编写与外部系统交互的测试，例如<a class="ae jn" href="https://javarevisited.blogspot.com/2018/05/top-5-sql-and-database-courses-to-learn-online.html" rel="noopener ugc nofollow" target="_blank">数据库</a>和<a class="ae jn" href="https://javarevisited.blogspot.com/2015/06/how-to-create-http-server-in-java-serversocket-example.html" rel="noopener ugc nofollow" target="_blank"> HTTP服务器</a>。这是通过使用<code class="du lh li lj lk b">@MockBean</code>注释实现的，它允许您轻松地创建外部依赖的模拟实现，允许您在受控环境中测试您的应用程序。</p><h2 id="dfd9" class="lv jp hi bd jq lw lx ly ju lz ma mb jy kp mc md ka kt me mf kc kx mg mh ke mi bi translated">单元测试</h2><p id="15e6" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">单元测试是孤立地测试应用程序的单个组件或模块的测试。在Micronaut中，您可以通过用<code class="du lh li lj lk b">@MicronautTest</code>注释来注释您的测试类来编写单元测试，这将启用Micronaut测试基础设施。</p><p id="ac77" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">然后，您可以使用<code class="du lh li lj lk b"><a class="ae jn" href="https://javarevisited.blogspot.com/2017/04/difference-between-autowired-and-inject-annotation-in-spring-framework.html" rel="noopener ugc nofollow" target="_blank">@Inject</a></code>注释来注入您想要测试的组件，并使用标准的JUnit或TestNG断言来验证组件的行为。这里有一个简单的例子:</p><pre class="iy iz ja jb fd ll lk lm bn ln lo bi"><span id="cf20" class="lp jp hi lk b be lq lr l lu lt">@MicronautTest<br/>public class MyServiceTest {<br/><br/>    @Inject<br/>    MyService myService;<br/><br/>    @Test<br/>    public void testSomeMethod() {<br/>        // Use the @Inject MyService instance to test the myService.someMethod() method<br/>        assertEquals("expected result", myService.someMethod());<br/>    }<br/>}</span></pre><p id="4e27" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这个测试将使用Micronaut测试基础设施来创建一个<code class="du lh li lj lk b">MyService</code>类的实例，然后调用<code class="du lh li lj lk b">myService.someMethod()</code>方法来测试它的行为。<code class="du lh li lj lk b">assertEquals()</code>方法用于验证该方法是否返回预期的结果。</p><h2 id="6e7a" class="lv jp hi bd jq lw lx ly ju lz ma mb jy kp mc md ka kt me mf kc kx mg mh ke mi bi translated">集成测试</h2><p id="8dd1" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated"><a class="ae jn" href="https://www.java67.com/2022/08/springboottest-integration-test-example.html" rel="noopener ugc nofollow" target="_blank">集成测试</a>是测试应用程序中多个组件或模块的集成的测试。在Micronaut中，您可以通过使用<code class="du lh li lj lk b">@MicronautTest</code>和<code class="du lh li lj lk b">@MicronautDataTest</code>注释来注释您的测试类来编写集成测试，这将启用Micronaut测试基础设施，并允许您从外部来源加载测试数据。然后，您可以使用<code class="du lh li lj lk b">@Inject</code>注释来注入您想要测试的组件，并使用标准的JUnit或TestNG断言来验证集成组件的行为。这里有一个简单的例子:</p><pre class="iy iz ja jb fd ll lk lm bn ln lo bi"><span id="cdb1" class="lp jp hi lk b be lq lr l lu lt">@MicronautTest<br/>@MicronautDataTest<br/>public class MyServiceTest {<br/><br/>    @Inject<br/>    MyService myService;<br/><br/>    @Inject<br/>    DataSource dataSource;<br/><br/>    @Test<br/>    public void testSomeMethod() {<br/>        // Use the @MicronautDataTest annotation to load test data from a file<br/>        loadTestData("test-data.sql");<br/><br/>        // Use the @Inject MyService instance and @Inject DataSource instance to test the integration of these components<br/>        assertEquals("expected result", myService.someMethod(dataSource));<br/>    }<br/>}</span></pre><p id="14a7" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这个测试将使用Micronaut测试基础设施来创建<code class="du lh li lj lk b">MyService</code>和<code class="du lh li lj lk b">DataSource</code>类的实例，使用<code class="du lh li lj lk b">loadTestData()</code>方法从指定的文件中加载测试数据，然后调用<code class="du lh li lj lk b">myService.someMethod()</code>方法来测试这些组件的集成。<code class="du lh li lj lk b">assertEquals()</code>方法用于验证该方法是否返回预期的结果。</p><h1 id="4eee" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">摘要</h1><p id="6fc9" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">我希望这个例子能够帮助您了解如何使用Micronaut创建一个简单的微服务。当然，Micronaut的内容远不止这里所展示的，所以请务必查看官方文档以获取更多信息。</p><p id="0be9" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">Micronaut的一个关键特性是强调可测试性，这使得为您的应用程序编写测试变得很容易。Micronaut提供了对单元测试、集成测试和外部系统测试的支持，并提供了一系列测试实用程序，使得编写有效的测试变得容易。通过使用Micronaut的测试功能，您可以确保您的应用程序经过良好的测试和可维护性。</p><p id="2d85" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><em class="mj">您是否在自己的项目中使用过Micronaut及其测试功能？</em></p><p id="e858" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">你的经历是怎样的？</p></div></div>    
</body>
</html>