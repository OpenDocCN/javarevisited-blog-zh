<html>
<head>
<title>Single Sign-On(SSO) with Spring Boot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Boot的单点登录(SSO)</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/single-sign-on-sso-with-spring-boot-37fd7203240f?source=collection_archive---------0-----------------------#2021-03-01">https://medium.com/javarevisited/single-sign-on-sso-with-spring-boot-37fd7203240f?source=collection_archive---------0-----------------------#2021-03-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ed0b3b6d50f5bfde8428f678ff06fb86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ooSvQ0wtBo_m12D6j99Pvw.png"/></div></div></figure><p id="2dde" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">关于SSO和OAuth实际上是什么有很多混淆。有些人认为OAuth是一种“安全的东西”,并没有真正理解更多。当我们谈论OAuth和单点登录时，会出现一组流行词汇。因此，我的目的是澄清这些疑问，并希望让您了解SSO和OAuth如何以及在哪里可以让您的应用程序受益。</p><h1 id="ccbd" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">什么是单点登录？</h1><p id="a1cb" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">单点登录(SSO)是一种身份验证方法，使用户只需使用一组凭据就可以安全地对多个应用程序和网站进行身份验证。</p><p id="fa44" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">OAuth 2.0和OpenID Connect都涉及SSO功能。让我们举一个例子来更好地理解这个概念。如果您登录了Gmail，您可以自动访问YouTube、Google Drive、Google Photos和其他Google产品。</p><p id="2977" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SSO实际上是称为联合身份管理的更大概念的一部分，FIM只是指在两个或多个域或身份管理系统之间创建的信任关系。也可以将OAuth 2 视为职能指令手册架构的一部分。OAuth关注于这种信任关系，允许跨域共享用户身份信息。</p><h1 id="336e" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">OAuth 2.0</h1><p id="ed5f" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">OAuth(开放授权)是委托授权的标准协议。简而言之，OAuth是一种授权协议，它允许您代表您批准一个应用程序与另一个应用程序进行交互，而无需给出您的凭据。</p><p id="e3ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设ESPN是客户端，脸书是服务提供商(资源服务器)，万一ESPN遭到入侵，你的脸书密码仍然安全。让我们看看OAuth术语和OAuth流是如何工作的。</p><h2 id="97d3" class="ks jp hi bd jq kt ku kv ju kw kx ky jy jb kz la kc jf lb lc kg jj ld le kk lf bi translated"><strong class="ak">奥特演员</strong></h2><p id="cc3c" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">OAuth流中的参与者如下:</p><p id="6596" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">资源所有者</strong>:拥有资源服务器中的数据。</p><p id="043f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">资源服务器</strong>:存储客户端想要访问的数据的API。</p><p id="7f8d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">客户端</strong>:想要访问你的数据的应用。</p><p id="7d7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">授权服务器</strong>:OAuth的主引擎。授权服务器发布访问令牌以及客户端ID和密码。</p><h2 id="a953" class="ks jp hi bd jq kt ku kv ju kw kx ky jy jb kz la kc jf lb lc kg jj ld le kk lf bi translated"><strong class="ak"> OAuth 2基本工作流程</strong></h2><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/772f1cf3edef531e41814b3e25fa8eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AYWn2wAzQgZwx_PiJYXiWg.jpeg"/></div></div><p class="ll lm et er es ln lo bd b be z dx translated">OAuth工作流</p></figure><p id="1969" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们用一个例子来理解工作流。我们以脸书为例。比方说，我们正在使用脸书上的一个应用程序，它要求你显示你的个人资料和照片。脸书在这种情况下资源服务器(它有你的登录数据和图片)。app就是消费者(客户端)。作为用户，我们希望使用该应用程序来处理我们的图片。我们特别授权这个应用程序访问我们的图片，OAuth在后台管理这些图片。当我们让这个应用程序访问我们的图片时，应用程序(客户端)从授权服务器获得访问令牌，并将其发送到资源服务器。以便客户端从资源服务器接收请求资源。</p><p id="0487" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我应该使用哪个OAuth 2.0流程？</p><p id="88b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kr" href="https://auth0.com/docs/protocols/protocol-oauth2" rel="noopener ugc nofollow" target="_blank"> OAuth 2.0授权框架</a>支持几种不同的流程(或授权)。流是检索访问令牌的方式。决定哪一个适合您的用例主要取决于您的<a class="ae kr" href="https://auth0.com/docs/applications" rel="noopener ugc nofollow" target="_blank">应用类型</a>，但是其他参数也很重要，比如对客户端的信任程度，或者您希望您的用户拥有的体验。</p><p id="70e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> OpenID连接vs OAuth 2 </strong></p><figure class="lh li lj lk fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2018/01/how-http-basic-authentication-works-in.html"><div class="er es lp"><img src="../Images/b76f949fa0727f364012e412f8b3f76a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*0V0Dy78JCYvZgfU1xBN9Iw.png"/></div></a><p class="ll lm et er es ln lo bd b be z dx translated">OAuth与OpenID连接</p></figure><ul class=""><li id="b743" class="lq lr hi is b it iu ix iy jb ls jf lt jj lu jn lv lw lx ly bi translated"><strong class="is hj"> OAuth 2.0 </strong>用于授权。</li><li id="1c0b" class="lq lr hi is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly bi translated"><strong class="is hj"> OpenID Connect </strong>用于认证。</li></ul><p id="1e9f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">OAuth 2是一个授权框架，OAuth缺乏认证指导导致了一些混乱，这也正是OpenID connect被创建的原因。OIDC是更新的标准，它扩展了OAuth，增加了对身份验证的支持。基本上，OpenID Connect是一个建立在OAuth 2.0之上的身份验证层，用于提供单点登录功能。</p><p id="cbe8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">客户端ID和客户端密码</strong></p><p id="6c16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该ID用于标识客户端和授权服务器。客户端密码是只有客户端和授权服务器知道的密码。</p><p id="34e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">客户端ID和密码由授权服务器生成。这就是授权服务器验证客户端的方式。</p><p id="5c19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">访问令牌与刷新令牌</strong></p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/c3fbe895525d0a2d3c6ef7647bec2d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2JbDLAXnwCcww8Xmvdfj6w.png"/></div></div><p class="ll lm et er es ln lo bd b be z dx translated">访问令牌与刷新令牌</p></figure><p id="1ce7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当访问令牌过期或变得无效，但应用程序仍然需要访问受保护的资源时，应用程序面临的问题是在不迫使用户再次授予权限的情况下获得新的访问令牌。为了解决这个问题，OAuth 2.0引入了一个叫做<a class="ae kr" href="https://auth0.com/docs/tokens/refresh-token/current" rel="noopener ugc nofollow" target="_blank">刷新令牌</a>的工件。刷新令牌允许应用程序在不提示用户的情况下获得新的访问令牌。刷新令牌只返回到授权服务器，访问令牌返回到(RS)资源服务器。</p><p id="4438" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> ID令牌</strong></p><p id="4784" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">OpenID Connect (OIDC)是建立在OAuth 2.0之上的身份验证协议。使用OAuth 2.0，用户可以通过授权服务器进行身份验证，并获得一个授权访问某些服务器资源的访问令牌。在OIDC，他们还会给你一个名为ID token的令牌。</p><p id="b7f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ID令牌包含有关用户及其身份验证状态的信息。您的客户端既可以使用它进行身份验证，也可以将它作为用户信息的存储库。一个OIDC流可以返回访问令牌和ID令牌。</p><p id="2ddb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> JWT (JSON网络令牌)</strong></p><p id="691d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">JWT只是一种令牌格式，用于授权。JWT令牌是JSON编码的数据结构。用户登录后，每个后续请求都将包含JWT，允许用户访问该令牌允许的路由、服务和资源。单点登录是当今广泛使用JWT的一个特性。</p><p id="a32f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> JWT vs OAuth 2 </strong></p><p id="2668" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">JWT和OAuth2是完全不同的，服务于不同的目的，但它们是兼容的，可以一起使用。OAuth2协议没有指定令牌的格式。因此，JWT可以并入OAuth2的用法中。</p><h2 id="94ac" class="ks jp hi bd jq kt ku kv ju kw kx ky jy jb kz la kc jf lb lc kg jj ld le kk lf bi translated">结论</h2><p id="4536" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">我们从讨论单点登录开始，然后讨论了与SSO相关的术语。基本上，在本文中，我们学习了这些事情如何与SSO相关联以及OAuth流如何工作等。在本文的第二部分，我们将学习如何在您的<a class="ae kr" rel="noopener" href="/javarevisited/top-10-courses-to-learn-spring-boot-in-2020-best-of-lot-6ffce88a1b6e"> spring boot应用程序</a>中实现SSO特性。感谢阅读😊。</p></div></div>    
</body>
</html>