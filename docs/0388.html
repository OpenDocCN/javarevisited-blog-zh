<html>
<head>
<title>Drumbooth touchscreen controller with Raspberry Pi and JavaFX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Drumbooth触摸屏控制器，带Raspberry Pi和JavaFX</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/drumbooth-touchscreen-controller-with-raspberry-pi-and-javafx-f42583bfe14f?source=collection_archive---------0-----------------------#2020-04-17">https://medium.com/javarevisited/drumbooth-touchscreen-controller-with-raspberry-pi-and-javafx-f42583bfe14f?source=collection_archive---------0-----------------------#2020-04-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8191" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于我的书<a class="ae jd" href="https://webtechie.be/books/" rel="noopener ugc nofollow" target="_blank">“Raspberry Pi Java入门”</a>中的多个例子，我为我儿子的架子鼓创建了一个触摸屏控制器。结合继电器板和Arduino，这允许通过触摸屏界面控制LED灯条和不同的灯。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div></figure><p id="1d73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一个网络服务器，所以我们可以通过网页在房子的任何地方触发一些事件，这样当食物摆在桌子上时，我们就不再需要在楼下大喊大叫了；-)</p><p id="d771" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整个装置连接在220V电源开关之后，以便在展台不使用时关闭所有设备。Pi通电时，Java应用程序自动启动。其中一个220伏的灯连接到继电器的开路端，所以当220伏的开关打开时，灯立即亮了。</p><h1 id="87bb" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">材料表</h1><ul class=""><li id="cdaf" class="kj kk hi ih b ii kl im km iq kn iu ko iy kp jc kq kr ks kt bi translated">树莓派3B+</li><li id="698b" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">触摸屏，对我来说是<a class="ae jd" href="https://www.kiwi-electronics.nl/raspberry-pi/hdmi-7-inch-800x480-display-backpack-met-touchscreen" rel="noopener ugc nofollow" target="_blank">7英寸型号</a></li><li id="d5da" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">2 * SPI <a class="ae jd" href="https://www.amazon.com/gp/product/B07Q2P9D7K/ref=ppx_yo_dt_b_asin_title_o00_s00?ie=UTF8&amp;psc=1" rel="noopener ugc nofollow" target="_blank">可堆叠中继板</a></li><li id="8a55" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">Arduino Uno</li><li id="c4f5" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">WS2812B LED灯条</li><li id="2bd6" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">5V电源，取决于灯条上led的数量，在我的情况下<a class="ae jd" href="https://www.dx.com/p/5v-20a-led-monitoring-constant-voltage-power-supply-switch-ac-90-264v-2055437" rel="noopener ugc nofollow" target="_blank">这是20A型号</a></li><li id="871b" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">Pi和Arduino之间的USB电缆</li><li id="b945" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">安装材料，大量电缆，连接继电器的不同灯</li></ul><h1 id="3cf8" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">接线</h1><div class="je jf jg jh fd ab cb"><figure class="kz ji la lb lc ld le paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/82c5c4c15eb13021294d18535b077b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*BIGrsm6Q6oOKeFB-AWyJ0g.png"/></div></figure><figure class="kz ji ll lb lc ld le paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/cd2c3d8d1b6d524e5127a280cf92a462.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*qFR1-ysnmCTCDeiiE8OLhw.jpeg"/></div></figure><figure class="kz ji ll lb lc ld le paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/c983f4252d021774f63ea9494785e4b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*jEB4NNlCB86D0rThYa846A.jpeg"/></div><p class="lm ln et er es lo lp bd b be z dx lq di lr ls translated">布线方案、安装的组件、为led灯条选择的彩虹效果</p></figure></div><ul class=""><li id="b798" class="kj kk hi ih b ii ij im in iq lt iu lu iy lv jc kq kr ks kt bi translated">两块板之间的USB电缆(用于串行通信)</li><li id="c440" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">从电源到Pi、Arduino和LED灯条的5V和接地</li><li id="854d" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">引脚6、7和8与三个LED灯条之间的控制电缆</li></ul><h1 id="b38d" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">源代码</h1><p id="4e83" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">这个项目是我的书《<a class="ae jd" href="https://webtechie.be/books/" rel="noopener ugc nofollow" target="_blank">树莓Pi </a>上的Java入门》的多个例子的组合，这些例子都在<a class="ae jd" href="https://github.com/FDelporte/JavaOnRaspberryPi" rel="noopener ugc nofollow" target="_blank">这个GitHub项目“JavaOnRaspberryPi”</a>中分享。这个项目本身也作为“DrumBoothController”在GitHub上分享<a class="ae jd" href="https://github.com/FDelporte/DrumBoothController" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="e51a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为它同时使用了Raspberry Pi和Arduino，所以您会在源代码中找到两个目录。</p><p id="aeda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两个板之间共享的命令是“COMMAND _ ID:SPEED:R1:G1:B1:R2:G2:B2”结构中的字符串，其中命令ID是以下选项之一:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/9ce5c00fcd0e3dc048159ace6bd80e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*KJtysJT-DdtFdvlT.png"/></div></figure><p id="1b1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一些例子</p><ul class=""><li id="7fb1" class="kj kk hi ih b ii ij im in iq lt iu lu iy lv jc kq kr ks kt bi translated">1:20:255:0:0 =所有led固定为全红色</li><li id="206d" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">3:2500:255:0:0:0:0:255 =每隔2.5秒将所有led从全红变为全蓝</li><li id="b38e" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">5:50:255:0:0:0:0:255 =所有led为蓝色，一个运行中的led为红色并持续50毫秒</li></ul><h1 id="c039" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">Arduino控制LED灯条</h1><p id="e062" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">因为我使用了三个平行的LED灯条，所以我想在这三个灯条上产生相同的效果。所以代码从条带的初始化开始。</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="8e05" class="mf jm hi mb b fi mg mh l mi mj">Adafruit_NeoPixel strip1 = Adafruit_NeoPixel(NUMBER_OF_LEDS, PIN1, NEO_GRB + NEO_KHZ800);<br/>Adafruit_NeoPixel strip2 = Adafruit_NeoPixel(NUMBER_OF_LEDS, PIN2, NEO_GRB + NEO_KHZ800);<br/>Adafruit_NeoPixel strip3 = Adafruit_NeoPixel(NUMBER_OF_LEDS, PIN3, NEO_GRB + NEO_KHZ800);</span></pre><p id="d800" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两个电路板之间的通信是通过串行链路完成的(不是书中的Mosquitto，因为在这种情况下我只想使用一个控制器)。因此，在循环方法中，串行数据被读取和处理。</p><pre class="je jf jg jh fd ma mb mc md aw me bi"><span id="60c4" class="mf jm hi mb b fi mg mh l mi mj">void loop() {  <br/>  checkSerial();<br/>  handleMessage();<br/>  <br/>  currentLoop++;</span><span id="5ca0" class="mf jm hi mb b fi mk mh l mi mj">  // Only do LED effect when loop exceeds the defined animationSpeed<br/>  if (currentLoop &gt;= animationSpeed) {<br/>    // Depending on the commandId, call the correct LED effect<br/>    if (commandId == 1) {<br/>      setStaticColor();<br/>    } else if (commandId == 2) {<br/>      setStaticFade();<br/>    } else if (commandId == 3) {<br/>      ...<br/>    }</span><span id="fc68" class="mf jm hi mb b fi mk mh l mi mj">    currentLoop = 0;<br/>  }</span><span id="d002" class="mf jm hi mb b fi mk mh l mi mj">  delay(5);<br/>}</span></pre><p id="ee67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查看每个被调用方法的GitHub源代码，了解更多细节。</p><h1 id="16e8" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">树莓Pi的Java和JavaFX</h1><p id="00bd" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">Java应用程序包含三个不同的屏幕</p><ul class=""><li id="0e40" class="kj kk hi ih b ii ij im in iq lt iu lu iy lv jc kq kr ks kt bi translated">继电器控制器，带有用于2 * 4继电器的切换按钮</li><li id="8d5d" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">LED条形控制器选择颜色和LED效果，使用<a class="ae jd" href="https://harmoniccode.blogspot.com/2016/03/friday-fun-xxiv.html" rel="noopener ugc nofollow" target="_blank">这个颜色选择器组件</a>来自<a class="ae jd" href="https://twitter.com/hansolo_" rel="noopener ugc nofollow" target="_blank"> Gerrit格伦瓦德</a>。</li><li id="a146" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">在切断电源之前，退出屏幕以安全关闭Pi电源</li></ul><div class="je jf jg jh fd ab cb"><figure class="kz ji ml lb lc ld le paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/6f9d94940a443ce55095207d17012303.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*33gcPqFNTbwdVM9Scne5XA.png"/></div></figure><figure class="kz ji mm lb lc ld le paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/05928bec285d193acf564529a7a2a326.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*gr0zzg4pkjDNN8Sf3Gu2kw.png"/></div></figure><figure class="kz ji mn lb lc ld le paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><img src="../Images/200ec4c37217065160b4e9b5585629e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*qOe5yHfYJ3YoM2-SjNpdTw.png"/></div><p class="lm ln et er es lo lp bd b be z dx mo di mp ls translated">退出屏幕、LED灯条控制器、继电器控制器的屏幕截图</p></figure></div><p id="fed3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事件管理器在所有UI组件和Undertow web服务器之间共享，以将UI与通过网页触发的事件对齐。该事件管理器也是执行命令的地方，以便:</p><ul class=""><li id="39e0" class="kj kk hi ih b ii ij im in iq lt iu lu iy lv jc kq kr ks kt bi translated">用集成电路控制继电器</li><li id="54ff" class="kj kk hi ih b ii ku im kv iq kw iu kx iy ky jc kq kr ks kt bi translated">使用Pi4J通过串行通信发送LED命令</li></ul><p id="bb3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下截图显示了在网页上选择“红色警报”后的状态，以及在LED条UI上选择运行灯时的初始状态。</p><div class="je jf jg jh fd ab cb"><figure class="kz ji mq lb lc ld le paragraph-image"><img src="../Images/b8596e1e055a1d8be3ced2eb1a657579.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*tsURz1wetUw0-04tNFmgvQ.png"/></figure><figure class="kz ji mr lb lc ld le paragraph-image"><img src="../Images/aee867aae79eeb8a57d3dbed229a7846.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*amejeNHbSq5HV8LNRmNZlA.png"/><p class="lm ln et er es lo lp bd b be z dx ms di mt ls translated">选择“红色警报”和其他选定的LED效果后显示页面的网页</p></figure></div><h1 id="bd66" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">最终结果</h1><p id="bae5" class="pw-post-body-paragraph if ig hi ih b ii kl ik il im km io ip iq lw is it iu lx iw ix iy ly ja jb jc hb bi translated">网页和触摸屏用户界面并排。正如您所看到的(从37英寸开始)，通过web页面进行的更改会立即在JavaFX UI中可视化。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mu jk l"/></div></figure></div><div class="ab cl mv mw gp mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hb hc hd he hf"><blockquote class="nc"><p id="daa9" class="nd ne hi bd nf ng nh ni nj nk nl jc dx translated">您可能喜欢的其他文章:</p></blockquote><div class="nm nn no np nq nr"><a rel="noopener follow" target="_blank" href="/javarevisited/what-java-programmers-should-learn-in-2020-648050533c83"><div class="ns ab dw"><div class="nt ab nu cl cj nv"><h2 class="bd hj fi z dy nw ea eb nx ed ef hh bi translated">2020年Java程序员该学什么？</h2><div class="ny l"><h3 class="bd b fi z dy nw ea eb nx ed ef dx translated">2020年Java程序员可以学习的有用工具、技术、框架和库</h3></div><div class="nz l"><p class="bd b fp z dy nw ea eb nx ed ef dx translated">medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of lj nr"/></div></div></a></div><div class="og oh ez fb oi nr"><a rel="noopener follow" target="_blank" href="/javarevisited/top-5-java-online-courses-for-beginners-best-of-lot-1e1e240a758"><div class="ns ab dw"><div class="nt ab nu cl cj nv"><h2 class="bd hj fi z dy nw ea eb nx ed ef hh bi translated">2020年学习Java的10大课程</h2><div class="ny l"><h3 class="bd b fi z dy nw ea eb nx ed ef dx translated">如果你是计算机科学专业的毕业生，或者想学习Java并且正在寻找一些很棒的资源，比如…</h3></div><div class="nz l"><p class="bd b fp z dy nw ea eb nx ed ef dx translated">medium.com</p></div></div><div class="oa l"><div class="oj l oc od oe oa of lj nr"/></div></div></a></div><div class="og oh ez fb oi nr"><a rel="noopener follow" target="_blank" href="/free-code-camp/these-are-the-best-free-courses-to-learn-data-structures-and-algorithms-in-depth-4d52f0d6b35a"><div class="ns ab dw"><div class="nt ab nu cl cj nv"><h2 class="bd hj fi z dy nw ea eb nx ed ef hh bi translated">我最喜欢的免费课程&amp;深入学习数据结构和算法的认证</h2><div class="ny l"><h3 class="bd b fi z dy nw ea eb nx ed ef dx translated">为程序员学习数据结构和算法的一些最好的免费在线课程的精选列表。</h3></div><div class="nz l"><p class="bd b fp z dy nw ea eb nx ed ef dx translated">medium.com</p></div></div><div class="oa l"><div class="ok l oc od oe oa of lj nr"/></div></div></a></div></div></div>    
</body>
</html>