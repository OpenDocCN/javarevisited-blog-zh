<html>
<head>
<title>Send Message to Azure Service Bus via Postman using SAS Token in 1 Step</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SAS令牌通过邮递员在1个步骤中向Azure服务总线发送消息</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/send-message-to-azure-service-bus-via-postman-using-sas-token-in-1-step-a845686baad0?source=collection_archive---------0-----------------------#2021-12-03">https://medium.com/javarevisited/send-message-to-azure-service-bus-via-postman-using-sas-token-in-1-step-a845686baad0?source=collection_archive---------0-----------------------#2021-12-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="613a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Azure Service Bus是一个完全托管的企业消息代理，它提供</p><ul class=""><li id="7b51" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">消息队列</li><li id="a2e8" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">发布-订阅主题</li></ul><p id="2696" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它通常用于分离应用程序和服务，带来以下优势:</p><ul class=""><li id="f087" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">在相互竞争的工作人员之间平衡工作负载</li><li id="00d2" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">安全路由和传输数据，并控制访问服务和应用边界</li><li id="1366" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">协调需要高度可靠性的事务性工作</li></ul><figure class="js jt ju jv fd jw er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/04/how-to-crack-microsoft-azure-solution-architect-exam-az-300.html#axzz6qW2Tjcoe"><div class="er es jr"><img src="../Images/ed9aa991a394a025a338e7e40e77c955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3FyH7r6oxEiQNzgI"/></div></a><p class="jz ka et er es kb kc bd b be z dx translated">马丁·施瑞德在<a class="ae kd" href="https://unsplash.com/s/photos/code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="26d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们开发我们的解决方案时，我们可能想通过向我们的队列/主题发送消息来测试它。</p><p id="3e1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以通过两种方式发送消息:</p><ol class=""><li id="6aaa" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc kl jj jk jl bi translated">Microsoft Azure门户上的浏览器本身</li><li id="14e2" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc kl jj jk jl bi translated"><a class="ae kd" href="https://docs.microsoft.com/en-us/rest/api/servicebus/send-message-to-queue" rel="noopener ugc nofollow" target="_blank">服务总线服务Restful API </a></li></ol><p id="53e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将关注通过Postman的第二种方法。如果您只想偶尔发送一个简单的测试，Explorer可能是一个方便的选择。</p><p id="2f08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，它会在成功发送后清除您的“消息体”,如果您将使用类似的输入消息，这可能会对测试过程造成相当大的干扰。</p><p id="1d43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看微软提供的restful API来访问我们的服务总线名称空间。这是一个对<code class="du km kn ko kp b">http{s}://{serviceNamespace}.servicebus.windows.net/{queuePath or topicPath}/messages</code>的<code class="du km kn ko kp b">POST</code>请求，在请求头中带有强制属性，如<code class="du km kn ko kp b">Authorization</code>、<code class="du km kn ko kp b">Content-Type</code>和<code class="du km kn ko kp b">BrokerProperties</code>。</p><p id="2c47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du km kn ko kp b">Authorization</code>的值可以是以下类型之一:</p><ol class=""><li id="2063" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc kl jj jk jl bi translated">Azure Active Directory(Azure AD)JSON Web令牌(JWT)</li><li id="2d5d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc kl jj jk jl bi translated">共享访问签名(SAS)令牌</li></ol><p id="c716" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将专注于使用SAS令牌获得授权。你可以在这里阅读更多关于令牌结构<a class="ae kd" href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-sas#generate-a-shared-access-signature-token" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="22f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们需要一个令牌，我们通常要做的就是运行另一个单独的<a class="ae kd" href="https://javarevisited.blogspot.com/2016/10/difference-between-put-and-post-in-restful-web-service.html#axzz7E4Jl2a5D" rel="noopener ugc nofollow" target="_blank"> POST请求</a>来生成一个新的令牌。然而，这可能是非常乏味的，并且同样会破坏我们的测试过程。</p><h1 id="d466" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">预请求脚本</h1><p id="ac2f" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">我想向您介绍一下Postman中的预请求脚本功能。这允许我们运行一些代码，并为我们的请求中使用的变量赋值。</p><p id="6a6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在创建消息的<code class="du km kn ko kp b">POST</code>请求中，我们需要两个变量——访问令牌和代理属性(可选，仅在需要设置额外的元数据信息时使用，如<code class="du km kn ko kp b">SessionId</code>、<code class="du km kn ko kp b">PartitionKey</code>等。).您需要用您的<code class="du km kn ko kp b">SharedKeyName</code>、<code class="du km kn ko kp b">SharedKey</code>和<code class="du km kn ko kp b">URI</code>更新以下代码。<code class="du km kn ko kp b">createSharedAccessToken</code>负责根据<a class="ae kd" href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-sas#generate-a-shared-access-signature-token" rel="noopener ugc nofollow" target="_blank">结构</a>形成SAS令牌。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lt lu l"/></div><p class="jz ka et er es kb kc bd b be z dx translated">邮递员预请求脚本</p></figure><p id="af4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您的邮递员请求应该如下所示:</p><figure class="js jt ju jv fd jw er es paragraph-image"><a href="https://www.java67.com/2017/10/how-to-test-restful-web-services-using.html"><div class="er es lv"><img src="../Images/914713cbe78571f1361f66d3a0a7df33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1kzCveaJlvuOkTnYx4nIQ.png"/></div></a><p class="jz ka et er es kb kc bd b be z dx translated">示例:Postman中的预请求脚本</p></figure><figure class="js jt ju jv fd jw er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/02/top-5-postman-tutorials-and-courses-for-web-developers.html"><div class="er es lv"><img src="../Images/6cbac91846c22477caf06e3d4bdb83ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EzW93WxqBwrAGHpyolkh0Q.png"/></div></a><p class="jz ka et er es kb kc bd b be z dx translated">示例:标题</p></figure><h1 id="d252" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">摘要</h1><p id="de6f" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">瞧啊。现在，我们可以通过一个简单的步骤将消息发送到我们的队列/主题！</p><p id="e67d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你会发现这种方法简单而直观！如果您能帮助与您的同行分享这篇文章，我将非常感激，这样它就能接触到更广泛的受众！🙏</p><p id="43a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读！🤓</p><p id="ef7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">边注:如果你还不是中会员，点击<a class="ae kd" rel="noopener" href="/@mariochiadev/membership">这里加入</a>！</p><div class="lw lx ez fb ly lz"><a rel="noopener follow" target="_blank" href="/@mariochiadev/membership"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hj fi z dy me ea eb mf ed ef hh bi translated">用我的推荐链接云加入媒体</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">medium.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn jx lz"/></div></div></a></div><h1 id="7d79" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">参考</h1><div class="lw lx ez fb ly lz"><a href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hj fi z dy me ea eb mf ed ef hh bi translated">Azure服务总线消息传递概述- Azure服务总线</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">Azure Service Bus是一个完全托管的企业消息代理，具有消息队列和发布-订阅主题(在…</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">docs.microsoft.com</p></div></div><div class="mi l"><div class="mo l mk ml mm mi mn jx lz"/></div></div></a></div></div></div>    
</body>
</html>