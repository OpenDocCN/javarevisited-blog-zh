<html>
<head>
<title>How about using @PostConstruct?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用@PostConstruct怎么样？</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/how-about-postconstruct-40fe1297e70d?source=collection_archive---------0-----------------------#2022-06-28">https://medium.com/javarevisited/how-about-postconstruct-40fe1297e70d?source=collection_archive---------0-----------------------#2022-06-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ec3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Spring Boot和Java中使用的有用注释</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ea5a041a80171419cc046519fbdd7fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1AE1boHLdMKhImIF718Rzg.jpeg"/></div></div></figure><p id="e151" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在某些情况下，您可能希望在程序中自动地实现一个动作一次。这个注释会有所帮助，我将给出两个例子。</p><p id="8ece" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用的是Spring Boot 2.7.1和Java 11。</p><h2 id="c2dd" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">@PostConstruct</h2><p id="014f" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated"><a class="ae kp" rel="noopener" href="/javarevisited/top-10-free-courses-to-learn-spring-framework-for-java-developers-639db9348d25"> Spring </a>在bean属性初始化后只调用一次用<code class="du kq kr ks kt b">@PostConstruct</code>标注的方法。列出一些特征很重要:</p><ul class=""><li id="552b" class="ku kv hi ih b ii ij im in iq kw iu kx iy ky jc kz la lb lc bi translated">这些方法可以有任何访问级别；</li><li id="d91e" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">这些方法不能<a class="ae kp" href="https://javarevisited.blogspot.com/2017/02/5-difference-between-constructor-and-factory-method-in-java.html" rel="noopener ugc nofollow" target="_blank">静止</a>；</li><li id="c7a8" class="ku kv hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">这些方法要么在无事可做时运行，要么初始化。</li></ul><p id="2139" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如:</p><pre class="je jf jg jh fd li kt lj lk aw ll bi"><span id="2210" class="jp jq hi kt b fi lm ln l lo lp">@Slf4j<br/>@Component<br/>@RequiredArgsConstructor<br/>public class PostConstructRegisterApp {<br/><br/>    private final RestTemplate restTemplate;<br/>    private final AppProperties appProperties;<br/>    private final Environment environment;<br/><br/>    <strong class="kt hj">@PostConstruct</strong><br/>    public void init() {<br/>        var request = AppRegistrationRequestModel.<em class="lq">builder</em>()<br/>                .port(Integer.<em class="lq">parseInt</em>(environment.getProperty("server.port")))<br/>                .host("localhost")<br/>                .build();<br/>        var response = restTemplate.postForEntity(appProperties.getUri() + "/notification", request, Object.class);<br/>        <em class="lq">log</em>.info("Quotation registered on stock manager: {}", response.getStatusCode());<br/>    }<br/><br/>}</span></pre><p id="89f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我用这个方法发送了一个请求:</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/05/top-20-spring-boot-interview-questions-answers.html"><div class="er es lr"><img src="../Images/9f7460ab8699f660461795b749de7f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AxQ0QnhI-rrs4DVKgv_5pg.png"/></div></a></figure><p id="40a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是另一个用例是在<a class="ae kp" rel="noopener" href="/javarevisited/5-best-books-to-learn-sql-and-database-design-for-programmers-and-developers-1e7839df2f3e">数据库</a>中创建一些数据，就像一个临时用户:</p><pre class="je jf jg jh fd li kt lj lk aw ll bi"><span id="0374" class="jp jq hi kt b fi lm ln l lo lp">@Component<br/>@RequiredArgsConstructor<br/>public class UserDBInitializer {<br/><br/>    private final UserRepository userRepository;<br/><br/>    @PostConstruct<br/>    private void createTemporaryUser() {<br/>        User admin = new User("admin", "pass");<br/>        User user = new User("user", "pass");<br/>        userRepository.save(admin, user);<br/>    }</span><span id="722f" class="jp jq hi kt b fi ls ln l lo lp">}</span></pre><p id="daec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该用户可用于首次登录，之后可删除。</p><p id="1408" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kp" rel="noopener" href="/javarevisited/10-best-online-courses-to-learn-spring-framework-in-2020-f7f73599c2fd"> Spring </a>也可以处理多个用@PostConstruct注释的方法，就像这样:</p><pre class="je jf jg jh fd li kt lj lk aw ll bi"><span id="0587" class="jp jq hi kt b fi lm ln l lo lp">@PostConstruct<br/>public void init() {<br/>    <em class="lq">log</em>.info("1111 tests");<br/>}<br/><br/>@PostConstruct<br/>public void init2() {<br/>    <em class="lq">log</em>.info("2222 tests");<br/>}</span></pre><p id="f877" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果是:</p><figure class="je jf jg jh fd ji er es paragraph-image"><a href="https://www.java67.com/2012/08/spring-interview-questions-answers.html"><div class="er es lt"><img src="../Images/9551ec186077050317f07ad0142015ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*2Amtx3OMkRCatdfUx46EnA.png"/></div></a></figure><p id="8ce3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天到此为止。</p></div></div>    
</body>
</html>