<html>
<head>
<title>Writing my First Ethereum Smart Contract (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">撰写我的第一份以太坊智能合约(第1部分)</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/writing-my-first-ethereum-smart-contract-part-1-fa74e329cb93?source=collection_archive---------4-----------------------#2021-11-09">https://medium.com/javarevisited/writing-my-first-ethereum-smart-contract-part-1-fa74e329cb93?source=collection_archive---------4-----------------------#2021-11-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d09b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我相信你应该听说过比特币。与比特币类似，以太坊是另一个<a class="ae jd" rel="noopener" href="/javarevisited/7-free-courses-to-learn-blockchain-in-2020-764e66b47ebe">区块链平台</a>，拥有自己的加密货币——以太(ETH)。</p><p id="d80a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以太坊是一个去中心化、开源的<a class="ae jd" rel="noopener" href="/javarevisited/best-blockchain-courses-and-certification-in-2020-63729f8f04d0">区块链</a>，拥有智能合约——世界可编程区块链。与比特币不同，以太坊让你有能力开发自己的数字资产。</p><p id="484d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Solidity是用于在以太坊中编写智能合约的编程语言。让我们从一些坚实的基础开始吧！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://javarevisited.blogspot.com/2021/11/top-5-courses-to-learn-ethereum-for.html"><div class="er es je"><img src="../Images/46360ee4e531fd7235998ed7315d9ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ev9TXxz26vQeyveL"/></div></a><p class="jm jn et er es jo jp bd b be z dx translated">约翰·施诺布里奇在<a class="ae jd" href="https://unsplash.com/s/photos/smart-contract?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="50ab" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak">坚固性编译</strong></h1><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/07/top-5-online-courses-to-learn-blockchain.html#axzz6tFYADc00"><div class="er es ko"><img src="../Images/0cb298178dc4083c1395d432a445c02a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zq-dyrHZGAOeVwlnikUkyA.png"/></div></a></figure><p id="f0ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kp"> Solc </em>用于将solidity代码编译成以太坊虚拟机(EVM)字节码。然后字节码将在一个事务中被部署到以太网。</p><h1 id="5325" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">固体介绍</h1><h2 id="35d5" class="kq jr hi bd js kr ks kt jw ku kv kw ka iq kx ky ke iu kz la ki iy lb lc km ld bi translated">智能合同的基本结构</h2><p id="4754" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">其结构与Java/C#等任何面向对象语言非常相似。</p><p id="51aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们应该总是在第一行定义solidity版本，然后是契约的实现，它可以封装变量和方法。也支持类继承。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lj lk l"/></div><p class="jm jn et er es jo jp bd b be z dx translated">抽象合同的示例</p></figure><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lj lk l"/></div><p class="jm jn et er es jo jp bd b be z dx translated">继承合同的示例</p></figure><h2 id="34a3" class="kq jr hi bd js kr ks kt jw ku kv kw ka iq kx ky ke iu kz la ki iy lb lc km ld bi translated">基本数据类型</h2><ul class=""><li id="0788" class="ll lm hi ih b ii le im lf iq ln iu lo iy lp jc lq lr ls lt bi translated">弯曲件</li><li id="b00d" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">枚举<name>{成员} <br/> -例如<em class="kp">枚举设备{一、二、三、四、五、六} </em></name></li><li id="7808" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">int，uint，int8，uint8，int16，uint16，…，uint256 <br/> -有符号和无符号(可以是正数/负数)整数，大小为<br/> -默认值= 256，因此int = int256，uint = uint256 <br/> - int8表示1字节有符号整数</li><li id="98d2" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">地址<br/> -保存20字节地址(例如以太坊账户地址)</li><li id="6647" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">线</li></ul><p id="1041" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">复杂数据类型</strong></p><ul class=""><li id="483a" class="ll lm hi ih b ii ij im in iq lz iu ma iy mb jc lq lr ls lt bi translated">字节<br/> -字节的动态数组</li><li id="9b49" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated"><type> [] <br/> -动态数组<br/> -如uint[]numar；</type></li><li id="8401" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">映射(<key type="">= &gt;<value type="">)<br/>——一个&lt;键类型&gt;到&lt;值类型&gt; <br/>的哈希映射的概念——比如<em class="kp">映射(address = &gt; uint)平衡；</em></value></key></li><li id="e378" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">struct <name> { <member types=""> } <br/> -例如<em class="kp">struct item {<br/>string name；<br/>uint id；<br/>地址addr<br/> } </em></member></name></li></ul><p id="c0ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">可变范围</strong></p><ul class=""><li id="b0ef" class="ll lm hi ih b ii ij im in iq lz iu ma iy mb jc lq lr ls lt bi translated">状态变量—在合同范围内定义。它有持久存储，并将存储在以太坊的账本中。<br/>如<br/> <em class="kp">合同阅读器{ <br/> uint数据；//状态变量<br/> } </em></li><li id="adbd" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">局部变量—在函数范围内定义。它在执行期间会消耗EVM堆栈内存，但在完成时会被丢弃。<br/>例如<br/> <em class="kp">合同阅读器{ <br/>函数calculate foo(){<br/>uint temp；//局部变量<br/> } <br/> } </em></li></ul><p id="2cac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有两种类型的存储:</p><ol class=""><li id="fa19" class="ll lm hi ih b ii ij im in iq lz iu ma iy mb jc mc lr ls lt bi translated">存储——EVM的持久存储(昂贵的天然气)。状态变量的默认值</li><li id="1d56" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc mc lr ls lt bi translated">记忆——EVM的临时储存(下气)。局部变量的默认值。</li></ol><p id="350b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然<code class="du md me mf mg b">memory</code>是局部变量的默认存储类型，但它(和函数参数)也可以明确定义为<code class="du md me mf mg b">storage</code>。</p><h2 id="6182" class="kq jr hi bd js kr ks kt jw ku kv kw ka iq kx ky ke iu kz la ki iy lb lc km ld bi translated">函数语法</h2><pre class="jf jg jh ji fd mh mg mi mj aw mk bi"><span id="6863" class="kq jr hi mg b fi ml mm l mn mo">function &lt;name&gt; (&lt;params&gt;) &lt;visibility / modifier&gt; &lt;return type&gt; {<br/>  &lt;function body&gt; ...<br/>}</span><span id="c79a" class="kq jr hi mg b fi mp mm l mn mo">e.g. The following method is callable by end users<br/>function calculateSum(uint num) public view returns (uint) {<br/>  ...<br/>  return total;<br/>}</span></pre><p id="5456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">能见度</strong></p><ol class=""><li id="bf13" class="ll lm hi ih b ii ij im in iq lz iu ma iy mb jc mc lr ls lt bi translated">外部——可以使用<code class="du md me mf mg b">call</code>或<code class="du md me mf mg b">delegatecall</code>从另一个合同调用</li><li id="26ad" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc mc lr ls lt bi translated">public —最终用户可调用的公共函数或状态变量/ web3</li><li id="ca94" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc mc lr ls lt bi translated">内部—可从当前或继承的契约中访问的函数或状态变量</li><li id="9dd6" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc mc lr ls lt bi translated">私有—只能从当前契约访问的函数或状态变量</li></ol><p id="1f04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">功能修改器</strong></p><ol class=""><li id="3c9a" class="ll lm hi ih b ii ij im in iq lz iu ma iy mb jc mc lr ls lt bi translated">应付——能够收到乙醚。否则，如果提供了ether，将会引发错误。</li><li id="b374" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc mc lr ls lt bi translated">视图-不改变状态变量。可以在没有交易费的情况下调用(只读函数，根本不修改状态)</li><li id="51d6" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc mc lr ls lt bi translated">纯-根本不访问状态变量。可以无交易费调用。这样的函数通常只做计算。</li></ol><p id="4870" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">函数修饰符使用_ </strong></p><p id="b7e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du md me mf mg b">_</code>用于通常重用的代码片段。这有助于提高可读性。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="4b0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">特殊方法和变量</strong></p><ul class=""><li id="f3e0" class="ll lm hi ih b ii ij im in iq lz iu ma iy mb jc lq lr ls lt bi translated"><code class="du md me mf mg b">msg.value</code> —交易调用中发送的乙醚量</li><li id="4b9e" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated"><code class="du md me mf mg b">msg.sender</code> —当前交易的调用方</li><li id="885b" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated"><code class="du md me mf mg b">tx.origin</code> —交易链的原始调用方</li><li id="819a" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated"><code class="du md me mf mg b">tx.gasprice</code> —呼叫者指定的气价</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><a href="https://www.java67.com/2018/02/5-free-blockchain-technology-courses.html"><div class="er es mq"><img src="../Images/ccf0810c5886268f234b8a2ccb08706c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NH5RwWQk5BgnTEr3uX3moA.png"/></div></a><p class="jm jn et er es jo jp bd b be z dx translated">演示tx.orgin和msg.sender之间的区别</p></figure><h2 id="f65b" class="kq jr hi bd js kr ks kt jw ku kv kw ka iq kx ky ke iu kz la ki iy lb lc km ld bi translated">事件</h2><p id="1eb8" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">事件是协定的可继承成员。它允许应用程序订阅和侦听这些事件。发出事件时会创建事务日志。这些日志存储在链中，并且当它仍然存在于链中时，可以使用契约的地址来访问。</p><pre class="jf jg jh ji fd mh mg mi mj aw mk bi"><span id="901d" class="kq jr hi mg b fi ml mm l mn mo">// Declare an event<br/>event &lt;name&gt; (&lt;parameters&gt;)</span><span id="8900" class="kq jr hi mg b fi mp mm l mn mo">// Emit an event<br/>emit &lt;name&gt; (&lt;parameters&gt;)</span></pre><h1 id="81f7" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="34e3" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">以上总结了Solidity编程的基本概念，我希望它能让你对语法有一个深刻的了解，让我们在下一篇文章中开始一个完整的智能契约的例子吧！</p><p id="d659" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>