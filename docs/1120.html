<html>
<head>
<title>Spring AOP: use of Pointcut expression — based on class level annotation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring AOP:使用切入点表达式——基于类级注释</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/spring-aop-use-of-pointcut-expression-based-on-class-level-annotation-a4dfb224e9c1?source=collection_archive---------1-----------------------#2021-04-03">https://medium.com/javarevisited/spring-aop-use-of-pointcut-expression-based-on-class-level-annotation-a4dfb224e9c1?source=collection_archive---------1-----------------------#2021-04-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="21b0" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">处理交叉问题</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/9aaf4346bf2c58a0df83668acdb0c5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sSOw_MB-hz7KrTOs"/></div></div><p class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/@tvick?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">泰勒·维克</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="ca43" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">简介</strong></h2><p id="3723" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">在本文中，我们将创建一个简单的性能记录器方面。使用logger-aspect，我们将截取用特定注释标记的类中的每个公共方法。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h2 id="66ab" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">场景</strong></h2><p id="996f" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">首先，让我们看一个带有创建和更新方法的<code class="du lm ln lo lp b">SimpleService</code>:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="f018" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">对于延迟的使用，为了简单起见，让我们假设这两种方法都有正在进行的过程。</p><p id="a007" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">也就是说，我们的目标是记录每个方法的性能，同时保持类的高内聚和低耦合。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h2 id="47a6" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">接近</strong></h2><p id="0a9d" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">还有其他方法来处理所述场景；在我们的例子中，假设我们想要方便地注释一个类，并期望该类中的所有<a class="ae jn" href="http://javarevisited.blogspot.sg/2012/12/getter-and-setter-method-vs-public-modifier-field-java.html#axzz55oDxm8vv" rel="noopener ugc nofollow" target="_blank">公共方法</a>都有一个性能日志。现在让我们详细看看这个方法。</p><p id="f19d" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">首先，让我们创建一个名为<code class="du lm ln lo lp b">PerformanceLogger</code>的定制注释:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="5eeb" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">然后，让我们创建一个<code class="du lm ln lo lp b">PerformanceLoggerAspect</code>，连接点匹配查找用<code class="du lm ln lo lp b">PerformanceLogger</code>注释的类:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="d4e8" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">最后，让我们用<code class="du lm ln lo lp b">PerformanceLogger</code>来注释<code class="du lm ln lo lp b">SimpleService</code>类:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lq lr l"/></div></figure></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h2 id="13e2" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">结果</strong></h2><p id="5a74" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">现在，让我们创建一些测试:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="b44b" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">准备就绪后，让我们运行测试:</p><pre class="iy iz ja jb fd lx lp ly lz aw ma bi"><span id="0645" class="jo jp hi lp b fi mb mc l md me">2021-04-03 17:39:13.609  INFO 4232 --- [           main] c.emyasa.aspect.PerformanceLoggerAspect  : create method took 3025 ms<br/>2021-04-03 17:39:15.624  INFO 4232 --- [           main] c.emyasa.aspect.PerformanceLoggerAspect  : update method took 2004 ms</span></pre><p id="36b5" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">从日志中，我们可以验证应用程序在每个方法上调用了<a class="ae jn" href="https://javarevisited.blogspot.com/2019/04/top-5-courses-to-learn-jvm-internals.html" rel="noopener ugc nofollow" target="_blank"> performance </a> logger方面，假设一个类有一个<code class="du lm ln lo lp b">PerformanceLogger</code>注释。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><h2 id="d61b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">结论</strong></h2><p id="813f" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">在本文中，我们使用了一个切入点表达式，根据一个定制的注释来匹配连接点，从而创建一个简单的性能记录器方面。我们还创建了集成测试来验证<code class="du lm ln lo lp b">PerformanceLoggerAspect</code>确实在工作。</p><p id="be2b" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">另一方面，我们的方法绝不仅仅局限于日志记录；这也适用于安全性、验证或其他横切关注点。</p><p id="7349" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">和往常一样，文章的源代码可以在<a class="ae jn" href="https://github.com/emyasa/medium-articles/tree/master/core-concepts" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><p id="4ae9" class="pw-post-body-paragraph km kn hi ko b kp ls ij kr ks lt im ku jz lu kw kx kd lv kz la kh lw lc ld le hb bi translated">如果您正在寻找更多与Java相关的有趣文章，请随意查看:</p><div class="mf mg ez fb mh mi"><a rel="noopener follow" target="_blank" href="/javarevisited/spring-jpa-when-to-use-join-fetch-a6cec898c4c6"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hj fi z dy mn ea eb mo ed ef hh bi translated">Spring JPA:何时使用“Join Fetch”</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">避免N+1次查询并保留检索逻辑</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">medium.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw jh mi"/></div></div></a></div><div class="mf mg ez fb mh mi"><a rel="noopener follow" target="_blank" href="/javarevisited/jpa-specification-a-generic-search-e8695b1d19ec"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hj fi z dy mn ea eb mo ed ef hh bi translated">JPA规范:通用搜索</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">了解如何创建简单而通用的搜索</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">medium.com</p></div></div><div class="mr l"><div class="mx l mt mu mv mr mw jh mi"/></div></div></a></div></div></div>    
</body>
</html>