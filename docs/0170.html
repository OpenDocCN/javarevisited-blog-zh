<html>
<head>
<title>How to Write Constructors Your Colleagues Will Hate Refactoring</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何编写你的同事会讨厌重构的构造函数</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/how-to-write-java-constructors-your-colleagues-will-hate-refactoring-2974848b6380?source=collection_archive---------0-----------------------#2019-11-11">https://medium.com/javarevisited/how-to-write-java-constructors-your-colleagues-will-hate-refactoring-2974848b6380?source=collection_archive---------0-----------------------#2019-11-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="2b5e" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">编码气味地狱的三个步骤。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/46de49ad8ce12d8ebc66c826158975c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8vhkj9mtmnPc_a5OVxPIQ.jpeg"/></div></div></figure><p id="64f7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你即将辞掉工作，想留下一个持久的印象？下面的规则将证明你有多在乎你所做的事情。正是这种<em class="kf">签署</em>源代码片段的微妙方式让人们一直在谈论你。</p><p id="cf87" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">请看一下这段代码。它只是尖叫，“<em class="kf">重构我”</em>。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kg kh l"/></div></figure><h1 id="a3dc" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">规则1:删除所有二级构造函数</h1><p id="ef38" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">二级构造函数，或便利构造函数(Swift人这样称呼它们)，提供了获取新对象的替代方法。当调用以下任一项时，它们为不属于其参数列表的参数提供默认值:</p><ul class=""><li id="ef88" class="lf lg hi jl b jm jn jp jq js lh jw li ka lj ke lk ll lm ln bi translated">指定的建造商</li><li id="f37f" class="lf lg hi jl b jm lo jp lp js lq jw lr ka ls ke lk ll lm ln bi translated">另一个方便的构造函数</li></ul><p id="6abd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这里有一个难以忽视的事实(一语双关):没人在乎你的好意，那就去删除那些丑小鸭吧。这样，创建对象的人就必须负责所有的参数和潜在的类型转换。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kg kh l"/></div></figure><h1 id="4374" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">规则2:拥有不止一个主构造函数</h1><p id="9636" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">主构造函数或指定构造函数(在<a class="ae lt" href="https://www.java67.com/2019/03/5-free-courses-to-learn-swift.html" rel="noopener ugc nofollow" target="_blank"> Swift </a>中)初始化给定类的所有字段。所有其他构造函数都重定向到主构造函数，以消除代码复制的需要。不像<a class="ae lt" href="https://kotlinlang.org/docs/reference/classes.html#constructors" rel="noopener ugc nofollow" target="_blank"> Kotlin </a> , <a class="ae lt" rel="noopener" href="/javarevisited/10-free-courses-to-learn-java-in-2019-22d1f33a3915"> Java </a>根本不在乎你有多少主构造函数——你也不应该！</p><blockquote class="lu lv lw"><p id="2224" class="jj jk kf jl b jm jn ij jo jp jq im jr lx jt ju jv ly jx jy jz lz kb kc kd ke hb bi translated">Kotlin中的一个类可以有一个<strong class="jl hj">主构造函数</strong>和一个或多个<strong class="jl hj">次构造函数</strong>。</p></blockquote><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kg kh l"/></div></figure><h1 id="27e1" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">规则3:尽可能多地包含副作用</h1><p id="7d8d" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">大约一个月前，我在重构一些遗留代码，猜猜我发现了什么:一个构造函数中的一个语句。我怎么没想到呢？这就像去你最喜欢的意大利餐馆买一份披萨，甚至不用点餐。永远不要让用户决定何时调用一个方法——为他们调用它。</p><p id="0408" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">因此，在构造函数中包含有副作用的代码是一份不断赠送的礼物:</p><ul class=""><li id="ec22" class="lf lg hi jl b jm jn jp jq js lh jw li ka lj ke lk ll lm ln bi translated">对象总是执行代码，因此使用者不能推迟执行</li><li id="9290" class="lf lg hi jl b jm lo jp lp js lq jw lr ka ls ke lk ll lm ln bi translated">如果构造函数的行为改变，消费者需要改变他们的实现。所以让他们忙起来。</li><li id="a037" class="lf lg hi jl b jm lo jp lp js lq jw lr ka ls ke lk ll lm ln bi translated">构造函数中的代码在调用线程上运行</li><li id="c13b" class="lf lg hi jl b jm lo jp lp js lq jw lr ka ls ke lk ll lm ln bi translated">我最喜欢的一个:构造函数可以抛出异常来终止对象创建。这甚至会导致安全问题，称为<em class="kf">终结器攻击</em>(参见<a class="ae lt" href="https://www.oracle.com/technetwork/java/seccodeguide-139067.html#7" rel="noopener ugc nofollow" target="_blank"> Java安全编码指南，第7–3/OBJECT-3节</a>)。多酷啊。</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kg kh l"/></div></figure><h1 id="48a6" class="ki kj hi bd kk kl km kn ko kp kq kr ks io kt ip ku ir kv is kw iu kx iv ky kz bi translated">结论</h1><p id="e3da" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">如果你不在乎你的同事和职业，就遵循上面的规则。我保证会给你留下深刻的印象。</p><p id="d32e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在，如果你不介意的话:我有一张桌子要清理。</p><p id="11f5" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">其他<strong class="jl hj">编程篇</strong>你可能喜欢的<br/><a class="ae lt" href="https://javarevisited.blogspot.com/2017/12/10-things-java-programmers-should-learn.html#axzz5atl0BngO" rel="noopener ugc nofollow" target="_blank">2019年Java程序员应该学会的10件事</a><br/><a class="ae lt" href="http://www.java67.com/2017/12/10-programming-languages-to-learn-in.html" rel="noopener ugc nofollow" target="_blank">2019年你可以学会的10种编程语言</a> <br/> <a class="ae lt" href="http://www.java67.com/2018/04/10-tools-java-developers-should-learn.html" rel="noopener ugc nofollow" target="_blank">每个Java开发者都应该知道的10个工具</a> <br/> <a class="ae lt" href="http://javarevisited.blogspot.sg/2013/04/10-reasons-to-learn-java-programming.html" rel="noopener ugc nofollow" target="_blank">学习Java编程语言的10个理由</a> <br/> <a class="ae lt" href="http://javarevisited.blogspot.sg/2018/01/10-frameworks-java-and-web-developers-should-learn.html" rel="noopener ugc nofollow" target="_blank"> 10个框架Java和Web开发者应该学会的2019年</a> <br/> <a class="ae lt" href="http://javarevisited.blogspot.sg/2018/05/10-tips-to-become-better-java-developer.html" rel="noopener ugc nofollow" target="_blank">成为 2019年要学的框架</a><br/><a class="ae lt" href="https://javarevisited.blogspot.com/2018/05/10-reasons-to-learn-python-programming.html" rel="noopener ugc nofollow" target="_blank">2019年要学Python的10个理由</a> <br/> <a class="ae lt" href="https://javarevisited.blogspot.sg/2018/01/10-unit-testing-and-integration-tools-for-java-programmers.html" rel="noopener ugc nofollow" target="_blank">每个Java开发者都应该知道的10个测试库</a></p><div class="me mf ez fb mg mh"><a href="https://javarevisited.blogspot.com/2019/10/the-java-developer-roadmap.html" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hj fi z dy mm ea eb mn ed ef hh bi translated">2019年Java开发者路线图</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">我一直在分享很多成为Web开发者、DevOps工程师、最近成为React.js开发者的路线图。一…</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">javarevisited.blogspot.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv jh mh"/></div></div></a></div></div></div>    
</body>
</html>