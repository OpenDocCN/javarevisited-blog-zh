<html>
<head>
<title>System design of imitating Weibo social platform [3] — The realization of using redis zset to store friend relationship</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模仿微博社交平台的系统设计[3]——利用redis zset存储好友关系的实现</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/system-design-of-imitating-weibo-social-platform-3-the-realization-of-using-redis-zset-to-3651334723d6?source=collection_archive---------1-----------------------#2022-07-10">https://medium.com/javarevisited/system-design-of-imitating-weibo-social-platform-3-the-realization-of-using-redis-zset-to-3651334723d6?source=collection_archive---------1-----------------------#2022-07-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f699" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">利用redis zset存储朋友关系的实现</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/a7a47535a593fcaf843c831f5b7d7e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HaFWzoLsLhMDGTReSI25Qg.jpeg"/></div></div></figure><p id="9048" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj"> Redis有序集(sorted set) </strong></p><p id="5678" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><a class="ae kf" href="https://javarevisited.blogspot.com/2022/02/top-5-courses-to-learn-redis.html" rel="noopener ugc nofollow" target="_blank"> Redis </a>有序集合和集合一样，也是string类型元素的集合，不允许有重复成员。</p><p id="510f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">不同之处在于，每个元素都与一个double类型的分数相关联。Redis通过分数将集合成员从小到大排序。</p><p id="ee0b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">有序集的成员是唯一的，但是分数可以重复。</p><p id="acdf" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">例子</p><pre class="iy iz ja jb fd kg kh ki kj aw kk bi"><span id="725d" class="kl km hi kh b fi kn ko l kp kq">redis 127.0.0.1:6379&gt; ZADD runoobkey 1 redis<br/>(integer) 1<br/>redis 127.0.0.1:6379&gt; ZADD runoobkey 2 mongodb<br/>(integer) 1<br/>redis 127.0.0.1:6379&gt; ZADD runoobkey 3 mysql<br/>(integer) 1</span></pre><p id="d051" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Redis相关命令:</p><p id="9f7f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><a class="ae kf" href="https://www.runoob.com/redis/sorted-sets-zadd.html" rel="noopener ugc nofollow" target="_blank">扎德关键得分1成员1【得分2成员2】</a></p><p id="e8a8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">实际的api与命令分数和成员位置相反</p><p id="e2d9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">redisTemplate的相关API:</p><pre class="iy iz ja jb fd kg kh ki kj aw kk bi"><span id="fb5f" class="kl km hi kh b fi kn ko l kp kq">redisTemplate.opsForZSet().add(K key, V value, double score)</span></pre><p id="8e34" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">具体java代码的实现:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="3d83" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">使用redis的zset，设置额外的得分时间</p><p id="2ee8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">用zset会更好，各种操作的时间复杂度，占用CPU都比list好。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="4f82" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">使用rang方法获取被跟踪的所有人的uid集合</p><p id="40b1" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果缓存已经失效，从<a class="ae kf" rel="noopener" href="/javarevisited/top-5-sql-and-database-courses-to-learn-online-48424533ac61">数据库</a>查询，并从新设置redis，并设置失效时间！</p><div class="kt ku ez fb kv kw"><a href="https://javarevisited.blogspot.com/2022/06/best-system-design-and-analysis-books.html" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab dw"><div class="ky ab kz cl cj la"><h2 class="bd hj fi z dy lb ea eb lc ed ef hh bi translated">2022年7大系统设计和软件分析与设计书籍——最佳之选</h2><div class="ld l"><h3 class="bd b fi z dy lb ea eb lc ed ef dx translated">你需要从本质上理解的是，系统设计包括定义、开发和…</h3></div><div class="le l"><p class="bd b fp z dy lb ea eb lc ed ef dx translated">javarevisited.blogspot.com</p></div></div><div class="lf l"><div class="lg l lh li lj lf lk jh kw"/></div></div></a></div><div class="kt ku ez fb kv kw"><a href="https://www.java67.com/2019/09/top-5-courses-to-learn-system-design.html" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab dw"><div class="ky ab kz cl cj la"><h2 class="bd hj fi z dy lb ea eb lc ed ef hh bi translated">2022年学习系统设计和软件架构的10大课程——最佳课程</h2><div class="ld l"><h3 class="bd b fi z dy lb ea eb lc ed ef dx translated">软件设计或系统设计是需要掌握的棘手概念之一。可以快速学习一门编程语言…</h3></div><div class="le l"><p class="bd b fp z dy lb ea eb lc ed ef dx translated">www.java67.com</p></div></div><div class="lf l"><div class="ll l lh li lj lf lk jh kw"/></div></div></a></div><div class="kt ku ez fb kv kw"><a href="https://javarevisited.blogspot.com/2022/03/how-to-prepare-for-system-design.html" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab dw"><div class="ky ab kz cl cj la"><h2 class="bd hj fi z dy lb ea eb lc ed ef hh bi translated">如何准备系统设计面试？概念、实践和资源</h2><div class="ld l"><h3 class="bd b fi z dy lb ea eb lc ed ef dx translated">这是我如何进入FAANG的，软件工程就业市场火了！尤其是如果你有几年的…</h3></div><div class="le l"><p class="bd b fp z dy lb ea eb lc ed ef dx translated">javarevisited.blogspot.com</p></div></div><div class="lf l"><div class="lm l lh li lj lf lk jh kw"/></div></div></a></div></div></div>    
</body>
</html>