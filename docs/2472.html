<html>
<head>
<title>Generating self-signed certificate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">正在生成自签名证书</h1>
<blockquote>原文：<a href="https://medium.com/javarevisited/self-signed-certificate-d545d6054327?source=collection_archive---------0-----------------------#2022-11-13">https://medium.com/javarevisited/self-signed-certificate-d545d6054327?source=collection_archive---------0-----------------------#2022-11-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a3cc" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">本地主机</h2></div><p id="8862" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如今几乎所有的网站都运行在<a class="ae jt" href="https://javarevisited.blogspot.com/2013/07/how-to-configure-https-ssl-in-tomcat-6-7-web-server-java.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hj"> https </strong> </a>上，帮助加密在<em class="ju">网站的客户端</em>和<em class="ju">网站的服务器</em>之间传输的数据。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><a href="http://javarevisited.blogspot.com/2013/07/how-ssl-https-and-certificates-works-in-java-web-application.html"><div class="er es jv"><img src="../Images/df15d3a194a39cc339ee9b75e6c75715.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*hOt1SegFA18SbMV0cMW9lA.png"/></div></a></figure><p id="5740" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的帖子解释了<a class="ae jt" href="https://suriyaprakhash.medium.com/ssl-certificate-67b4e3bdee38#4332" rel="noopener">为什么我们需要SSL </a>和<a class="ae jt" href="https://suriyaprakhash.medium.com/ssl-certificate-67b4e3bdee38#66e2" rel="noopener">签署CA签名证书</a>的步骤。</p><div class="kd ke ez fb kf kg"><a href="https://suriyaprakhash.medium.com/ssl-certificate-67b4e3bdee38" rel="noopener follow" target="_blank"><div class="kh ab dw"><div class="ki ab kj cl cj kk"><h2 class="bd hj fi z dy kl ea eb km ed ef hh bi translated">SSL证书</h2><div class="kn l"><h3 class="bd b fi z dy kl ea eb km ed ef dx translated">了解SSL基础知识</h3></div><div class="ko l"><p class="bd b fp z dy kl ea eb km ed ef dx translated">suriyaprakhash.medium.com</p></div></div><div class="kp l"><div class="kq l kr ks kt kp ku kb kg"/></div></div></a></div><p id="2549" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">内容</strong></p><ol class=""><li id="9ed2" class="kv kw hi iz b ja jb jd je jg kx jk ky jo kz js la lb lc ld bi translated"><a class="ae jt" href="#69e4" rel="noopener ugc nofollow">先决条件</a></li><li id="ab27" class="kv kw hi iz b ja le jd lf jg lg jk lh jo li js la lb lc ld bi translated"><a class="ae jt" href="#e25e" rel="noopener ugc nofollow">默认http上的示例web应用</a></li><li id="b564" class="kv kw hi iz b ja le jd lf jg lg jk lh jo li js la lb lc ld bi translated"><a class="ae jt" href="#59d2" rel="noopener ugc nofollow">生成<strong class="iz hj">自签名公钥证书</strong> </a></li><li id="8962" class="kv kw hi iz b ja le jd lf jg lg jk lh jo li js la lb lc ld bi translated"><a class="ae jt" href="#94f3" rel="noopener ugc nofollow">生成的证书验证</a></li><li id="bb4d" class="kv kw hi iz b ja le jd lf jg lg jk lh jo li js la lb lc ld bi translated"><a class="ae jt" href="#d020" rel="noopener ugc nofollow">将生成的密钥&amp;证书导入服务器</a></li><li id="a5ab" class="kv kw hi iz b ja le jd lf jg lg jk lh jo li js la lb lc ld bi translated"><a class="ae jt" href="#3336" rel="noopener ugc nofollow">设置本地设备信任证书</a></li></ol><p id="3363" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看<em class="ju">如何生成</em>我们的<strong class="iz hj">自己的自签名证书</strong>并<strong class="iz hj">在<em class="ju">我们的开发环境</em>中信任它们</strong>。</p><p id="3b92" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">注意</strong> <em class="ju">避免在生产中使用自签名证书。生产设置需要一个</em> <a class="ae jt" href="https://suriyaprakhash.medium.com/ssl-certificate-67b4e3bdee38#66e2" rel="noopener"> <em class="ju">单独的步骤列表</em> </a> <em class="ju">。</em></p><blockquote class="lj lk ll"><p id="69e4" class="ix iy ju iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">先决条件</p></blockquote><ol class=""><li id="065f" class="kv kw hi iz b ja jb jd je jg kx jk ky jo kz js la lb lc ld bi translated"><a class="ae jt" href="https://www.openssl.org/" rel="noopener ugc nofollow" target="_blank"> Openssl </a> CLI生成<a class="ae jt" href="https://suriyaprakhash.medium.com/cryptography-algorithms-e86ce7e2bb9b#abf6" rel="noopener">密钥</a>和<a class="ae jt" href="https://suriyaprakhash.medium.com/cryptography-algorithms-e86ce7e2bb9b#41bc" rel="noopener">证书</a>。(必需)</li><li id="69f0" class="kv kw hi iz b ja le jd lf jg lg jk lh jo li js la lb lc ld bi translated"><a class="ae jt" href="https://keystore-explorer.org/" rel="noopener ugc nofollow" target="_blank">密钥库浏览器</a>(非强制)</li><li id="aef3" class="kv kw hi iz b ja le jd lf jg lg jk lh jo li js la lb lc ld bi translated">Nginx 服务器(用于演示)</li></ol><blockquote class="lj lk ll"><p id="e25e" class="ix iy ju iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">默认http上的示例web应用程序</p></blockquote><p id="67b7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">出于演示目的，我们将使用在<strong class="iz hj">端口8080 </strong>上运行的<a class="ae jt" rel="noopener" href="/javarevisited/best-courses-to-learn-nginx-in-36ed9ccca804"> nginx </a>默认web，而<em class="ju">同样适用于其他服务器</em>，然而<strong class="iz hj">服务器端配置</strong> <em class="ju">不同</em>。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><a href="https://medium.com/javarevisited/best-courses-to-learn-nginx-in-36ed9ccca804"><div class="er es lp"><img src="../Images/85abc19be8a29510d501dfc89660607e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q5UbBk7v6TbwH5Wmxq4P3Q.png"/></div></a><p class="lq lr et er es ls lt bd b be z dx translated">浏览器显示<em class="lu">不安全</em>运行在<strong class="bd lv"> http </strong>上</p></figure><blockquote class="lj lk ll"><p id="59d2" class="ix iy ju iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">正在生成自签名公钥证书</p></blockquote><p id="f2a0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将在nginx服务器上生成并使用一个<strong class="iz hj">私钥</strong>和一个<strong class="iz hj">公钥证书</strong>。</p><p id="803d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要了解什么是<a class="ae jt" href="https://suriyaprakhash.medium.com/cryptography-algorithms-e86ce7e2bb9b#abf6" rel="noopener">密钥</a>和<a class="ae jt" href="https://suriyaprakhash.medium.com/cryptography-algorithms-e86ce7e2bb9b#41bc" rel="noopener">证书</a>，</p><div class="kd ke ez fb kf kg"><a href="https://suriyaprakhash.medium.com/exploring-java-keystore-keys-9eb4805fa4ec" rel="noopener follow" target="_blank"><div class="kh ab dw"><div class="ki ab kj cl cj kk"><h2 class="bd hj fi z dy kl ea eb km ed ef hh bi translated">探索Java密钥库和密钥</h2><div class="kn l"><h3 class="bd b fi z dy kl ea eb km ed ef dx translated">通过代码</h3></div><div class="ko l"><p class="bd b fp z dy kl ea eb km ed ef dx translated">suriyaprakhash.medium.com</p></div></div><div class="kp l"><div class="lw l kr ks kt kp ku kb kg"/></div></div></a></div><p id="21f9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们知道我们想要什么，所以让我们使用下面的命令生成私钥<strong class="iz hj"><em class="ju">domain Key . PEM</em></strong>。</p><pre class="jw jx jy jz fd lx ly lz bn ma mb bi"><span id="ddee" class="mc md hi ly b be me mf l mg mh">openssl genrsa -out DomainKey.pem 4096</span></pre><p id="c2ac" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用上面生成的私钥<strong class="iz hj"><em class="ju">domain Key . PEM</em></strong>发出下面的命令来生成一个<strong class="iz hj">自签名证书</strong></p><pre class="jw jx jy jz fd lx ly lz bn ma mb bi"><span id="623c" class="mc md hi ly b be me mf l mg mh">openssl req -new -x509 -sha256 -days 1000 -addext 'subjectAltName = IP:172.24.0.1' -key DomainKey.pem -out DomainCert.pem </span></pre><p id="7f47" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，我们添加了一个<strong class="iz hj">扩展</strong>，</p><p id="2eaf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ju"> subjectAltName — </em>要么添加一个<strong class="iz hj"> DNS=*.yourdomain.com </strong>或者<strong class="iz hj"> IP地址</strong>作为<strong class="iz hj"> IP.1=x.x.x.x，IP.2=y.y.y.y </strong>或者只添加<strong class="iz hj"> IP=172.24.0.1。</strong></p><p id="1148" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj"> <em class="ju">例</em> </strong> <em class="ju">例提供我的</em> <strong class="iz hj"> <em class="ju">本地IPV4(使用ipconfig/ifconfig)</em></strong><em class="ju">中的</em> <strong class="iz hj"> <em class="ju"> SAN。</em>T59】</strong></p><p id="81b5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">注意——CN中的<em class="ju">域名</em> </strong>不再需要，用<strong class="iz hj"> SAN </strong>代替。</p><blockquote class="lj lk ll"><p id="94f3" class="ix iy ju iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">验证证书</p></blockquote><p id="145a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以使用<strong class="iz hj"> openssl </strong>命令查看证书详情。然而，在这篇文章中，我们将把<strong class="iz hj"> DomainKey.pem </strong>导入到密钥库浏览器中。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><a href="https://javarevisited.blogspot.com/2022/02/top-5-courses-to-learn-nginx-in-depth.html"><div class="er es mi"><img src="../Images/8b8c82b15d42832ff12b8488fa8de441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*kb72TiJ03T9f7wF3pBgRTQ.png"/></div></a><p class="lq lr et er es ls lt bd b be z dx translated">它被称为自签名是有原因的</p></figure><p id="1813" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，如果我们看到<strong class="iz hj">发行人</strong>已经签署了<strong class="iz hj">主题，</strong>两者是相同的。因此，我们已经成功创建了一个自签名证书。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es mj"><img src="../Images/fa0f8a1029c8141cd3dc011ddeef8f22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*UdYbvsTRVF2ZMGm3KrAtzw.png"/></div><p class="lq lr et er es ls lt bd b be z dx translated"><strong class="bd lv"> DomainCert.pem </strong>与<strong class="bd lv">扩展</strong>中相应的<strong class="bd lv"> SAN </strong></p></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es mk"><img src="../Images/3355b031b3c9a2bb5e2176fdbc7c35e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*6TL7VULZZKysK3v-HEgU6A.png"/></div><p class="lq lr et er es ls lt bd b be z dx translated"><strong class="bd lv"> DomainCert.pem </strong>带有<strong class="bd lv">基本约束</strong>显示<strong class="bd lv"> CA </strong></p></figure><blockquote class="lj lk ll"><p id="d020" class="ix iy ju iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">将密钥和证书导入服务器</p></blockquote><p id="4641" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我们在上一步中获得了证书。我们可以把它们安装在我们的nginx服务器上。在我们的<strong class="iz hj"> nginx.conf </strong>中，取消对<strong class="iz hj"> https部分</strong>的注释</p><pre class="jw jx jy jz fd lx ly lz bn ma mb bi"><span id="a816" class="mc md hi ly b be me mf l mg mh">    # HTTPS server<br/>    #<br/>    server {<br/>       listen       8443 ssl;<br/>       server_name  localhost;<br/><br/>       ssl_certificate      C:\\Suriya\\nginx-1.22.1\\cert\\DomainCert.pem;<br/>       ssl_certificate_key  C:\\Suriya\\nginx-1.22.1\\cert\\DomainKey.pem;<br/><br/>       location / {<br/>           root   html;<br/>           index  index.html index.htm;<br/>       }<br/>    }</span></pre><p id="58d7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在<strong class="iz hj">重启服务器</strong>并通过<strong class="iz hj"> <em class="ju"> 8443访问<strong class="iz hj">本地主机</strong>。答对了。！</em>T13】</strong></p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="er es ml"><img src="../Images/e0c4df3be81ae05ccff1a105d3f45465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YNaep9DZHDGOxw5CtRJKaQ.png"/></div></div><p class="lq lr et er es ls lt bd b be z dx translated">点击<strong class="bd lv">高级</strong>和<strong class="bd lv">进入</strong>本地主机</p></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="er es mq"><img src="../Images/811764cbb4854dc6fd00a62107df2f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*re09kuVCOHWJBwzDrVOWFA.png"/></div></div><p class="lq lr et er es ls lt bd b be z dx translated">在<strong class="bd lv"> https </strong>上，但是<em class="lu">浏览器认为证书不可信</em></p></figure><blockquote class="lj lk ll"><p id="3336" class="ix iy ju iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated">信任生成的证书</p></blockquote><p id="6d36" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们需要告诉浏览器<a class="ae jt" href="https://suriyaprakhash.medium.com/cryptography-algorithms-e86ce7e2bb9b#41bc" rel="noopener">公钥证书</a>是可信的。</p><p id="c0f0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">进入浏览器设置和<em class="ju">搜索</em> <strong class="iz hj"> <em class="ju"> certs </em> </strong>，这里我们用的是Chrome。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="er es mr"><img src="../Images/e4b4b071770b96f1c17a932dc85f867a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jd7Rve1VdbtQFYOLj_XSEQ.png"/></div></div><p class="lq lr et er es ls lt bd b be z dx translated">选择管理设备SSL证书</p></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es ms"><img src="../Images/9515e5ff4aeea6b561ce4586b92f0551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*_X2Og2uk_gOmNpEerL-edg.png"/></div><p class="lq lr et er es ls lt bd b be z dx translated">导入<strong class="bd lv"> DomainCert.pem </strong>作为<strong class="bd lv">可信根证书</strong></p></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es mt"><img src="../Images/eb5759aa4bff58c9bc2af3e555fb94d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*RS09dGjabXscMMoQSNA6Lg.png"/></div><p class="lq lr et er es ls lt bd b be z dx translated">一旦导入，它就会出现在这里</p></figure><p id="3d95" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">注意</strong> <a class="ae jt" href="https://suriyaprakhash.medium.com/ssl-certificate-67b4e3bdee38#66e2" rel="noopener"> <em class="ju">如果我们的证书是由浏览器信任的</em> <strong class="iz hj"> <em class="ju">验证过的认证机构</em> </strong> <em class="ju">签署的，那么整个导入步骤就可以避免。</em></a></p><p id="8ad8" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，设备的浏览器应该信任运行在<em class="ju"> 8443 </em>上的<strong class="iz hj"> 172.24.0.1 </strong>的网站，打开一个匿名窗口并检查状态。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="er es mu"><img src="../Images/b39ad0d6c3f3c25b21b432f49bd2d634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fx_kekIARzbUBQF_Ox-e-Q.png"/></div></div><p class="lq lr et er es ls lt bd b be z dx translated">浏览器现在很高兴，因为我们添加了我们的<strong class="bd lv"> DomainCert.pem </strong>证书为<em class="lu">可信</em></p></figure><p id="5856" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你想模拟证书颁发机构的签名，请随意查看下面的帖子，</p><div class="kd ke ez fb kf kg"><a href="https://suriyaprakhash.medium.com/ssl-certificate-67b4e3bdee38" rel="noopener follow" target="_blank"><div class="kh ab dw"><div class="ki ab kj cl cj kk"><h2 class="bd hj fi z dy kl ea eb km ed ef hh bi translated">SSL证书</h2><div class="kn l"><h3 class="bd b fi z dy kl ea eb km ed ef dx translated">了解SSL基础知识</h3></div><div class="ko l"><p class="bd b fp z dy kl ea eb km ed ef dx translated">suriyaprakhash.medium.com</p></div></div><div class="kp l"><div class="kq l kr ks kt kp ku kb kg"/></div></div></a></div><p id="c985" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">祝本地主机运行愉快！</p></div></div>    
</body>
</html>